(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"+Cau":function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r=n("zkrS"),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=function(e){var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"*";return e&&window.parent.postMessage(JSON.stringify({event:e,payload:t}),n)},n=function(n){if(n.source!==window&&!n.origin.includes("qiyukf")&&n.data&&"string"==typeof n.data)try{var r=JSON.parse(n.data),a=r.event,o=r.payload,i=void 0===o?{}:o;e[a]&&e[a](t,{type:a,payload:i,event:n})}catch(e){console.warn("[receive] error message data",e,n)}};return window.addEventListener("message",n),{send:t,clear:function(){return window.removeEventListener("message",n)}}},i={"message:get:preview-state":function(e){var t=c(),n=t.state,r=t.project;e("message:data:preview-state",a({},n.model.current,{isHighlight:Boolean(r&&r._highlight)}))},"message:set:preview-state":function(e,t){var n=t.payload,o=n.isHighlight,i=n.screenCid,s=c(),l=s.state.model,u=l.current,p=l.screens,d=s.project,f=s.dispatch;if(d&&void 0!==o&&o!==d._highlight&&(f({type:"projects:update-local",payload:a({},d,{_highlight:o})}),r.a.MB.currentProject._highlight=o),u.screenCid&&void 0!==i&&i!==u.screenCid){if(!p.find(function(e){return e.cid===i}))return console.warn("[message:set:preview-state] invalid screenCid");f({type:"entry:sync-runner:set-screen",payload:{cid:i}})}},"message:get:screen-list":function(e){var t=r.a.MB.webpackInterface.store.getState().model,n=t.current;e("message:data:screen-list",t.screens.filter(function(e){return e.project_cid===n.projectCid}).map(function(e){return{cid:e.cid,name:e.name,position:e.position,parent_cid:e.parent_cid,project_cid:e.project_cid}}))},"message:get:notification-state":function(e){var t=(r.a.MB.notification&&r.a.MB.notification.store&&r.a.MB.notification.store.getState()||{}).notifications;e("message:data:notification-state",{unreadCount:t?t.notifications.unreadNum:0})},"message:get:notification-list":function(e){var t=(r.a.MB.notification&&r.a.MB.notification.store&&r.a.MB.notification.store.getState()||{}).notifications;e("message:data:notification-list",t?t.notifications.notifications:[])}},c=function(){var e=r.a.MB.webpackInterface.store,t=e.getState,n=e.dispatch,a=t(),o=a.model.current.projectCid;return{getState:t,dispatch:n,state:a,project:o&&a.model.projects.find(function(e){return e.cid===o})}}},"+c4W":function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},"/5+U":function(e,t,n){"use strict";function r(e){var t=void 0,n=void 0;return function(){return function(e,t){if(!e||e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}(n,arguments)||(t=e.apply(null,arguments),n=arguments),t}}n.d(t,"h",function(){return r}),n.d(t,"j",function(){return a}),n.d(t,"p",function(){return c}),n.d(t,"k",function(){return s}),n.d(t,"b",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"f",function(){return p}),n.d(t,"m",function(){return d}),n.d(t,"l",function(){return h}),n.d(t,"o",function(){return m}),n.d(t,"e",function(){return v}),n.d(t,"i",function(){return g}),n.d(t,"a",function(){return f}),n.d(t,"g",function(){return y}),n.d(t,"n",function(){return b}),n.d(t,"d",function(){return w});var a=function(e){return function(t){return t&&t.preventDefault(),t&&t.stopPropagation(),e&&e(t)}},o={"&amp;":"&","&lt;":"<","&gt;":">"},i=function(e){return o[e]||e},c=function(e){return e&&e.replace(/(&amp;|&lt;|&gt;)/g,i)},s=function(e,t,n){return Math.min(Math.max(e,t),n)},l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Number(parseFloat((1/t*e).toFixed(2)))+n},u=function(e){var t=e.image,n=e.adjust;t.naturalWidth>=t.naturalHeight?t.style.maxWidth=n+"px":t.style.maxHeight=n+"px"},p=function(e){var t=e.url,n=e.name,r=e.type,a=document.createElement("a"),o=function(e){if(e)return e.replace(/\s|<|>|《|》|:|：|？|\?|\\|\/|"|”|\||\./g,"_")}(n)||"未命名",i=""+encodeURIComponent(o);r?a.href=t+"?attname="+i+"."+r:(a.setAttribute("download",i),a.href=""+t),a.click()},d=function(e){return Number(e.toFixed(2))},f={preview:"打开了预览界面",inspect:"切换到标注页面",comment:"切换到评论页面"},h=function(e){var t=e.width,n=e.height,r=e.left,a=e.top,o=e.rotate,i=void 0===o?0:o;if(0===i)return[a,r,t,n];var c=MB.atan2(t,n),s=c-i,l=s-2*c,u=s+180,p=l+180,d=r+t/2,f=a+n/2,h=MB.hypotenuse(t/2,n/2),m=1/0,v=1/0,g=-1/0,y=-1/0;return[s,l,u,p].forEach(function(e){var t=Math.round(d+h*MB.cos(e)),n=Math.round(f+h*MB.sin(e));t<m&&(m=t),n<v&&(v=n),t>g&&(g=t),n>y&&(y=n)}),[v,m,g-m,y-v]},m=function(e){return new Promise(function(t){return setTimeout(t,e)})},v=function(){return console.error("下载失败")},g=function(e){var t=(""+e).charCodeAt(0);return t>=19968&&t<=40869},y=function(){try{var e=MB.localStorageDelegate.getItem("user_pick_color");return JSON.parse(e||"[]")}catch(e){return[]}},b=function(e){var t=y();return t.includes(e)?{history:t,focusColor:e}:(t.unshift(e),t.length>40&&t.pop(),MB.localStorageDelegate.setItem("user_pick_color",JSON.stringify(t)),{history:t,focusColor:null})},w=function(e){var t=y(),n=t.indexOf(e);return t.splice(n,1),MB.localStorageDelegate.setItem("user_pick_color",JSON.stringify(t)),t}},"/Q2I":function(e,t,n){"use strict";var r=n("q1tI"),a=n.n(r),o=n("17x9"),i=n.n(o),c=n("i8i4"),s=n("Y+p1"),l=n.n(s),u=n("i6OX");n("NYM8");function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=[],f=Object.assign(document.createElement("div"),{className:"modal-portal"}),h=function(e){return e.stopPropagation()},m=function(e){function t(){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=r=p(this,e.call.apply(e,[this].concat(i))),r.onOpen=function(){d.unshift(r),setTimeout(function(){return r.portal.classList.add("is-open")},50),r.focusOnConfirmBtn(),r.reassignPosiY()},r.onClose=function(){var e=d.indexOf(r);setTimeout(function(){return d.splice(e,1)}),setTimeout(function(){return r.portal.classList.remove("is-open")},50),setTimeout(function(){return Object(c.render)(a.a.createElement("div",null),r.portal)},500)},r.focusOnConfirmBtn=function(){return setTimeout(function(){var e=r.portal.querySelector("footer .confirm-btn");e&&e.focus()},50)},r.listenToKey=function(e){var t=e.key,n=e.target,a=r.props,o=a.isOpen,i=a.canCloseOnEsc,c=a.onClose,s=a.canConfirmOnEnter,l=a.onConfirm,u=a.isOnConfirmDisabled;"Escape"===t&&!n.matches("input, textarea, [type=select]")&&o&&i&&c&&r===d[0]&&c(),"Enter"===t&&!n.matches("textarea")&&o&&s&&l&&!u&&r===d[0]&&l()},r.reassignPosiY=function(){return setTimeout(function(){var e=r.props.type,t=r.portal.querySelector(".modal-mask > div");if(t&&"alert"!==e){var n=window.innerHeight,a=t.offsetHeight,o=n<=a||(n-a)/2<.2*n?"add":"remove";t.classList[o]("is-posi-centered")}},50)},r.renderRealModal=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.props,t=e.type,n=e.title,o=e.className,i=e.maskClassName,s=e.children,l=e.onClose,p=e.canCloseOnClickMask,d=e.onConfirm,f=e.confirmText,m=e.isOnConfirmDisabled,v=e.onCancel,g=e.cancelText,y=e.isOnCancelDisabled,b=e.onDone,w=e.doneText,C=e.isOnDoneDisabled,E="alert"===t||v||d||b,S=a.a.createElement("div",{className:"modal-mask "+i+" "+(p?"can-close":""),onClick:p?l:null},a.a.createElement("div",{className:t+"-modal "+o,onClick:h},a.a.createElement("header",null,n,l&&a.a.createElement("button",{className:"close-btn",onClick:l},a.a.createElement(u.b,{name:"times"}))),a.a.createElement("div",{className:"content"},s),E&&a.a.createElement("footer",null,v&&a.a.createElement("button",{className:"cancel-btn",onClick:v,disabled:y},g),d&&a.a.createElement("button",{className:"confirm-btn",onClick:d,disabled:m},f),b&&a.a.createElement("button",{className:"done-btn",onClick:b,disabled:C},w))));Object(c.render)(S,r.portal)},p(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.render=function(){return null},t.prototype.componentDidMount=function(){var e=this.props,t=e.isOpen,n=e.portalClassName;Object.assign(this,{portal:f.cloneNode()}),document.body.appendChild(this.portal),this.portal.className+=" "+n,window.addEventListener("resize",this.reassignPosiY),document.addEventListener("keydown",this.listenToKey),t&&(this.renderRealModal(),this.onOpen())},t.prototype.componentWillReceiveProps=function(e){l()(this.props,e)||this.renderRealModal(e);var t=e.isOpen,n=this.props.isOpen;!n&&t?this.onOpen():n&&!t&&this.onClose()},t.prototype.componentWillUnmount=function(){Object(c.unmountComponentAtNode)(this.portal),this.portal&&this.portal.remove(),document.removeEventListener("keydown",this.listenToKey),window.removeEventListener("resize",this.reassignPosiY)},t}(r.PureComponent);m.propTypes={isOpen:i.a.bool,type:i.a.oneOf(["alert","functional","display"]),title:i.a.any,className:i.a.string,maskClassName:i.a.string,portalClassName:i.a.string,children:i.a.any,onClose:i.a.func,onCloseText:i.a.string,canCloseOnClickMask:i.a.bool,canCloseOnEsc:i.a.bool,canConfirmOnEnter:i.a.bool,onConfirm:i.a.func,confirmText:i.a.string,isOnConfirmDisabled:i.a.bool,onCancel:i.a.func,isOnCancelDisabled:i.a.bool,cancelText:i.a.string,onDone:i.a.func,isOnDoneDisabled:i.a.bool,doneText:i.a.string},m.defaultProps={isOpen:!1,type:"functional",className:"",maskClassName:"",portalClassName:"",onClose:function(){return null},canCloseOnClickMask:!0,canCloseOnEsc:!0,canConfirmOnEnter:!0,onCloseText:I18N.close,confirmText:I18N.confirm,isOnConfirmDisabled:!1,cancelText:I18N.cancel,isOnCancelDisabled:!1,doneText:I18N.done,isOnDoneDisabled:!1},t.a=m},"/TnQ":function(e,t,n){"use strict";var r=n("fvjX").compose;t.__esModule=!0,t.composeWithDevTools=function(){if(0!==arguments.length)return"object"==typeof arguments[0]?r:r.apply(null,arguments)},t.devToolsEnhancer=function(){return function(e){return e}}},"0JQy":function(e,t){var n="[\\ud800-\\udfff]",r="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",a="\\ud83c[\\udffb-\\udfff]",o="[^\\ud800-\\udfff]",i="(?:\\ud83c[\\udde6-\\uddff]){2}",c="[\\ud800-\\udbff][\\udc00-\\udfff]",s="(?:"+r+"|"+a+")"+"?",l="[\\ufe0e\\ufe0f]?"+s+("(?:\\u200d(?:"+[o,i,c].join("|")+")[\\ufe0e\\ufe0f]?"+s+")*"),u="(?:"+[o+r+"?",r,i,c,n].join("|")+")",p=RegExp(a+"(?="+a+")|"+u+l,"g");e.exports=function(e){return e.match(p)||[]}},"0L8M":function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n("q1tI"),a=n.n(r),o=n("i8i4"),i=n.n(o),c=n("6x+O"),s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function l(e,t){var n=Object(c.b)();i.a.render(a.a.createElement(e,s({},t,{onClose:function(){return setTimeout(function(){i.a.unmountComponentAtNode(n),document.body.removeChild(n)})}})),n)}},"0ZTe":function(e,t,n){var r=n("wy8a"),a=n("quyA"),o=n("Em2t"),i=n("dt0z");e.exports=function(e){return function(t){t=i(t);var n=a(t)?o(t):void 0,c=n?n[0]:t.charAt(0),s=n?r(n,1).join(""):t.slice(1);return c[e]()+s}}},"1iCU":function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return o}),n.d(t,"d",function(){return i}),n.d(t,"e",function(){return c}),n.d(t,"f",function(){return s});var r="inspect",a="preview",o="comment",i=[a,r,o],c=[{label:I18N.preview.preview,icon:a},{label:I18N.preview_panel.developer_mode,icon:r},{label:I18N.preview_panel.comment,icon:o}],s=c.slice(0,2)},"1mjR":function(e,t){},"2rXa":function(e,t){},"2s0x":function(e,t){e.exports={"slice-container":"yWKU8qVPbqrRIRSJ_TjGi","slice-load-wrap":"_3WsSTJxbz12iOHZ8ntxQf8","slice-item":"_2vvvzR2E0SoIZOD3DAqHza",active:"_2WpARMx4pqMBHK1KM0kjLj",download:"_1hNQ5s7ZGKL2NIxtApkdLY","icon-download":"_2Bxe5XoVHVItE0i88jpN6d","no-slice":"_2d9jp1Mvca7Pr9eZSIevfN",spinner:"_1u-FVwfgZb3ahxMGw1-PnC","rotate-infinite":"_3nSb5BvCbI3mKp-n2u4hun","download-slice-load":"_3tq61brpxkFdCxReM8KHY-"}},"4MIG":function(e,t){},"6ZRU":function(e,t,n){"use strict";var r=n("/MKj"),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o={isOpen:!1,type:"alert",alertType:"alert",title:"",desc:"",onClose:function(){return null},onCancel:null,onConfirm:null,cancelText:void 0,confirmText:void 0,canCancel:!0,canConfirm:!0,canClose:!0},i=n("17x9"),c=n.n(i),s=n("q1tI"),l=n.n(s),u=n("bz01"),p=n("6hLF");n("wfO3");var d=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.render=function(){var e=this.props,t=e.dispatch,n=e.isOpen,r=e.type,a=e.alertType,o=e.title,i=e.desc,c=void 0===i?o:i,s=e.isHTML,d=e.onClose,f=void 0===d?function(){return t({type:"container:modal:close"})}:d,h=e.onCancel,m=void 0===h?function(){return null}:h,v=e.onConfirm,g=e.canClose,y=e.canCancel,b=e.canConfirm,w=e.cancelText,C=e.confirmText,E=y?function(){m&&m(),f&&f()}:void 0,S=b?function(){v&&v(),f&&f()}:void 0;return l.a.createElement(u.a,{isOpen:n,type:r,portalClassName:"global-alert-portal",title:o!==c&&o?o:I18N.reminder,onClose:function(){"function"==typeof m&&m(),f()},canClose:g,onCancel:E,onConfirm:S,cancelText:w,confirmText:C},s?l.a.createElement("p",{className:"desc",dangerouslySetInnerHTML:{__html:c}}):l.a.createElement("div",{className:"desc"},c),"prompt"===a&&l.a.createElement(p.d,{name:I18N.password},l.a.createElement(p.e,{type:"password",className:"prompt-pwd"})))},t}(s.PureComponent);d.propTypes={dispatch:c.a.func,isOpen:c.a.bool,type:c.a.string,alertType:c.a.oneOf(["confirm","alert","prompt"]),onClose:c.a.func,onCancel:c.a.func,onConfirm:c.a.func,canClose:c.a.bool,canCancel:c.a.bool,canConfirm:c.a.bool,confirmText:c.a.string,cancelText:c.a.string,title:c.a.string,desc:c.a.any,isHTML:c.a.bool},d.defaultProps={type:"alert"};var f=d,h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m={Alert:Object(r.connect)(function(e){return h({},e.container.alert)})(f)};t.a={reducers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments[1],n=t.type,r=t.payload;switch(n){case"container:modal:open":return a({},r,{isOpen:!0});case"container:modal:close":return a({},e,{isOpen:!1})}return e},containers:m}},"6acW":function(e,t,n){var r=n("dt0z"),a=n("gQMU");e.exports=function(e){return a(r(e).toLowerCase())}},"6nK8":function(e,t,n){var r=n("dVn5"),a=n("fo6e"),o=n("dt0z"),i=n("9NmV");e.exports=function(e,t,n){return e=o(e),void 0===(t=n?void 0:t)?a(e)?i(e):r(e):e.match(t)||[]}},"6x+O":function(e,t,n){"use strict";function r(){var e=document.createElement("div");return document.body.appendChild(e),e}function a(){var e=document.querySelector("#canvas").getBoundingClientRect(),t=document.querySelector(".mb-viewport").getBoundingClientRect();return{canvasTop:e.top,canvasLeft:e.left,canvasWidth:e.width,canvasHeight:e.height,screenTop:t.top,screenLeft:t.left,screenWidth:t.width,screenHeight:t.height}}function o(e){var t=e.getBoundingClientRect(),n=t.top,r=t.left,a=t.right,o=t.bottom,i=document.elementFromPoint((r+a)/2,(n+o)/2);return e.contains(i)}function i(){var e=document.getSelection();if(!(e.rangeCount>0))return{};for(var t={},n=e.getRangeAt(0).commonAncestorContainer;n&&"P"!==n.nodeName&&"text_editor"!==n.id;){if(1===n.nodeType)switch(n.nodeName){case"I":t.italic=!0;break;case"B":t.bold=!0;break;case"U":t.underline=!0;break;case"STRIKE":t.lineThrough=!0;break;case"FONT":t.tc=n.color;var r=n.style.backgroundColor;r&&(t.bg=MB.rgb2hex(r));break;case"SPAN":t.bg=MB.rgb2hex(n.style.backgroundColor)}n=n.parentNode}return t}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"d",function(){return o}),n.d(t,"c",function(){return i})},"79/T":function(e,t,n){var r=n("sgoq")(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()});e.exports=r},"7GkX":function(e,t,n){var r=n("kekF")(Object.keys,Object);e.exports=r},"7Qib":function(e,t,n){"use strict";n.d(t,"c",function(){return s}),n.d(t,"a",function(){return l}),n.d(t,"d",function(){return u});var r=n("u6S6"),a=n.n(r),o=n("79/T"),i=n.n(o),c=n("t3Un");function s(e){return e?{hidden:!0}:{}}function l(e){return Object.entries(e).reduce(function(e,t){var n,r=t[0],o=t[1];return Object.assign(e,((n={})[a()(r)]=o,n))},{})}function u(e){return Object.entries(e).reduce(function(e,t){var n,r=t[0],a=t[1];return Object.assign(e,((n={})[i()(r)]=a,n))},{})}n.d(t,"b",function(){return c.a}),n.d(t,"e",function(){return c.b})},"7bO/":function(e,t,n){"use strict";var r={};n.d(r,"TASK",function(){return a.e}),n.d(r,"SAGA_ACTION",function(){return a.c}),n.d(r,"noop",function(){return a.r}),n.d(r,"is",function(){return a.n}),n.d(r,"deferred",function(){return a.i}),n.d(r,"arrayOfDeffered",function(){}),n.d(r,"createMockTask",function(){}),n.d(r,"cloneableGenerator",function(){}),n.d(r,"asEffect",function(){return c.c}),n.d(r,"CHANNEL_END",function(){return d});var a=n("Ev6p"),o=n("92lH"),i=n("udQi"),c=n("tw9P"),s=n("mbVZ"),l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var p="proc first argument (Saga function result) must be an iterator",d={toString:function(){return"@@redux-saga/CHANNEL_END"}},f={toString:function(){return"@@redux-saga/TASK_CANCEL"}},h={wildcard:function(){return a.o},default:function(e){return"symbol"===(void 0===e?"undefined":u(e))?function(t){return t.type===e}:function(t){return t.type===String(e)}},array:function(e){return function(t){return e.some(function(e){return m(e)(t)})}},predicate:function(e){return function(t){return e(t)}}};function m(e){return("*"===e?h.wildcard:a.n.array(e)?h.array:a.n.stringableFunc(e)?h.default:a.n.func(e)?h.predicate:h.default)(e)}var v=function(e){return{fn:e}};function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return a.r},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.r,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a.r,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},y=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,b=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"anonymous",w=arguments[8];Object(a.g)(e,a.n.iterator,p);var C=Object(a.k)(U,Object(a.w)("[...effects]","all([...effects])")),E=h.sagaMonitor,S=h.logger,O=h.onError,_=S||a.p,j=function(e){var t=e.sagaStack;!t&&e.stack&&(t=-1!==e.stack.split("\n")[0].indexOf(e.message)?e.stack:"Error: "+e.message+"\n"+e.stack),_("error","uncaught at "+b,t||e.message||e)},x=Object(o.e)(t),T=Object.create(u);I.cancel=a.r;var k=function(e,t,n,r){var o,i;return n._deferredEnd=null,(o={})[a.e]=!0,o.id=e,o.name=t,"done",(i={}).done=i.done||{},i.done.get=function(){if(n._deferredEnd)return n._deferredEnd.promise;var e=Object(a.i)();return n._deferredEnd=e,n._isRunning||(n._error?e.reject(n._error):e.resolve(n._result)),e.promise},o.cont=r,o.joiners=[],o.cancel=R,o.isRunning=function(){return n._isRunning},o.isCancelled=function(){return n._isCancelled},o.isAborted=function(){return n._isAborted},o.result=function(){return n._result},o.error=function(){return n._error},o.setContext=function(e){Object(a.g)(e,a.n.object,Object(a.h)("task",e)),a.s.assign(T,e)},function(e,t){for(var n in t){var r=t[n];r.configurable=r.enumerable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,n,r)}}(o,i),o}(y,b,e,w),M={name:b,cancel:function(){M.isRunning&&!M.isCancelled&&(M.isCancelled=!0,I(f))},isRunning:!0},N=function(e,t,n){var r=[],o=void 0,i=!1;function c(e){l(),n(e,!0)}function s(e){r.push(e),e.cont=function(s,l){i||(Object(a.t)(r,e),e.cont=a.r,l?c(s):(e===t&&(o=s),r.length||(i=!0,n(o))))}}function l(){i||(i=!0,r.forEach(function(e){e.cont=a.r,e.cancel()}),r=[])}return s(t),{addTask:s,cancelAll:l,abort:c,getTasks:function(){return r},taskNames:function(){return r.map(function(e){return e.name})}}}(0,M,L);function R(){e._isRunning&&!e._isCancelled&&(e._isCancelled=!0,N.cancelAll(),L(f))}return w&&(w.cancel=R),e._isRunning=!0,I(),k;function I(t,n){if(!M.isRunning)throw new Error("Trying to resume an already finished generator");try{var r=void 0;n?r=e.throw(t):t===f?(M.isCancelled=!0,I.cancel(),r=a.n.func(e.return)?e.return(f):{done:!0,value:f}):r=t===d?a.n.func(e.return)?e.return():{done:!0}:e.next(t),r.done?(M.isMainRunning=!1,M.cont&&M.cont(r.value)):P(r.value,y,"",I)}catch(e){M.isCancelled&&j(e),M.isMainRunning=!1,M.cont(e,!0)}}function L(t,n){e._isRunning=!1,x.close(),n?(t instanceof Error&&Object.defineProperty(t,"sagaStack",{value:"at "+b+" \n "+(t.sagaStack||t.stack),configurable:!0}),k.cont||(t instanceof Error&&O?O(t):j(t)),e._error=t,e._isAborted=!0,e._deferredEnd&&e._deferredEnd.reject(t)):(e._result=t,e._deferredEnd&&e._deferredEnd.resolve(t)),k.cont&&k.cont(t,n),k.joiners.forEach(function(e){return e.cb(t,n)}),k.joiners=null}function P(e,u){var p=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",h=arguments[3],g=Object(a.v)();E&&E.effectTriggered({effectId:g,parentEffectId:u,label:p,effect:e});var y=void 0;function w(e,t){y||(y=!0,h.cancel=a.r,E&&(t?E.effectRejected(g,e):E.effectResolved(g,e)),h(e,t))}w.cancel=a.r,h.cancel=function(){if(!y){y=!0;try{w.cancel()}catch(e){j(e)}w.cancel=a.r,E&&E.effectCancelled(g)}};var S=void 0;return a.n.promise(e)?A(e,w):a.n.helper(e)?B(v(e),g,w):a.n.iterator(e)?D(e,g,b,w):a.n.array(e)?C(e,g,w):(S=c.c.take(e))?function(e,t){var n=e.channel,r=e.pattern,a=e.maybe;n=n||x;var i=function(e){return e instanceof Error?t(e,!0):Object(o.d)(e)&&!a?t(d):t(e)};try{n.take(i,m(r))}catch(e){return t(e,!0)}t.cancel=i.cancel}(S,w):(S=c.c.put(e))?function(e,t){var r=e.channel,o=e.action,c=e.resolve;Object(i.a)(function(){var e=void 0;try{e=(r?r.put:n)(o)}catch(e){if(r||c)return t(e,!0);j(e)}if(!c||!a.n.promise(e))return t(e);A(e,t)})}(S,w):(S=c.c.all(e))?U(S,g,w):(S=c.c.race(e))?function(e,t,n){var r=void 0,i=Object.keys(e),c={};i.forEach(function(t){var s=function(c,s){if(!r)if(s)n.cancel(),n(c,!0);else if(!Object(o.d)(c)&&c!==d&&c!==f){var u;n.cancel(),r=!0;var p=((u={})[t]=c,u);n(a.n.array(e)?[].slice.call(l({},p,{length:i.length})):p)}};s.cancel=a.r,c[t]=s}),n.cancel=function(){r||(r=!0,i.forEach(function(e){return c[e].cancel()}))},i.forEach(function(n){r||P(e[n],t,n,c[n])})}(S,g,w):(S=c.c.call(e))?function(e,t,n){var r=e.context,o=e.fn,i=e.args,c=void 0;try{c=o.apply(r,i)}catch(e){return n(e,!0)}return a.n.promise(c)?A(c,n):a.n.iterator(c)?D(c,t,o.name,n):n(c)}(S,g,w):(S=c.c.cps(e))?function(e,t){var n=e.context,r=e.fn,o=e.args;try{var i=function(e,n){return a.n.undef(e)?t(n):t(e,!0)};r.apply(n,o.concat(i)),i.cancel&&(t.cancel=function(){return i.cancel()})}catch(e){return t(e,!0)}}(S,w):(S=c.c.fork(e))?B(S,g,w):(S=c.c.join(e))?function(e,t){if(e.isRunning()){var n={task:k,cb:t};t.cancel=function(){return Object(a.t)(e.joiners,n)},e.joiners.push(n)}else e.isAborted()?t(e.error(),!0):t(e.result())}(S,w):(S=c.c.cancel(e))?function(e,t){e===a.d&&(e=k);e.isRunning()&&e.cancel();t()}(S,w):(S=c.c.select(e))?function(e,t){var n=e.selector,a=e.args;try{var o=n.apply(void 0,[r()].concat(a));t(o)}catch(e){t(e,!0)}}(S,w):(S=c.c.actionChannel(e))?function(e,n){var r=e.pattern,a=e.buffer,i=m(r);i.pattern=r,n(Object(o.c)(t,a||s.a.fixed(),i))}(S,w):(S=c.c.flush(e))?function(e,t){e.flush(t)}(S,w):(S=c.c.cancelled(e))?function(e,t){t(!!M.isCancelled)}(0,w):(S=c.c.getContext(e))?function(e,t){t(T[e])}(S,w):(S=c.c.setContext(e))?function(e,t){a.s.assign(T,e),t()}(S,w):w(e)}function A(e,t){var n=e[a.a];a.n.func(n)?t.cancel=n:a.n.func(e.abort)&&(t.cancel=function(){return e.abort()}),e.then(t,function(e){return t(e,!0)})}function D(e,a,o,i){g(e,t,n,r,T,h,a,o,i)}function B(e,o,c){var s=e.context,l=e.fn,u=e.args,p=e.detached,d=function(e){var t=e.context,n=e.fn,r=e.args;if(a.n.iterator(n))return n;var o,i,c=void 0,s=void 0;try{c=n.apply(t,r)}catch(e){s=e}return a.n.iterator(c)?c:s?Object(a.q)(function(){throw s}):Object(a.q)((o=void 0,i={done:!1,value:c},function(e){return o?{done:!0,value:e}:(o=!0,i)}))}({context:s,fn:l,args:u});try{Object(i.c)();var f=g(d,t,n,r,T,h,o,l.name,p?null:a.r);p?c(f):d._isRunning?(N.addTask(f),c(f)):d._error?N.abort(d._error):c(f)}finally{Object(i.b)()}}function U(e,t,n){var r=Object.keys(e);if(!r.length)return n(a.n.array(e)?[]:{});var i=0,c=void 0,s={},u={};r.forEach(function(t){var p=function(u,p){c||(p||Object(o.d)(u)||u===d||u===f?(n.cancel(),n(u,p)):(s[t]=u,++i===r.length&&(c=!0,n(a.n.array(e)?a.f.from(l({},s,{length:r.length})):s))))};p.cancel=a.r,u[t]=p}),n.cancel=function(){c||(c=!0,r.forEach(function(e){return u[e].cancel()}))},r.forEach(function(n){return P(e[n],t,n,u[n])})}}var y="runSaga(storeInterface, saga, ...args): saga argument must be a Generator function!";function b(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];var i=void 0;a.n.iterator(e)?(i=e,e=t):(Object(a.g)(t,a.n.func,y),i=t.apply(void 0,r),Object(a.g)(i,a.n.iterator,y));var c=e,s=c.subscribe,l=c.dispatch,u=c.getState,p=c.context,d=c.sagaMonitor,f=c.logger,h=c.onError,m=Object(a.v)();d&&(d.effectTriggered=d.effectTriggered||a.r,d.effectResolved=d.effectResolved||a.r,d.effectRejected=d.effectRejected||a.r,d.effectCancelled=d.effectCancelled||a.r,d.actionDispatched=d.actionDispatched||a.r,d.effectTriggered({effectId:m,root:!0,parentEffectId:0,effect:{root:!0,saga:t,args:r}}));var v=g(i,s,Object(a.x)(l),u,p,{sagaMonitor:d,logger:f,onError:h},m,t.name);return d&&d.effectResolved(m,v),v}n("q09E"),n("oZtI");n.d(t,!1,function(){return b}),n.d(t,!1,function(){return o.a}),n.d(t,!1,function(){return o.c}),n.d(t,!1,function(){}),n.d(t,!1,function(){return s.a}),n.d(t,!1,function(){}),n.d(t,!1,function(){}),n.d(t,!1,function(){}),n.d(t,!1,function(){return a.j}),n.d(t,!1,function(){return a.a}),n.d(t,!1,function(){}),n.d(t,!1,function(){}),n.d(t,!1,function(){return r});t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.context,n=void 0===t?{}:t,r=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["context"]),i=r.sagaMonitor,c=r.logger,s=r.onError;if(a.n.func(r))throw new Error("Saga middleware no longer accept Generator functions. Use sagaMiddleware.run instead");if(c&&!a.n.func(c))throw new Error("`options.logger` passed to the Saga middleware is not a function!");if(s&&!a.n.func(s))throw new Error("`options.onError` passed to the Saga middleware is not a function!");if(r.emitter&&!a.n.func(r.emitter))throw new Error("`options.emitter` passed to the Saga middleware is not a function!");function l(e){var t=e.getState,u=e.dispatch,p=Object(o.b)();return p.emit=(r.emitter||a.l)(p.emit),l.run=b.bind(null,{context:n,subscribe:p.subscribe,dispatch:u,getState:t,sagaMonitor:i,logger:c,onError:s}),function(e){return function(t){i&&i.actionDispatched&&i.actionDispatched(t);var n=e(t);return p.emit(t),n}}}return l.run=function(){throw new Error("Before running a Saga, you must mount the Saga middleware on the Store using applyMiddleware")},l.setContext=function(e){Object(a.g)(e,a.n.object,Object(a.h)("sagaMiddleware",e)),a.s.assign(n,e)},l}},"7eYF":function(e,t,n){"use strict";var r=n("fvjX"),a=n("WVP6"),o=n("7bO/"),i=n("/TnQ"),c=n("IV71"),s=n("zkrS"),l=n("peh1"),u=(n("1iCU"),function(e){return e.container.common.scale}),p=Object(l.createSelector)([function(e){return e.model.projects},function(e){return e.model.current.projectCid}],function(e,t){return e.find(function(e){return e.cid===t})}),d=Object(l.createSelector)([function(e){return e.model.screens},function(e){return e.model.current.screenCid}],function(e,t){return e.find(function(e){return e.cid===t})}),f={"entry:init:preview:scale":function(e){var t,n,r=e.getState,a=e.dispatch,o=r(),i=p(o),c=d(o),s=(t=i.cid,(n=Project.find(t)||Template.find(t)).deviceShell()||n.defaultShell()||{top:0,left:0,width:n.width,height:n.height}),l="landscape"===c.orientation?[s.height,s.width]:[s.width,s.height],u=l[0],f=l[1],h=i.template?.8:1,m=window.innerWidth*h-500,v=window.innerHeight*h-56,g=100*Math.min((v-40)/f,(m-40)/u);a({type:"preview:set:scale",payload:{scale:Math.min(g,100)}})}},h=(Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e})({},f,{"entry:state:init":function(e){var t=e.dispatch;t({type:"user:set",payload:s.a.MB.user||null}),t({type:"teams:refresh"}),t({type:"widgets:refresh"}),t({type:"projects:refresh"}),t({type:"screens:refresh"}),t({type:"comments:refresh"}),t({type:"comment-threads:refresh"}),t({type:"collaborators:refresh"}),t({type:"entry:add-mock-collaborator"}),t({type:"entry:current:set",payload:{project:s.a.MB.currentProject,screen:s.a.MB.currentScreen}})},"entry:state:clear":function(e){e.dispatch},"entry:sync-runner:set-screen":function(e,t){var n=e.dispatch,r=e.getState,a=t.payload.cid;n({type:"entry:current:set-screen",payload:{cid:a}}),"inspect"==r().container.previewSetting.toolbarActiveItem&&n({type:"SET_VISIBILITY_SCREEN",payload:{screenID:a}}),s.a.MB.runner.loadScreen(a)},"entry:refresh:team-related":function(e){var t=e.dispatch;t({type:"teams:refresh"}),t({type:"collaborators:refresh"}),t({type:"entry:add-mock-collaborator"}),t({type:"entry:current:set",payload:{project:s.a.MB.currentProject,screen:s.a.MB.currentScreen}})},"entry:refresh:project-related":function(e){var t=e.dispatch;t({type:"projects:refresh"}),t({type:"screens:refresh"}),t({type:"widgets:refresh"}),t({type:"comments:refresh"}),t({type:"comment-threads:refresh"}),t({type:"collaborators:refresh"}),t({type:"entry:add-mock-collaborator"}),t({type:"entry:current:set",payload:{project:s.a.MB.currentProject,screen:s.a.MB.currentScreen}})},"entry:listpage:toggle:order":function(e){var t=e.dispatch,n=e.getState,r=s.a.MB.preference(),a=n().container.listpage.ui.order,o=void 0;a?(o="asc"===a?"desc":"asc",r.app_order=o,r.lsave(),s.a.SpineModel.queueSave()):o=r.app_order,t({type:"container:listpage:set:order",payload:{order:o}})},"entry:focus-element":function(e,t){var n=e.dispatch,r=t.payload,a=r.focusType,o=r.element;return o&&setTimeout(function(){switch(a){case"normal":return o.focus&&o.focus();case"external":return n({type:"entry:webpack-interface:observer:call",payload:{key:"focus-method:request-focus",args:[o]}}),o.focus&&o.focus()}},100),!0},"entry:preview:select":function(e,t){var n=e.dispatch,r=e.getState,a=t.payload.toolbarActiveItem,o=r(),i=o.container.previewSetting,c=o.model.user;if(a!=i.activeItem){var l="comment"==a||"inspect"==a?"immersive":"default";"comment"==a&&(s.a.MB.currentProject.limitation.commentable||MB.promptRenew("cant_comment",{role:s.a.MB.currentProject.owner_id!==c.id?s.a.MB.currentProject.team_cid?"team":"project":"user"})),"inspect"==a&&n({type:"SET_VISIBILITY_SCREEN",payload:{screenID:s.a.MB.currentScreen.cid}}),l!==s.a.MB.runner.mode&&(s.a.MB.runner.mode=l,setTimeout(function(){s.a.MB.runner.reload(!0)})),n({type:"reducer:preview-toolbar:update",payload:{toolbarActiveItem:a}})}},"container:comment:select":function(e,t){var n=e.dispatch,r=e.getState,a=t.payload.select,o=r(),i=o.model,c=i.comments,s=i.commentThreads,l=o.container,u=s.find(function(e){return e.cid===l.comment.select});u&&a!==l.comment.select&&!c.find(function(e){return e.thread_cid===u.cid})&&n({type:"entry:comment-threads:delete",payload:u})},"entry:preview:clear":function(e,t){var n=e.dispatch;s.a.MB.runner.mode="default",n({type:"reducer:preview-panel:reset"}),n({type:"container:layers:clear"})}}),m=n("q1tI"),v=n.n(m),g=n("wCGR"),y=n("lVR5"),b=n("IT1M"),w=n("JhsL"),C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},E=s.a.SpineModel,S={Team:"t",Project:"p",Combo:"c",Template:"t",Screen:"s",Collaborator:"co",Comment:"cm",CommentThread:"cmth",Widget:"w"},O=Object.keys(S),_=O.reduce(function(e,t){return e[t]=E[t].attributes,e},{});_.Widget=[].concat(_.Widget,["id"]);var j=O.reduce(function(e,t){var n=E[t],r=_[t],a=S[t],o=function(e,r){var a=e.find(function(e){return e.cid===r}),o=n.findByAttribute("cid",r);return w.a&&!a&&console.warn("["+t+"] state not found for cid: "+r),w.a&&!o&&console.warn("["+t+"] model not found for cid: "+r),{dataState:a,dataModel:o}};return e[t]={refreshStateList:function(e){return n.all().map(function(e){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r.forEach(function(n){return t[n]=e[n]}),t}(e,{})})},saveState:function(e,t,n){var r=t.cid,a=o(e,r),i=a.dataState,c=a.dataModel;return i&&c?(c.lsave(!n),!n&&s.a.SpineModel.queueSave(),e):e},addState:function(e,r,o){var i=r.cid||s.a.SpineModel.requestCid(a);(function(e,r){var a=e.find(function(e){return e.cid===r}),o=n.findByAttribute("cid",r);return w.a&&a&&console.warn("["+t+"] state already exists for cid: "+r),w.a&&o&&console.warn("["+t+"] model already exists for cid: "+r),Boolean(a||o)})(e,i)&&(i=s.a.SpineModel.requestCid(a));var c=C({},r,{cid:i});return new n(c).lsave(!o),!o&&s.a.SpineModel.queueSave(),w.a&&console.log("["+t+"] addState",c,o),b.Operation.arrayPush(e,c)},updateState:function(e,n,r){var a=n.cid,i=o(e,a),c=i.dataState,l=i.dataModel;return c&&l?(c=C({},c,n),Object.assign(l,c),l.lsave(!r),!r&&s.a.SpineModel.queueSave(),w.a&&console.log("["+t+"] updateState",c,r),b.Operation.arrayFindSet(e,function(e){return e.cid===a},c)):e},deleteState:function(e,n,r){var a=n.cid,i=o(e,a),c=i.dataState,l=i.dataModel;return c&&l?(l.ldestroy(!r),!r&&s.a.SpineModel.queueSave(),w.a&&console.log("["+t+"] deleteState",c,r),b.Operation.arrayFindDelete(e,function(e){return e.cid===a})):e}},e},{}),x=function(e){return function(t,n,r){var a=n.cid,o=E.Project.findByAttribute("cid",a)?"Project":E.Template.findByAttribute("cid",a)?"Template":E.Combo.findByAttribute("cid",a)?"Combo":null;if(w.a&&!o)throw new Error("[Error] no Project/Template/Combo found for "+a);return j[o][e](t,n,r)}};j.ProjectAlike={refreshStateList:function(e){return[].concat(j.Project.refreshStateList(),j.Template.refreshStateList(),j.Combo.refreshStateList())},saveState:x("saveState"),addState:x("addState"),updateState:x("updateState"),deleteState:x("deleteState")};var T=j.Collaborator,k=Object(a.createStateStore)([]),M=k.getState,N=k.setState,R=k.wrapEntry,I=function(e,t){return R(function(n,r,a){var o=r.dispatch,i=a&&a.payload;o({type:"reducer:collaborators:update",payload:e(n,i,t)})})},L={entryMap:{"collaborators:refresh":R(function(e,t,n){var r=t.dispatch,a=n&&n.payload;(e=T.refreshStateList(e,a,!1)).forEach(function(e){e.avatar||(e.avatar="/images/avatar.png")}),r({type:"reducer:collaborators:update",payload:e})}),"collaborators:add":I(T.addState,!1),"collaborators:add-local":I(T.addState,!0),"collaborators:update":I(T.updateState,!1),"collaborators:update-local":I(T.updateState,!0),"collaborators:delete":I(T.deleteState,!1),"collaborators:delete-local":I(T.deleteState,!0)},getState:M,setState:N},P=j.Comment,A=Object(a.createStateStore)([]),D=A.getState,B=A.setState,U=A.wrapEntry,F=function(e,t){return U(function(n,r,a){var o=r.dispatch,i=a&&a.payload;o({type:"reducer:comments:update",payload:e(n,i,t)})})},q={entryMap:{"comments:refresh":F(P.refreshStateList,!1),"comments:add":F(P.addState,!1),"comments:add-local":F(P.addState,!0),"comments:update":F(P.updateState,!1),"comments:update-local":F(P.updateState,!0),"comments:delete":F(P.deleteState,!1),"comments:delete-local":F(P.deleteState,!0)},getState:D,setState:B},W=j.CommentThread,z=Object(a.createStateStore)([]),H=z.getState,V=z.setState,G=z.wrapEntry,K=function(e,t){return G(function(n,r,a){var o=r.dispatch,i=a&&a.payload;o({type:"reducer:comment-threads:update",payload:e(n,i,t)})})},X={entryMap:{"comment-threads:refresh":K(W.refreshStateList,!1),"comment-threads:save":K(W.saveState,!1),"comment-threads:add":K(W.addState,!1),"comment-threads:add-local":K(W.addState,!0),"comment-threads:update":K(W.updateState,!1),"comment-threads:update-local":K(W.updateState,!0),"comment-threads:delete":K(W.deleteState,!1),"comment-threads:delete-local":K(W.deleteState,!0)},getState:H,setState:V},Y=j.ProjectAlike,Z=Object(a.createStateStore)([]),Q=Z.getState,J=Z.setState,$=Z.wrapEntry,ee=function(e,t){return $(function(n,r,a){var o=r.dispatch,i=a&&a.payload;o({type:"reducer:projects:update",payload:e(n,i,t)})})},te={entryMap:{"projects:refresh":ee(Y.refreshStateList,!1),"projects:add":ee(Y.addState,!1),"projects:add-local":ee(Y.addState,!0),"projects:update":ee(Y.updateState,!1),"projects:update-local":ee(Y.updateState,!0),"projects:delete":ee(Y.deleteState,!1),"projects:delete-local":ee(Y.deleteState,!0)},getState:Q,setState:J},ne=j.Screen,re=Object(a.createStateStore)([]),ae=re.getState,oe=re.setState,ie=re.wrapEntry,ce=function(e,t){return ie(function(n,r,a){var o=r.dispatch,i=a&&a.payload;o({type:"reducer:screens:update",payload:e(n,i,t)})})},se={entryMap:{"screens:refresh":ce(ne.refreshStateList,!1),"screens:add":ce(ne.addState,!1),"screens:add-local":ce(ne.addState,!0),"screens:update":ce(ne.updateState,!1),"screens:update-local":ce(ne.updateState,!0),"screens:delete":ce(ne.deleteState,!1),"screens:delete-local":ce(ne.deleteState,!0)},getState:ae,setState:oe},le=j.Team,ue=Object(a.createStateStore)([]),pe=ue.getState,de=ue.setState,fe=ue.wrapEntry,he=function(e,t){return fe(function(n,r,a){var o=r.dispatch,i=a&&a.payload;o({type:"reducer:teams:update",payload:e(n,i,t)})})},me={entryMap:{"teams:refresh":he(le.refreshStateList,!1),"teams:add":he(le.addState,!1),"teams:add-local":he(le.addState,!0),"teams:update":he(le.updateState,!1),"teams:update-local":he(le.updateState,!0),"teams:delete":he(le.deleteState,!1),"teams:delete-local":he(le.deleteState,!0)},getState:pe,setState:de},ve=j.Widget,ge=Object(a.createStateStore)([]),ye=ge.getState,be=ge.setState,we=ge.wrapEntry,Ce=function(e,t){return we(function(n,r,a){var o=r.dispatch,i=a&&a.payload;o({type:"reducer:widgets:update",payload:e(n,i,t)})})},Ee={entryMap:{"widgets:refresh":Ce(ve.refreshStateList,!1),"widgets:add":Ce(ve.addState,!1),"widgets:add-local":Ce(ve.addState,!0),"widgets:update":Ce(ve.updateState,!1),"widgets:update-local":Ce(ve.updateState,!0),"widgets:delete":Ce(ve.deleteState,!1),"widgets:delete-local":Ce(ve.deleteState,!0)},getState:ye,setState:be},Se={id:null,name:"",email:"",avatar:"",plan:{state:"",type:"free",rawType:"free",collaboratorLimitation:0,daysLeft:""}},Oe=Object(a.createStateStore)(Se),_e=Oe.getState,je=Oe.setState,xe=Oe.wrapEntry;var Te={entryMap:{"user:set":xe(function(e,t,n){var r=t.dispatch,a=n.payload,o=a.id,i=void 0===o?null:o,c=a.name,s=void 0===c?"":c,l=a.email,u=void 0===l?"":l,p=a.avatar,d=void 0===p?"":p;r({type:"reducer:user:update",payload:b.Operation.objectMerge(e,{id:i,name:s,email:u,avatar:d,plan:function(e){var t=e.plan,n=e.state,r=e.limitation,a=e.days_left,o="active"===n;return{state:n||"",type:o&&t||"free",rawType:t||"free",collaboratorLimitation:o&&r||0,daysLeft:a||""}}(a)})})}),"user:clear":xe(function(e,t,n){(0,t.dispatch)({type:"reducer:user:update",payload:Se})})},getState:_e,setState:je},ke=Object(a.createStateStore)({teamCid:null,projectCid:null,screenCid:null,userRole:"guest"}),Me=ke.getState,Ne=ke.setState,Re={"current:set":(0,ke.wrapEntry)(function(e,t,n){var r,a=t.dispatch,o=n.payload,i=o.project,c=o.screen,s=o.userCollaborator;a({type:"reducer:current:update",payload:{teamCid:i&&i.team_cid||null,projectCid:i&&i.cid||null,screenCid:c&&c.cid||null,userRole:(r=s&&s.role,Ie.has(r)?r:"guest")}})})},Ie=new Set(["owner","admin","editor","viewer"]);var Le={entryMap:Re,getState:Me,setState:Ne};function Pe(e){return JSON.parse(s.a.Storage.getItem(e+"_commentTick")||"{}")}function Ae(e,t){s.a.Storage.setItem(e+"_commentTick",JSON.stringify(t))}function De(e,t){var n=Pe(e);n[t]=Math.ceil(.001*Date.now()+2),Ae(e,n)}function Be(e,t,n){0!==n&&(e[t]=(e[t]||0)+n)}var Ue=Object(a.createStateStore)({projectCid:null,unreadCommentMap:{},unreadCountThreadMap:{},unreadCountScreenMap:{}}),Fe=Ue.getState,qe=Ue.setState,We=Ue.wrapEntry,ze={entryMap:{"unread-comment:init-for-project":We(function(e,t,n){var r=t.dispatch,a=n.payload,o=a.projectCid,i=a.commentThreadList,c=a.commentList,l=Pe(o),u={},p={};i.forEach(function(e){var t=e.cid,n=e.screen_cid;p[t]=n,u[n]=l[n]});var d={},f={},h={};c.forEach(function(e){var t=e.cid,n=e.thread_cid,r=e.updated_at;(u[p[n]]||0)>=r||(d[t]=!0,Be(f,n,1))}),i.forEach(function(e){var t=e.cid,n=e.screen_cid;return Be(h,n,f[t]||0)}),Ae(o,u),function(){for(var e=.001*Date.now()-2592e3,t=[],n=function(n,r){var a=s.a.Storage.key(n);if(!a.endsWith("_commentTick"))return"continue";var o=JSON.parse(s.a.Storage.getItem(a)||"{}"),i=Object.keys(o);i.forEach(function(t){o[t]<=e&&delete o[t]});var c=Object.keys(o);0===c.length?t.push(a):i.length!==c.length&&s.a.Storage.setItem(a,JSON.stringify(o))},r=0,a=s.a.Storage.length;r<a;r++)n(r);t.forEach(function(e){return s.a.Storage.removeItem(e)})}(),r({type:"reducer:unread-comment:update",payload:{projectCid:o,unreadCommentMap:d,unreadCountThreadMap:f,unreadCountScreenMap:h}})}),"unread-comment:set-unread":We(function(e,t,n){var r=t.dispatch,a=n.payload,o=a.commentCid,i=a.threadCid,c=a.screenCid,s=e.unreadCommentMap,l=e.unreadCountThreadMap,u=e.unreadCountScreenMap;s[o]||(r({type:"reducer:unread-comment:update",payload:b.Operation.objectMerge(e,{unreadCommentMap:b.Operation.objectSet(s,o,!0),unreadCountThreadMap:b.Operation.objectSet(l,i,(l[i]||0)+1),unreadCountScreenMap:b.Operation.objectSet(u,c,(u[c]||0)+1)})}),De(e.projectCid,c))}),"unread-comment:set-read":We(function(e,t,n){var r=t.dispatch,a=n.payload.screenCid,o=e.unreadCountScreenMap;r({type:"reducer:unread-comment:update",payload:b.Operation.objectMerge(e,{unreadCountScreenMap:b.Operation.objectDelete(o,a)})}),De(e.projectCid,a)})},getState:Fe,setState:qe},He=(Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e})({},L.entryMap,q.entryMap,X.entryMap,te.entryMap,se.entryMap,me.entryMap,Ee.entryMap,Te.entryMap,Le.entryMap,ze.entryMap,{"entry:add-mock-collaborator":function(e){var t=e.dispatch,n=me.getState(),r=te.getState(),a=L.getState(),o=new Set(a.map(function(e){return e.cid})),i=0,c=function(e,n){var r="co_MOCK_"+e.cid;o.has(r)||(t({type:"collaborators:add-local",payload:{cid:r,role:"owner",user_id:e.owner_id,name:e.owner_name,email:e.owner_email||"email_MOCK_"+e.owner_id,avatar:e.owner_avatar,team_cid:n?e.cid:null,project_cid:n?null:e.cid}}),i++)};n.forEach(function(e){return c(e,!0)}),r.forEach(function(e){return c(e,!1)}),w.a&&i&&console.log("[entry:add-mock-collaborator] added "+i+" mock collaborator")},"entry:current:set":function(e,t){var n=e.dispatch,r=t.payload,a=r.project,o=r.screen,i=Le.getState(),c=a&&a.cid||i.projectCid,s=o&&o.cid||i.screenCid;n({type:"current:set",payload:{project:a=te.getState().find(function(e){return e.cid===c}),screen:o=se.getState().find(function(e){return e.cid===s}),userCollaborator:a&&function(e,t){var n=Te.getState();return n&&L.getState().find(function(r){return r.user_id===n.id&&(r.project_cid===e||r.team_cid===t)})}(a.cid,a.team_cid)}})},"entry:current:set-screen":function(e,t){var n=e.dispatch,r=t.payload.cid,a=se.getState().find(function(e){return e.cid===r});if(!a)return console.warn("[entry:current:set-screen] non exist screen with cid: "+r);n({type:"entry:current:set",payload:{screen:a}})},"entry:unread-comment:init":function(e,t){var n=e.dispatch,r=Le.getState(),a=r.userRole,o=r.projectCid;"guest"!==a&&n({type:"unread-comment:init-for-project",payload:{projectCid:o,commentThreadList:X.getState(),commentList:q.getState()}})},"entry:comment-threads:add":function(e,t){var n=e.getState,r=e.dispatch,a=t.payload,o=a.top,i=a.left,c=a.message,l=a.cancelSelect,p=Te.getState(),d=Le.getState().screenCid,f=100/u(n()),h=.001*Date.now(),m=s.a.SpineModel.requestCid("cmth");r({type:c?"comment-threads:add":"comment-threads:add-local",payload:{cid:m,top:Math.round(o*f),left:Math.round(i*f),screen_cid:d,user_id:p.id,created_at:h,updated_at:h}}),c&&r({type:"comments:add",payload:{thread_cid:m,message:c,user_id:p.id,created_at:h,updated_at:h}}),r({type:"container:comment:select",payload:{select:l?null:m}})},"entry:comment-threads:update":function(e,t){var n=e.dispatch,r=e.getState,a=t.payload,o=a.cid,i=a.top,c=a.left,s=void 0===q.getState().find(function(e){return e.thread_cid===o}),l=.001*Date.now(),p=100/u(r());n({type:s?"comment-threads:update-local":"comment-threads:update",payload:{cid:o,top:Math.round(i*p),left:Math.round(c*p),updated_at:l}})},"entry:comment-threads:delete":function(e,t){var n=e.dispatch,r=t.payload.cid;n({type:"comment-threads:delete",payload:{cid:r}}),q.getState().forEach(function(e){return e.thread_cid===r&&n({type:"comments:delete-local",payload:e})})},"entry:comments:add":function(e,t){var n=e.dispatch,r=t.payload,a=r.thread_cid,o=r.message,i=Te.getState(),c=.001*Date.now();n({type:"comment-threads:save",payload:{cid:a}}),n({type:"comments:add",payload:{thread_cid:a,message:o,user_id:i.id,created_at:c,updated_at:c}}),n({type:"container:comment:select",payload:{select:null}})},"entry:comments:update":function(e,t){var n=e.dispatch,r=t.payload;n({type:"comments:update",payload:{cid:r.cid,message:r.message,updated_at:.001*Date.now()}})},"entry:state:push-data":function(e,t){var n=e.dispatch,r=t.payload,a=r.pushType,o=r.action,i=r.data;switch(a){case"comment-threads":var c=X.getState().find(function(e){return e.cid===i.cid});"update"!==o||c?"update"===o&&c?n({type:"comment-threads:update-local",payload:i}):"destroy"===o&&c&&(n({type:"comment-threads:delete-local",payload:i}),q.getState().forEach(function(e){return e.thread_cid===i.cid&&n({type:"comments:delete-local",payload:e})})):n({type:"comment-threads:add-local",payload:i});break;case"comments":var s=q.getState().find(function(e){return e.cid===i.cid});"update"!==o||s?"update"===o&&s?n({type:"comments:update-local",payload:i}):"destroy"===o&&s&&n({type:"comments:delete-local",payload:i}):n({type:"comments:add-local",payload:i});var l=Le.getState().screenCid,u=X.getState().find(function(e){return e.cid===i.thread_cid});u&&u.screen_cid===l&&n({type:"unread-comment:set-unread",payload:{commentCid:i.cid,threadCid:u.cid,screenCid:l}})}},"entry:projects:delete":function(e,t){var n=e.dispatch,r=t.payload,a=Te.getState(),o=r.owner_id===a.id||r.canAdmin()&&r.team_cid,i=o?I18N.del_app_title:I18N.exit_app_title,c=[v.a.createElement("p",{key:"1"},v.a.createElement(g.a,{variableMap:{verb:o?"delete":"leave",noun:"app",ugn:v.a.createElement(y.a,{name:r.name,withQuote:!0,withQuestionMark:"en"===MBLocale})}})),o&&v.a.createElement("p",{key:"2",className:"desc tertiary",dangerouslySetInnerHTML:{__html:I18N.del_app_desc_more}})];n({type:"container:modal:open",payload:{title:i,desc:c,canCancel:!0,canConfirm:!0,onConfirm:function(){if(o)n({type:"projects:delete",payload:r});else{var e=L.getState().find(function(e){return e.project_cid===r.cid&&e.user_id===a.id});n({type:"collaborators:delete",payload:e}),n({type:"projects:delete-local",payload:r})}s.a.SpineModel.queueSave()}}})},"entry:teams:delete":function(e,t){var n=e.dispatch,r=t.payload,a=Te.getState(),o=r.owner_id===a.id;if(o&&r.cprojects().length>0)return n({type:"container:modal:open",payload:{title:I18N.warning,desc:I18N.delete_projects_first,canCancel:!1,canConfirm:!0}});var i=v.a.createElement(g.a,{variableMap:{verb:o?"delete":"leave",noun:"team",ugn:v.a.createElement(y.c,{name:r.name,withQuote:!0,withQuestionMark:"en"===MBLocale})}});n({type:"container:modal:open",payload:{title:o?I18N.del_team_title:I18N.exit_team_title,desc:i,canCancel:!0,canConfirm:!0,onConfirm:function(){if(o)n({type:"teams:delete",payload:r});else{var e=L.getState().find(function(e){return e.team_cid===r.cid&&e.user_id===a.id});n({type:"collaborators:delete",payload:e}),n({type:"teams:delete-local",payload:r})}}}})}});function Ve(e,t){var n=t.getState,r=t.setState,a=n();return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,o=arguments[1];return o.type!==e?t:(r(o.payload||t),n())}}var Ge={collaborators:Ve("reducer:collaborators:update",L),comments:Ve("reducer:comments:update",q),commentThreads:Ve("reducer:comment-threads:update",X),projects:Ve("reducer:projects:update",te),screens:Ve("reducer:screens:update",se),teams:Ve("reducer:teams:update",me),widgets:Ve("reducer:widgets:update",Ee),user:Object(a.createStateStoreReducer)("reducer:user:update",Te),current:Object(a.createStateStoreReducer)("reducer:current:update",Le),unreadComment:Object(a.createStateStoreReducer)("reducer:unread-comment:update",ze)},Ke=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Xe=Object(i.composeWithDevTools)({});t.a=function(e){var t=e.viewMap,n=e.containerReducerMap,i=e.sagaMap,s=e.extendCallback,l=new c.a;if(t)for(var u in t)l.setView(u,t[u]);var p=function(e){var t=e.entryMap,n=e.reducerMap,i=e.sagaMap,c=Object(a.createReduxEntry)(),s=c.middleware;(0,c.setEntryMap)(t);var l=void 0,u=[s];i&&(l=Object(o.a)(),u.push(l));var p=Object(r.createStore)(Object(r.combineReducers)(n),Xe(r.applyMiddleware.apply(void 0,u)));if(i){var d=function(e){l.run(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,i[e]();case 3:t.next=0;break;case 5:case"end":return t.stop()}},t,this)}))};for(var f in i)d(f)}return{store:p}}({initialState:{model:{},container:{}},entryMap:Ke({},He,h,{"entry:webpack-interface:view:call":function(e,t){var n=t.payload;setTimeout(function(){return l.callViewMethod.apply(l,[n.name,n.method].concat(n.args||{}))},0)}}),reducerMap:{model:Object(r.combineReducers)(Ge),container:Object(r.combineReducers)(n)},sagaMap:i}).store;return l.setStore(p),s&&s(l),l}},"7tbW":function(e,t,n){var r=n("LGYb");e.exports=function(e){return e&&e.length?r(e):[]}},"92lH":function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"d",function(){return s}),n.d(t,"b",function(){return l}),n.d(t,"c",function(){return d}),n.d(t,"e",function(){return f});var r=n("Ev6p"),a=n("mbVZ"),o=n("udQi"),i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c={type:"@@redux-saga/CHANNEL_END"},s=function(e){return e&&"@@redux-saga/CHANNEL_END"===e.type};function l(){var e=[];return{subscribe:function(t){return e.push(t),function(){return Object(r.t)(e,t)}},emit:function(t){for(var n=e.slice(),r=0,a=n.length;r<a;r++)n[r](t)}}}var u="invalid buffer passed to channel factory function",p="Saga was provided with an undefined action";function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.a.none(),n=arguments[2];arguments.length>2&&Object(r.g)(n,r.n.func,"Invalid match function passed to eventChannel");var o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.a.fixed(),t=!1,n=[];function o(){if(t&&n.length)throw Object(r.m)("Cannot have a closed channel with pending takers");if(n.length&&!e.isEmpty())throw Object(r.m)("Cannot have pending takers with non empty buffer")}return Object(r.g)(e,r.n.buffer,u),{take:function(a){o(),Object(r.g)(a,r.n.func,"channel.take's callback must be a function"),t&&e.isEmpty()?a(c):e.isEmpty()?(n.push(a),a.cancel=function(){return Object(r.t)(n,a)}):a(e.take())},put:function(a){if(o(),Object(r.g)(a,r.n.notUndef,p),!t){if(!n.length)return e.put(a);for(var i=0;i<n.length;i++){var c=n[i];if(!c[r.b]||c[r.b](a))return n.splice(i,1),c(a)}}},flush:function(n){o(),Object(r.g)(n,r.n.func,"channel.flush' callback must be a function"),t&&e.isEmpty()?n(c):n(e.flush())},close:function(){if(o(),!t&&(t=!0,n.length)){var e=n;n=[];for(var r=0,a=e.length;r<a;r++)e[r](c)}},get __takers__(){return n},get __closed__(){return t}}}(t),i=function(){o.__closed__||(l&&l(),o.close())},l=e(function(e){s(e)?i():n&&!n(e)||o.put(e)});if(o.__closed__&&l(),!r.n.func(l))throw new Error("in eventChannel: subscribe should return a function to unsubscribe");return{take:o.take,flush:o.flush,close:i}}function f(e){var t=d(function(t){return e(function(e){e[r.c]?t(e):Object(o.a)(function(){return t(e)})})});return i({},t,{take:function(e,n){arguments.length>1&&(Object(r.g)(n,r.n.func,"channel.take's matcher argument must be a function"),e[r.b]=n),t.take(e)}})}},"9Nap":function(e,t){e.exports=function(e){return e}},"9NmV":function(e,t){var n="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",r="["+n+"]",a="\\d+",o="[\\u2700-\\u27bf]",i="[a-z\\xdf-\\xf6\\xf8-\\xff]",c="[^\\ud800-\\udfff"+n+a+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",s="(?:\\ud83c[\\udde6-\\uddff]){2}",l="[\\ud800-\\udbff][\\udc00-\\udfff]",u="[A-Z\\xc0-\\xd6\\xd8-\\xde]",p="(?:"+i+"|"+c+")",d="(?:"+u+"|"+c+")",f="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",h="[\\ufe0e\\ufe0f]?"+f+("(?:\\u200d(?:"+["[^\\ud800-\\udfff]",s,l].join("|")+")[\\ufe0e\\ufe0f]?"+f+")*"),m="(?:"+[o,s,l].join("|")+")"+h,v=RegExp([u+"?"+i+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[r,u,"$"].join("|")+")",d+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[r,u+p,"$"].join("|")+")",u+"?"+p+"+(?:['’](?:d|ll|m|re|s|t|ve))?",u+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",a,m].join("|"),"g");e.exports=function(e){return e.match(v)||[]}},"9ggG":function(e,t){e.exports=function(e){return e}},"9ndP":function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a});var r={sticky:{bg:"#FFFBBA"},status_bar:{bg:"#f8f8f8"},status_bar_android:{bg:"#555555"},image_view:{bg:"#e5e5e5",tc:"#bec2c9"},rounded_rect:{bg:"#FFFFFF"},circle_rect:{bg:"#FFFFFF"},triangleb:{tc:"#e5e5e5"},triangletl:{tc:"#e5e5e5"},button:{bg:"#ffffff"},navigation_bar:{bg:"#f8f8f8"},tab_bar:{bg:"#f8f8f8"},rectangle:{bg:"#ffffff"},mtext_input:{bg:"#ffffff",tc:"#888888"},mtextarea:{bg:"#ffffff",tc:"#888888"},tc:"#101010",bg:"transparent",bc:"#bbbbbb",sc:"#aaaaaa"},a=["transparent","#ffffff","#3f51b5","#ff4081","#e51c23","#009688","#259b24","#8bc34a","#ff9800"]},AbUM:function(e,t){},An9T:function(e,t){e.exports={shell:"xQWL5y1StSdX9vRfMCP2i"}},CMye:function(e,t,n){var r=n("GoyQ");e.exports=function(e){return e==e&&!r(e)}},CUi3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayActMap=t.objectActMap=t.ArrayOf=t.ObjectAs=void 0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=n("JGuq"),o=n("OBS2"),i=a.Operation.objectSet,c=a.Operation.objectDelete,s=a.Operation.objectMerge,l=a.Operation.arraySet,u=a.Operation.arrayDelete,p=a.Operation.arrayInsert,d=a.Operation.arrayPush,f=a.Operation.arrayUnshift,h=a.Operation.arrayPop,m=a.Operation.arrayShift,v=a.Operation.arrayConcat,g=a.Operation.arrayMatchPush,y=a.Operation.arrayMatchDelete,b=a.Operation.arrayMatchMove,w=a.Operation.arrayFindPush,C=a.Operation.arrayFindDelete,E=a.Operation.arrayFindMove,S=a.Operation.arrayFindSet,O={set:function(e,t){var n=t.key,r=t.value;return i(e,n,r)},delete:function(e,t){var n=t.key;return c(e,n)},merge:function(e,t){var n=t.merge;return s(e,n)}},_={set:function(e,t){var n=t.index,r=t.value;return l(e,n,r)},delete:function(e,t){var n=t.index;return u(e,n)},insert:function(e,t){var n=t.index,r=t.value;return p(e,n,r)},push:function(e,t){var n=t.value;return d(e,n)},pop:function(e,t){return h(e)},shift:function(e,t){return m(e)},unshift:function(e,t){var n=t.value;return f(e,n)},concat:function(e,t){var n=t.concat;return v(e,n)},matchPush:function(e,t){var n=t.value;return g(e,n)},matchDelete:function(e,t){var n=t.value;return y(e,n)},matchMove:function(e,t){var n=t.index,r=t.value;return b(e,n,r)},findPush:function(e,t){var n=t.find,r=t.value;return w(e,n,r)},findDelete:function(e,t){var n=t.find;return C(e,n)},findMove:function(e,t){var n=t.find,r=t.index;return E(e,n,r)},findSet:function(e,t){var n=t.find,r=t.value;return S(e,n,r)}};t.ObjectAs=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new o.ObjectScheme(e,r({},t),r({},O,n))},t.ArrayOf=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new o.ArrayScheme(e,[t],r({},_,n))},t.objectActMap=O,t.arrayActMap=_},DqDi:function(e,t,n){"use strict";n.d(t,"a",function(){return b}),n.d(t,"b",function(){return w});var r=n("17x9"),a=n.n(r),o=n("q1tI"),i=n.n(o),c=n("M8nv"),s=n.n(c),l=n("i6OX"),u=n("UbMB"),p=n.n(u),d=n("G916"),f=n.n(d);function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var g=p.a.bind(f.a);var y=function(e){function t(){return h(this,t),m(this,e.apply(this,arguments))}return v(t,e),t.prototype.render=function(){var e=this.props,t=e.activeIndex,n=e.hideBorder,r=e.className,a=e.children,c=e.onTabChange,s=function(e,t,n){return{transform:"translateX("+100*e+"%)",borderLeftColor:n&&0===e?"transparent":"",borderRightColor:n&&e===t-1?"transparent":""}}(t,o.Children.count(a),n);return i.a.createElement("ol",{className:g("nav",r)},o.Children.map(a,function(e,n){var r={index:n,active:n===t,BgStyle:0===n?s:null,onClick:c};return i.a.cloneElement(e,r)}))},t}(o.Component);t.c=y,y.propTypes={className:a.a.string,activeIndex:a.a.number,hideBorder:a.a.bool,children:a.a.array,onTabChange:a.a.func},y.defaultProps={hideBorder:!1,activeIndex:0};var b=function(e){function t(n){h(this,t);var r=m(this,e.call(this,n));return r.handleClick=function(e){var t=r.props,n=t.index,a=t.active,o=t.onClick;a?r.toggleDropDown(e):o(n)},r.toggleDropDown=function(e){e.stopPropagation();var t=r.body.getBoundingClientRect();r.setState({dropDownOpen:!r.state.dropDownOpen,top:t.bottom,left:(t.left+t.right)/2})},r.handleDocClick=function(e){r.state.dropDownOpen&&r.body&&!r.body.contains(e.target)&&r.setState({dropDownOpen:!1})},r.handleClose=function(){r.setState({dropDownOpen:!1})},r.state={dropDownOpen:!1},r}return v(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.index,r=t.active,a=t.icon,o=t.label,c=t.title,u=t.BgStyle,p=t.DropDown,d=this.state,f=d.dropDownOpen,h=d.top,m=d.left,v=Boolean(p);return i.a.createElement("li",{ref:function(t){return e.body=t},className:g("nav-item",{active:r}),title:c,onClick:this.handleClick},0===n&&i.a.createElement("div",{className:"background-cube",style:u}),i.a.createElement("div",{className:"nav-icon"},i.a.createElement(l.b,{type:"dora",name:a}),v&&i.a.createElement("i",{className:"fa fa-caret-down",type:"dropdown-arrow",onClick:this.toggleDropDown})),o&&i.a.createElement("span",{className:"nav-label"},o),v&&f&&i.a.createElement(p,{top:h,left:m,onClose:this.handleClose}),v&&i.a.createElement(s.a,{onClick:this.handleDocClick}))},t}(o.Component);b.propTypes={index:a.a.number,icon:a.a.string,title:a.a.string,label:a.a.string,active:a.a.bool,BgStyle:a.a.object,onClick:a.a.func,DropDown:a.a.func};var w=function(e){var t=e.tabs,n=e.activeIndex,r=e.onChange,a=e.className,o=e.hideBorder,c=e.BgStyle;return i.a.createElement(y,{activeIndex:n,hideBorder:o,onTabChange:r,className:a},t.map(function(e){var t=e.label,n=e.icon;return i.a.createElement(b,{key:t,icon:n,label:t,BgStyle:c})}))};w.propTypes={tabs:a.a.array,activeIndex:a.a.number,onChange:a.a.func,className:a.a.string,hideBorder:a.a.bool,BgStyle:a.a.object}},EDI8:function(e,t){e.exports={"zoom-count":"_2nN0xGcLm4nwqxIkoQCnMF"}},Em2t:function(e,t,n){var r=n("bahg"),a=n("quyA"),o=n("0JQy");e.exports=function(e){return a(e)?o(e):r(e)}},Ev6p:function(e,t,n){"use strict";n.d(t,"u",function(){return o}),n.d(t,"e",function(){return i}),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return p}),n.d(t,"o",function(){return f}),n.d(t,"r",function(){return h}),n.d(t,"l",function(){return m}),n.d(t,"g",function(){return v}),n.d(t,"n",function(){return b}),n.d(t,"s",function(){return w}),n.d(t,"t",function(){return C}),n.d(t,"f",function(){return E}),n.d(t,"i",function(){return S}),n.d(t,"j",function(){return O}),n.d(t,"v",function(){return _}),n.d(t,"q",function(){return T}),n.d(t,"p",function(){return k}),n.d(t,"k",function(){return M}),n.d(t,"w",function(){return N}),n.d(t,"m",function(){return R}),n.d(t,"h",function(){return I}),n.d(t,"x",function(){return L});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){return"@@redux-saga/"+e},i=o("TASK"),c=o("HELPER"),s=o("MATCH"),l=o("CANCEL_PROMISE"),u=o("SAGA_ACTION"),p=o("SELF_CANCELLATION"),d=function(e){return function(){return e}},f=d(!0),h=function(){},m=function(e){return e};function v(e,t,n){if(!t(e))throw k("error","uncaught at check",n),new Error(n)}var g=Object.prototype.hasOwnProperty;function y(e,t){return b.notUndef(e)&&g.call(e,t)}var b={undef:function(e){return null===e||void 0===e},notUndef:function(e){return null!==e&&void 0!==e},func:function(e){return"function"==typeof e},number:function(e){return"number"==typeof e},string:function(e){return"string"==typeof e},array:Array.isArray,object:function(e){return e&&!b.array(e)&&"object"===(void 0===e?"undefined":a(e))},promise:function(e){return e&&b.func(e.then)},iterator:function(e){return e&&b.func(e.next)&&b.func(e.throw)},iterable:function(e){return e&&b.func(Symbol)?b.func(e[Symbol.iterator]):b.array(e)},task:function(e){return e&&e[i]},observable:function(e){return e&&b.func(e.subscribe)},buffer:function(e){return e&&b.func(e.isEmpty)&&b.func(e.take)&&b.func(e.put)},pattern:function(e){return e&&(b.string(e)||"symbol"===(void 0===e?"undefined":a(e))||b.func(e)||b.array(e))},channel:function(e){return e&&b.func(e.take)&&b.func(e.close)},helper:function(e){return e&&e[c]},stringableFunc:function(e){return b.func(e)&&y(e,"toString")}},w={assign:function(e,t){for(var n in t)y(t,n)&&(e[n]=t[n])}};function C(e,t){var n=e.indexOf(t);n>=0&&e.splice(n,1)}var E={from:function(e){var t=Array(e.length);for(var n in e)y(e,n)&&(t[n]=e[n]);return t}};function S(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=r({},e),n=new Promise(function(e,n){t.resolve=e,t.reject=n});return t.promise=n,t}function O(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=void 0,r=new Promise(function(r){n=setTimeout(function(){return r(t)},e)});return r[l]=function(){return clearTimeout(n)},r}var _=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(){return++e}}(),j=function(e){throw e},x=function(e){return{value:e,done:!0}};function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments[3],a={name:n,next:e,throw:t,return:x};return r&&(a[c]=!0),"undefined"!=typeof Symbol&&(a[Symbol.iterator]=function(){return a}),a}function k(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";"undefined"==typeof window?console.log("redux-saga "+e+": "+t+"\n"+(n&&n.stack||n)):console[e](t,n)}function M(e,t){return function(){return e.apply(void 0,arguments)}}var N=function(e,t){return e+" has been deprecated in favor of "+t+", please update your code"},R=function(e){return new Error("\n  redux-saga: Error checking hooks detected an inconsistent state. This is likely a bug\n  in redux-saga code and not yours. Thanks for reporting this in the project's github repo.\n  Error: "+e+"\n")},I=function(e,t){return(e?e+".":"")+"setContext(props): argument "+t+" is not a plain object"},L=function(e){return function(t){return e(Object.defineProperty(t,u,{value:!0}))}}},G916:function(e,t){e.exports={nav:"xnJdrPjsJoJrp1VupFyUM","nav-item":"_3UspVqDrjxaWG9BSMdj9jf"}},GDhZ:function(e,t,n){var r=n("wF/u"),a=n("mwIZ"),o=n("hgQt"),i=n("9ggG"),c=n("CMye"),s=n("IOzZ"),l=n("9Nap"),u=1,p=2;e.exports=function(e,t){return i(e)&&c(t)?s(l(e),t):function(n){var i=a(n,e);return void 0===i&&i===t?o(n,e):r(t,i,u|p)}}},GEF2:function(e,t){e.exports={"preview-panel-wrapper":"_3NbQHmHCb3fdbejXqycbnR","search-container":"_3y2eVBvrGh0CBoLYjLE40z","preview-panel":"_972Atke01Y16jEOOPRt5R",search:"_13IXTqPxDZ7St_EVHky1im",expand:"_33UQXp4eOmuoqfuCsfYqsu"}},HDyB:function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},IOzZ:function(e,t){e.exports=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}}},IT1M:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("JGuq");Object.defineProperty(t,"Operation",{enumerable:!0,get:function(){return r.Operation}});var a=n("OBS2");Object.defineProperty(t,"Scheme",{enumerable:!0,get:function(){return a.Scheme}}),Object.defineProperty(t,"ObjectScheme",{enumerable:!0,get:function(){return a.ObjectScheme}}),Object.defineProperty(t,"ArrayScheme",{enumerable:!0,get:function(){return a.ArrayScheme}});var o=n("CUi3");Object.defineProperty(t,"ObjectAs",{enumerable:!0,get:function(){return o.ObjectAs}}),Object.defineProperty(t,"ArrayOf",{enumerable:!0,get:function(){return o.ArrayOf}}),Object.defineProperty(t,"objectActMap",{enumerable:!0,get:function(){return o.objectActMap}}),Object.defineProperty(t,"arrayActMap",{enumerable:!0,get:function(){return o.arrayActMap}})},IV71:function(e,t,n){"use strict";var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=null,this.viewMap={},this.observerMap={}}return e.prototype.setStore=function(e){this.store=e},e.prototype.callObserver=function(e){for(var t,n=arguments.length,r=Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return this.observerMap[e]&&(t=this.observerMap)[e].apply(t,[e].concat(r))},e.prototype.setObserver=function(e,t){this.observerMap[e]=t},e.prototype.setView=function(e,t){this.viewMap[e]=t},e.prototype.callViewMethod=function(e,t){for(var n,r=this.viewMap[e],a=arguments.length,o=Array(a>2?a-2:0),i=2;i<a;i++)o[i-2]=arguments[i];return r&&r[t]?(this.callObserver("view:"+e+":"+t),r[t].apply(r,[this.store].concat(o))):(n=console).warn.apply(n,["[WebpackInterface][callViewMethod] missed",e,t].concat(o))},e.prototype.init=function(){this.callObserver("init"),this.store&&this.store.dispatch({type:"entry:state:init"})},e.prototype.clear=function(){this.store&&this.store.dispatch({type:"entry:state:clear"}),this.callObserver("clear")},e}();function a(e){var t={containerReducerMap:{},viewMap:{},sagaMap:{},extendCallback:null};return e.forEach(function(e){t.containerReducerMap=o(i,t.containerReducerMap,e.containerReducerMap),t.viewMap=o(i,t.viewMap,e.viewMap),t.extendCallback=o(c,t.extendCallback,e.extendCallback),t.sagaMap=o(i,t.sagaMap,e.sagaMap)}),t}function o(e,t,n){return n?t?e(t,n):n:t}function i(e,t){var n={};function r(e,t){n[e]=t}for(var a in e)r(a,e[a]);for(var o in t)r(o,t[o]);return n}function c(e,t){return function(){return e.apply(void 0,arguments),t.apply(void 0,arguments)}}n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a})},J2m7:function(e,t,n){var r=n("XKAG")(n("UfWW"));e.exports=r},JGuq:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var o={objectSet:function(e,t,n){return e[t]!==n?r({},e,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t,n)):e},objectDelete:function(e,t){if(!(t in e))return e;var n=r({},e);return delete n[t],n},objectMerge:function(e,t){for(var n in t){var a=t[n];if(e[n]!==a)return r({},e,t)}return e},arraySet:function(e,t,n){if(e[t]===n)return e;var r=[].concat(a(e));return r[t]=n,r},arrayDelete:function(e,t){return t>=0&&t<=e.length-1?[].concat(a(e.slice(0,t)),a(e.slice(t+1))):e},arrayInsert:function(e,t,n){return t=Math.min(Math.max(t,0),e.length),[].concat(a(e.slice(0,t)),[n],a(e.slice(t)))},arrayPush:function(e,t){return[].concat(a(e),[t])},arrayUnshift:function(e,t){return[t].concat(a(e))},arrayPop:function(e){if(0===e.length)return e;var t=[].concat(a(e));return t.pop(),t},arrayShift:function(e){if(0===e.length)return e;var t=[].concat(a(e));return t.shift(),t},arrayConcat:function(e,t){return t&&t.length?[].concat(a(e),a(t)):e},arrayMatchPush:function(e,t){return e.includes(t)?e:[].concat(a(e),[t])},arrayMatchDelete:function(e,t){var n=e.indexOf(t);return~n?[].concat(a(e.slice(0,n)),a(e.slice(n+1))):e},arrayMatchMove:function(e,t,n){t=Math.min(Math.max(t,0),e.length-1);var r=e.indexOf(n);return~r&&r!==t?r<t?[].concat(a(e.slice(0,r)),a(e.slice(r+1,t+1)),[n],a(e.slice(t+1))):[].concat(a(e.slice(0,t)),[n],a(e.slice(t,r)),a(e.slice(r+1))):e},arrayFindPush:function(e,t,n){return void 0===e.find(t)?[].concat(a(e),[n]):e},arrayFindDelete:function(e,t){var n=e.findIndex(t);return~n?[].concat(a(e.slice(0,n)),a(e.slice(n+1))):e},arrayFindMove:function(e,t,n){var r=e.findIndex(t),o=e[r];return~r&&r!==n?r<n?[].concat(a(e.slice(0,r)),a(e.slice(r+1,n+1)),[o],a(e.slice(n+1))):[].concat(a(e.slice(0,n)),[o],a(e.slice(n,r)),a(e.slice(r+1))):e},arrayFindSet:function(e,t,n){var r=e.findIndex(t);if(!~r||e[r]===n)return e;var o=[].concat(a(e));return o[r]=n,o}};t.Operation=o},JhsL:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=!1},KKmY:function(e,t){},Ku8Y:function(e,t){e.exports={"editable-span":"_3kZ6Tt9vKO7jl4aGylRTa6","reply-textarea":"_2MMdtZStiVFrqpPWeqIzKH","btn-sort":"_3U9vAHumYl9Ansn9gzYs05","btn-cancel":"_1whvmqsHCmt8iyBc4KMnAF","btn-sure":"_3cG_7EkzOzZEovmV1UHoBq",container:"_1qDeu3cpB7cYXe6lqzlO5Q",avatarInform:"_11prqogEAAMMYQDJ2WNa86",avatar:"xGJm0OmgYp2ExjB9P_BYP","avatar-slide":"_1C_8aOGkoIAasZipcKGlxM",index:"_6wvUm87_ziDGV5DTBxNih",name:"_1Px7EkIhdlrwi7as8ggVbs"}},KwMD:function(e,t){e.exports=function(e,t,n,r){for(var a=e.length,o=n+(r?1:-1);r?o--:++o<a;)if(t(e[o],o,e))return o;return-1}},KxBF:function(e,t){e.exports=function(e,t,n){var r=-1,a=e.length;t<0&&(t=-t>a?0:a+t),(n=n>a?a:n)<0&&(n+=a),a=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(a);++r<a;)o[r]=e[r+t];return o}},LGYb:function(e,t,n){var r=n("1hJj"),a=n("jbM+"),o=n("Xt/L"),i=n("xYSL"),c=n("dQpi"),s=n("rEGp"),l=200;e.exports=function(e,t,n){var u=-1,p=a,d=e.length,f=!0,h=[],m=h;if(n)f=!1,p=o;else if(d>=l){var v=t?null:c(e);if(v)return s(v);f=!1,p=i,m=new r}else m=t?[]:h;e:for(;++u<d;){var g=e[u],y=t?t(g):g;if(g=n||0!==g?g:0,f&&y==y){for(var b=m.length;b--;)if(m[b]===y)continue e;t&&m.push(y),h.push(g)}else p(m,y,n)||(m!==h&&m.push(y),h.push(g))}return h}},Lyer:function(e,t,n){"use strict";var r=n("17x9"),a=n.n(r),o=n("q1tI"),i=n.n(o),c=n("hCcZ"),s=n("rwIS"),l=n.n(s),u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=function(e){return MB.localStorageDelegate.setItem("guide_closed_"+e,!0)},f=function(e){function t(){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=Array(a),i=0;i<a;i++)o[i]=arguments[i];return n=r=p(this,e.call.apply(e,[this].concat(o))),r.setGuideRef=function(e){return r.guide=e},r.handleCloseGuideManually=function(){d(r.props.id)},p(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.render=function(){var e=this.props,t=e.id,n=e.isOpen,r=e.children,a=e.localeKey,o=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["id","isOpen","children","localeKey"]);if(function(e){return"true"===MB.localStorageDelegate.getItem("guide_closed_"+e)}(t))return r;var s=I18N.guide_base[a||t],p=s.header,d=s.content;return i.a.createElement(c.a,u({ref:this.setGuideRef,isOpen:n,onClose:this.handleCloseGuideManually,className:l.a["guide-button"],header:p,guide:i.a.createElement("div",{dangerouslySetInnerHTML:{__html:d}}),unfold:"left"},o),r)},t}(o.PureComponent);t.a=f,f.propTypes={id:a.a.string.isRequired,isOpen:a.a.bool,localeKey:a.a.string,children:a.a.element},f.defaultProps={gotItText:I18N.guide_base.got_it}},M8nv:function(e,t,n){e.exports=n("eaeY")},NYM8:function(e,t){},O7RO:function(e,t,n){var r=n("CMye"),a=n("7GkX");e.exports=function(e){for(var t=a(e),n=t.length;n--;){var o=t[n],i=e[o];t[n]=[o,i,r(i)]}return t}},OBS2:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(e,t){return t.forEach(function(n){e.has(n)&&console.error("duplicate name in set",e,t,n),e.add(n)}),e},l=function(e){return(t=e)instanceof Object&&"toStructJSON"in t?e.toStructJSON():e;var t},u=function(e,t){return console.error("DEFAULT_REDUCER",e,t),e},p=function(){function e(t,n,r){c(this,e),this.name=t,this.struct=n,this.actMap=r,this.initialState=null,this.acceptNameSet=null,this.actionReducer=null,this.structReducer=null,this.reducer=null}return a(e,[{key:"getActionReducer",value:function(){var e=this.actMap;return function(t,n){var r=n.type,a=n.payload,o=e[r];return o?o(t,a):t}}},{key:"getReducer",value:function(){var e=this.name,t=this.initialState,n=this.acceptNameSet,r=this.actionReducer,a=this.structReducer,o=function(t,n){return void 0!==n.type&&n.name===e?r(t,n):a(t,n)};return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,a=arguments[1];return n.has(a.name)?void 0!==a.batch&&a.name===e?a.batch.reduce(o,r):o(r,a):r}}},{key:"toStructJSON",value:function(){return l(this.struct)}}]),e}(),d=function(e){function t(e,n,r){c(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,r)),i={},l=new Set;l.add(a.name);var u=[];for(var d in a.struct)if(a.struct.hasOwnProperty(d)){var f=a.struct[d],h=f instanceof p;i[d]=h?f.initialState:f,h&&(s(l,f.acceptNameSet),u.push(d))}return a.initialState=i,a.acceptNameSet=l,a.structReducer=t.getStructReducer(u,a.struct),a.actionReducer=a.getActionReducer(),a.reducer=a.getReducer(),a}return i(t,p),a(t,[{key:"toStructJSON",value:function(){return function(e,t){var n={};for(var r in e)n[r]=t(e[r],r);return n}(this.struct,l)}}],[{key:"getStructReducer",value:function(e,t){return function(n,a){for(var o=!1,i={},c=0;c<e.length;c++){var s=e[c],l=t[s],u=n[s],p=l.reducer(u,a);i[s]=p,o=o||p!==u}return o?r({},n,i):n}}}]),t}(),f=function(e){function t(e,n,r){c(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,r)),i=a.struct[0],s=i instanceof p,l=new Set;return l.add(a.name),a.initialState=[],a.acceptNameSet=l,a.structReducer=s?t.getStructReducer(i):u,a.actionReducer=a.getActionReducer(),a.reducer=a.getReducer(),a}return i(t,p),a(t,[{key:"toStructJSON",value:function(){return this.struct.map(l)}}],[{key:"getStructReducer",value:function(e){return function(n,r){var a=!1,o=null;function i(t,r,i){var c=e.reducer(t,r);t!==c&&(a||(o=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(n))),o[i]=c,a=!0)}if(void 0!==r.index)i(n[r.index],r.payload,r.index);else if(void 0!==r.filter){var c=t.getFilter(r.filter);c&&n.forEach(function(e,t){return c(e,t)&&i(e,r.payload,t)})}return a?o:n}}},{key:"getFilter",value:function(e){switch(e.type){case"key-value":var t=e.key,n=e.value;return function(e,r){return e[t]===n}}return null}}]),t}();t.Scheme=p,t.ObjectScheme=d,t.ArrayScheme=f},P3rE:function(e,t){},PYuP:function(e,t,n){"use strict";n("j21k");var r=n("bz01"),a=(n("vece"),n("9DKN")),o=n("q1tI"),i=n.n(o),c=n("17x9"),s=n.n(c),l=n("6hLF"),u=n("lVR5"),p=n("wCGR"),d=n("7Qib"),f=n("nLLt"),h=n("XkTy"),m=n("rbsZ"),v=n("zAG7"),g=(n("mnpx"),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e});function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function w(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var C=I18N.open_parenthesis+I18N.pending+I18N.close_parenthesis,E={user:0,owner:1,admin:2,editor:3,viewer:4},S=function(e){var t=e.host,n=e.userRole;return(t.isTeam()&&Object(f.a)("team-collaborator-update","admin",n)?["viewer","editor","admin"]:["viewer","editor"]).map(function(e){return{value:e,label:""+I18N.roles[e]+I18N.colon+I18N.roles[e+"_desc"]}})},O=function(e,t){var n=E[e.user_id===MB.user.id?"user":e.role],r=E[t.user_id===MB.user.id?"user":t.role];return n!==r?n-r:e.name&&t.name?e.name.localeCompare(t.name):!e.name&&t.name?1:e.name&&!t.name?-1:e.email.localeCompare(t.email)},_=function(e){function t(){var n,r;y(this,t);for(var a=arguments.length,o=Array(a),i=0;i<a;i++)o[i]=arguments[i];return n=r=b(this,e.call.apply(e,[this].concat(o))),r.onChangeRole=function(e){var t=e.value;r.props.onChangeRole({collaborator:r.props.collaborator,role:t}),r.forceUpdate()},r.onDeleteCollaborator=function(){return r.props.onDeleteCollaborator(r.props.collaborator)},b(r,n)}return w(t,e),t.prototype.render=function(){var e=this.props,t=e.collaborator,n=e.host,r=e.userRole,o=t.avatar,c=t.name,s=t.email,u=t.role,p=S({host:n,userRole:r}),d=function(e){var t=e.host,n=e.collaborator,r=e.userRole;return Object(f.a)(t.isTeam()&&"team","collaborator-update",n.role,r)}({host:n,collaborator:t,userRole:r});return i.a.createElement("li",{className:"collaborator"},i.a.createElement("div",{className:"user"},i.a.createElement("img",{className:"avatar",src:o}),i.a.createElement("span",{className:"user-name"},c||s),!c&&i.a.createElement("span",{className:"pending"},C)),d?i.a.createElement(l.i,{unstyled:!0,size:"small",optionList:p,value:u,onChange:this.onChangeRole}):i.a.createElement("span",{className:"role"},I18N.roles[u]),d&&i.a.createElement(a.a,{type:"text",size:"small",className:"delete",onClick:this.onDeleteCollaborator},I18N.delete))},t}(o.PureComponent);_.propTypes={dispatch:s.a.func,host:s.a.object,userRole:s.a.any,collaborator:s.a.object,onChangeRole:s.a.func,onDeleteCollaborator:s.a.func};var j=function(e){function t(n){y(this,t);var r=b(this,e.call(this,n));x.call(r),r.dedupEmailSetCached=null,r.promptMapCached=null;var a=!Object(f.a)(n.host.isTeam()&&"team","collaborator-create","viewer",n.userRole),o=a?I18N.owner_only:r.errorMsg(),i=!a;return r.state={formData:{email:"",role:"viewer"},promptList:[],isPromptListOpen:!1,errorMsg:o,promptPricing:i},r}return w(t,e),t.prototype.componentDidUpdate=function(e){!e.isOpen&&this.props.isOpen&&this.focusOnInput()},t.prototype.render=function(){var e=this,t=this.props,n=t.isOpen,o=t.onClose,c=t.host,s=t.userRole,u=this.state,p=u.formData,d=u.errorMsg,h=u.isPromptListOpen,v=u.promptPricing,g=S({host:c,userRole:s});return i.a.createElement(r.a,{isOpen:n,title:I18N.manage_collaborators,className:"collaborator-modal",onClose:o},function(e){var t=e.host,n=e.collaborator,r=e.userRole;return Object(f.a)(t.isTeam()&&"team","collaborator-create",n.role,r)}({host:c,userRole:s,collaborator:{role:"viewer"}})&&i.a.createElement("div",{className:"add-via-email"},i.a.createElement("input",{type:"email",placeholder:I18N.email_placeholder,onChange:this.updateEmail,onClick:this.showPromptList,onBlur:this.hidePromptList,value:p.email,autoComplete:"off"}),i.a.createElement(l.i,{unstyled:!0,size:"small",optionList:g,value:p.role,onChange:this.updateRole}),i.a.createElement(a.a,{type:"primary",size:"small",isDisabled:!p.email,onClick:this.onInvite},I18N.invite),this.renderPromptList(!h)),d&&i.a.createElement("div",{className:"error-msg "+(v?"has-prompt-pricing-btn":"")},i.a.createElement("span",null,d),v&&i.a.createElement("button",{onClick:m.b},I18N.check_pricing)),i.a.createElement("ul",{className:"collaborator-list"},c.collaborators().sort(O).map(function(t){return i.a.createElement(_,{key:t.email,host:c,userRole:s,collaborator:t,onChangeRole:e.onChangeRole,onDeleteCollaborator:e.onDeleteCollaborator})})))},t}(o.PureComponent);j.propTypes={isOpen:s.a.bool,onClose:s.a.func.isRequired,host:s.a.object,userRole:s.a.any};var x=function(){var e,t,n=this;this.errorMsg=function(){var e=n.props.host,t="";if(e&&e.collaborators().length>=e.limitation.collaborators+1){var r=e.limitation.collaborators?"collaborators":"cant_invite",a=e.owner_id==MB.user.id?"user":e.isTeam()?"team":"project",o=e.isTeam()?"renew":"upgrade";t=MB.renewMsg&&MB.renewMsg(r,{role:a,action:o,collaborators:e.limitation.collaborators,plan:e.owner_plan})}return t},this.updateComponent=function(){n.forceUpdate(),MB.webpackInterface&&MB.webpackInterface.refreshAll(),$("body").trigger("queue:save")},this.focusOnInput=function(){return setTimeout(function(){var e=document.querySelector('.collaborator-modal input[type="email"]');e&&e.focus()},100)},this.updateEmail=function(e){var t=e.target.value;return n.updatePromptList(t.trim().toLowerCase())},this.updateRole=function(e){var t=e.value;return n.setState(function(e){var n=e.formData;return{formData:g({},n,{role:t})}})},this.updatePromptList=function(e){if(e!==n.state.email){n.promptMapCached||(n.dedupEmailSetCached=new Set(n.props.host.collaborators().map(function(e){return e.email.toLowerCase()})),n.promptMapCached=Collaborator.all().filter(function(e){var t=e.cid,r=e.user_id,a=e.email;return!(r===MB.user.id||t.startsWith("co_MOCK_c")||t.startsWith("co_MOCK_t")&&!t.startsWith("co_MOCK_te")||n.dedupEmailSetCached.has(a.toLowerCase()))}).reduce(function(e,t){return t.name&&(e[t.name.toLowerCase()]=t),t.email&&(e[t.email.toLowerCase()]=t),e},{}));var t=e&&new RegExp(e,"i"),r=new Set(n.dedupEmailSetCached),a=new Set;for(var o in n.promptMapCached){if(a.size>=10)break;var i=n.promptMapCached[o],c=i.email.toLowerCase();t&&!t.test(o)||!c||r.has(c)||(r.add(c),a.add(i))}n.setState(function(t){var n=t.formData;return{formData:g({},n,{email:e}),isPromptListOpen:!0,promptList:Array.from(a)}})}},this.showPromptList=function(){return n.updatePromptList(n.state.formData.email)},this.hidePromptList=function(){return setTimeout(function(){n.dedupEmailSetCached=null,n.promptMapCached=null,n.setState({isPromptListOpen:!1})},100)},this.createOnClickPromptListItemHandler=function(e){return function(){return n.setState(function(t){var n=t.formData;return{formData:g({},n,{email:e}),promptList:[]}})}},this.renderPromptList=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=n.state.promptList;return e=e||0===t.length,i.a.createElement("ul",g({className:"prompt-list"},Object(d.c)(e)),t.map(function(e){return i.a.createElement("li",{key:e.email,onMouseDown:n.createOnClickPromptListItemHandler(e.email)},i.a.createElement("img",{className:"avatar",src:e.avatar}),i.a.createElement("span",{className:"user-name"},e.name||e.email),e.name?i.a.createElement("span",{className:"user-email"},e.email):i.a.createElement("span",{className:"pending"},C))}))},this.onInvite=function(){var e=n.props.host,t=n.state.formData,r=t.email,a=t.role,o=e.limitation,i=void 0===o?MB.user.limitation:o,c=e.collaborators(),s=void 0!==c.find(function(e){return e.email===r}),l=r&&v.a.test(r)?r===MB.user.email?I18N.cant_invite_yourself:s?I18N.already_invited:c.length>i.collaborators?n.errorMsg():null:I18N.invalid_email;l?(n.focusOnInput(),n.setState({errorMsg:l,promptPricing:c.length>i.collaborators})):(n.createCollaborator({email:r,role:a}),n.setState({formData:{email:"",role:"viewer"},promptPricing:!0}))},this.createCollaborator=function(e){var t=e.email,r=e.role,a=n.props.host,o=a.isTeam(),i=new Collaborator({email:t,role:r,cid:"co"+Math.uuid(10,16)+(new Date).valueOf(),avatar:"/images/avatar.png"});Object.assign(i,{team_cid:o&&a.cid,project_cid:!o&&a.cid}),i.lsave(),i.updateHostChannel("update"),n.updateComponent()},this.onChangeRole=function(e){var t=e.collaborator,r=e.role,a=n.props,o=a.host,i=a.userRole,c=o.isTeam();!Object(f.a)(c&&"team","collaborator-update",[t.role,r],i)||(Object.assign(t,{role:r}),t.lsave(),t.updateHostChannel("update"),n.updateComponent())},this.onDeleteCollaborator=(e=regeneratorRuntime.mark(function e(t){var r,a,o,c,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.props,a=r.dispatch,o=r.host,c=r.userRole,s=o.isTeam(),!!Object(f.a)(s&&"team","collaborator-delete",t.role,c)){e.next=5;break}return e.abrupt("return");case 5:return l=i.a.createElement(p.a,{variableMap:{verb:"delete",noun:"teamMember",ugn:i.a.createElement(u.e,{name:t.name||t.email,withQuote:!0,withQuestionMark:"en"===MBLocale})}}),e.next=8,Object(h.b)({dispatch:a,title:I18N.del_collaborator_title,desc:l});case 8:if(!e.sent){e.next=13;break}t.updateHostChannel("destroy"),t.ldestroy(),n.updateComponent(),n.setState({errorMsg:null});case 13:case"end":return e.stop()}},e,n)}),t=function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(a,o){try{var i=t[a](o),c=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(c).then(function(e){r("next",e)},function(e){r("throw",e)});e(c)}("next")})},function(e){return t.apply(this,arguments)})};t.a=j},QIyF:function(e,t,n){var r=n("Kz5y");e.exports=function(){return r.Date.now()}},QoRX:function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},QqLw:function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},RUem:function(e,t,n){"use strict";var r=n("q1tI"),a=n.n(r),o=n("17x9"),i=n.n(o),c=n("lVR5"),s=n("mfFm"),l=n.n(s),u=n("UbMB"),p=n.n(u),d=n("XrEr"),f=p.a.bind(l.a),h=function(e){var t=e.title,n=e.dataValue,r=void 0===n?[]:n,o=e.data,i=void 0===o?[]:o,s=e.text,l=e.color,u=e.className,p=e.colorUnit,h=e.first,m=Object(d.b)(l,"rgba"),g=Object(d.b)(l,p),y=r.length>0,b=4===r.length,w=f("panel",""+u,{"panel-bottom-8":!y,"panel-item-text":!!s,"shadow-panel":b});return l?a.a.createElement(v,{title:t,rgbaColor:m,stateColor:g}):a.a.createElement("div",{className:w,"data-value":t},s?a.a.createElement(c.d,{arrowed:!1,className:"panel-item item-flex-1",content:{click:I18N.preview_panel.copied},duration:1e3},a.a.createElement("div",{"data-type":"copy","data-placement":"top","data-clipboard-text":s,className:"panel-item-value text-content",dangerouslySetInnerHTML:{__html:s}})):a.a.createElement("div",{className:i.length<2?"single-panel-box":"mult-panel-box"},(h?i.slice(0,1):i).map(function(e,t){return a.a.createElement(c.d,{key:t,arrowed:!1,content:{click:I18N.preview_panel.copied},duration:1e3,className:"panel-item","data-value":r[t]},a.a.createElement("div",{"data-type":"copy","data-clipboard-text":e,className:"panel-item-value"},e))})))};h.propTypes={title:i.a.string,data:i.a.array,dataValue:i.a.array,text:i.a.string,color:i.a.string,colorUnit:i.a.string,first:i.a.bool,className:i.a.string};var m=p.a.bind(l.a),v=function(e){function t(n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n));return r.handleClick=function(){r.setState(function(e){return{activeColor:e.colorList[e.index%4],index:e.index+1}})},r.state={index:0,activeColor:n.stateColor,colorList:"transparent"===n.rgbaColor?Array(4).fill("transparent"):g(n.rgbaColor)||[]},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillReceiveProps=function(e){var t=e.stateColor;this.setState(function(e){return{activeColor:t}})},t.prototype.render=function(){var e=this.state.activeColor,t=this.props,n=t.title,r=t.rgbaColor,o=m("panel","panel-bottom-8");return a.a.createElement("div",{className:o,"data-value":n},a.a.createElement("div",{className:"panel-item panel-item-color item-flex-1"},a.a.createElement(c.d,{className:"panel-item-value textEllipsis",content:{click:I18N.preview_panel.copied},"data-type":"copy",arrowed:!1,"data-clipboard-text":e},e),a.a.createElement("div",{className:"panel-item-color-block",style:{backgroundColor:r},onClick:this.handleClick})))},t}(r.PureComponent),g=function(e){if(e)return[Object(d.b)(e,"rgba"),Object(d.b)(e,"rgb"),Object(d.b)(e,"argb"),Object(d.b)(e,"hex")]};v.propTypes={rgbaColor:i.a.string.isRequired,stateColor:i.a.string,title:i.a.string};var y=n("qOCw"),b=function(e){var t=e.textStyles,n=void 0===t?[]:t,r=e.hiddSpacing,o=e.ratio,i=e.alignment,c=e.vertical_alignment,s=e.lineHeight,l=e.letterSpacing,u=e.unit,p=e.text,f=(e.o,e.colorUnit),m=e.fontStyle;e.padding;return a.a.createElement(ue,null,I18N.preview_panel.font,(n.length>0&&n.slice(0,1)).map(function(e,t){var n=e.color,r=e.font_size,i=(e.length,e.location),c=e.font_face,s=Object(d.e)(n),l=Object(d.b)(s,"rgba"),p=Object(y.a)(r,o,u),g=Object(d.b)(s,f);return a.a.createElement("div",{key:""+r+i+t},c&&a.a.createElement(h,{title:I18N.preview_panel.type_face,data:[c]}),m&&a.a.createElement(h,{title:I18N.preview_panel.font_style,data:[m]}),l&&a.a.createElement(v,{stateColor:g,title:I18N.preview_panel.color,rgbaColor:l}),p&&a.a.createElement(h,{title:I18N.preview_panel.font_size,data:[p]}))}),i&&a.a.createElement(h,{title:I18N.preview_panel.align,data:[i,c||"auto"],dataValue:[I18N.preview_panel.horizontal_align,I18N.preview_panel.vertical_align]}),s&&a.a.createElement(h,{title:I18N.preview_panel.graph,data:[s,l||"auto"],dataValue:[I18N.preview_panel.line_height,I18N.preview_panel.letter_spacing],first:r}),p&&a.a.createElement(h,{text:p,title:I18N.preview_panel.content}))};b.propTypes={textStyles:i.a.array,fontStyle:i.a.string,alignment:i.a.string,vertical_alignment:i.a.string,hiddSpacing:i.a.bool,letterSpacing:i.a.oneOfType([i.a.string,i.a.bool]),lineHeight:i.a.oneOfType([i.a.string,i.a.bool]),ratio:i.a.number,unit:i.a.string,text:i.a.string,o:i.a.number,padding:i.a.number,colorUnit:i.a.string};var w=function(e){var t=e.adapterLeft,n=e.adapterTop,r=e.adapterWidth,o=e.adapterHeight,i=e.opacity,c=e.radius,s=e.rotate;return a.a.createElement(ue,null,I18N.preview_panel.basic_attribute,t&&a.a.createElement(h,{title:I18N.preview_panel.position,dataValue:[I18N.preview_panel._x,I18N.preview_panel._y],data:[t,n]}),r&&a.a.createElement(h,{title:I18N.preview_panel.size,dataValue:[I18N.preview_panel.width,I18N.preview_panel.height],data:[r,o]}),s&&a.a.createElement(h,{title:I18N.preview_panel.rotation,data:[s]}),c&&a.a.createElement(h,{title:I18N.preview_panel.border_radius,data:[c]}),i&&a.a.createElement(h,{title:I18N.preview_panel.opacity,data:[i]}))};w.propTypes={adapterLeft:i.a.string,adapterHeight:i.a.string,adapterTop:i.a.string,adapterWidth:i.a.string,opacity:i.a.oneOfType([i.a.string,i.a.bool]),rotate:i.a.oneOfType([i.a.string,i.a.bool]),radius:i.a.oneOfType([i.a.string,i.a.number])};n("XO3k");var C=n("Lluz"),E=n("/MKj"),S=n("Q+Vi"),O=n("i6OX"),_=n("/5+U");function j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function T(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var k=p.a.bind(l.a),M=function(){return a.a.createElement("div",null,"Error in GlobalAttributes")},N=function(e){function t(){var n,r;j(this,t);for(var a=arguments.length,o=Array(a),i=0;i<a;i++)o[i]=arguments[i];return n=r=x(this,e.call.apply(e,[this].concat(o))),r.handleDelColor=function(e){var t=Object(_.d)(Object(d.b)(e,"rgba"));r.props.dispatch({type:"reducer:preview-toolbar:update",payload:{userPickColor:t}}),MB.event("删除了自选颜色","运行页")},r.handleClick=function(e){var t=e.target.dataset.clickReason;t&&MB.event("复制"+t,"运行页")},x(r,n)}return T(t,e),t.prototype.componentDidCatch=function(e,t){return console.log(e,t),a.a.createElement(M,null)},t.prototype.render=function(){var e=this.props,t=e.adapterWidth,n=e.adapterHeight,r=e.screenColor,o=void 0===r?[]:r,i=e.documentColor,c=void 0===i?[]:i,s=e.globalText,l=void 0===s?[]:s,u=e.globalColor,p=void 0===u?[]:u,d=e.userPickColor,f=void 0===d?[]:d,m=e.colorUnit,v=c.concat(p);return a.a.createElement("div",{className:k("global-attributes"),onClick:this.handleClick},a.a.createElement("div",{className:k("container","global-layer")},a.a.createElement(h,{title:I18N.preview_panel.size,dataValue:[I18N.preview_panel.width,I18N.preview_panel.height],data:[t,n]})),a.a.createElement(ue,null,I18N.preview_panel.color_title,a.a.createElement(L,{title:I18N.preview_panel.pick_color,handleDelColor:this.handleDelColor,colorBlockMap:f,colorUnit:m,canDel:!0}),a.a.createElement(I,{title:I18N.preview_panel.screen_color,handleDelColor:this.handleDelColor,colorBlockMap:o,colorUnit:m}),a.a.createElement(I,{title:I18N.preview_panel.sketch_color,handleDelColor:this.handleDelColor,colorBlockMap:v,colorUnit:m,fromSketch:!0})),l.length>0&&a.a.createElement(ue,null,I18N.preview_panel.font_title,a.a.createElement(R,{globalText:l})))},t}(r.PureComponent);N.propTypes={adapterWidth:i.a.string.isRequired,adapterHeight:i.a.string.isRequired,colorUnit:i.a.string.isRequired,screenColor:i.a.array,userPickColor:i.a.array,documentColor:i.a.array,globalText:i.a.array,globalColor:i.a.array,dispatch:i.a.func};var R=function(e){return e.globalText.map(function(e){return a.a.createElement(h,{key:e,className:"global-font",data:[e]})})};R.propTypes={globalText:i.a.array};var I=function(e){var t=e.title,n=e.colorBlockMap,r=e.fromSketch,o=e.handleDelColor,i=e.canDel,c=e.colorUnit,s=e.focusColor;return a.a.createElement("div",null,a.a.createElement("span",{className:"second-title"},t),a.a.createElement("div",{className:"panel-row"},n.length?n.map(function(e,n){var l=P(r,e,"rgba"),u=Object(d.b)(l,c);return a.a.createElement(A,{key:""+n+e,canDel:i,title:t,handleDelColor:o,color:u,rgbaColor:l,colorUnit:c,focusColor:s})}):a.a.createElement(D,null)))};I.propTypes={title:i.a.string.isRequired,colorBlockMap:i.a.array.isRequired,handleDelColor:i.a.func.isRequired,fromSketch:i.a.bool,canDel:i.a.bool,colorUnit:i.a.string,focusColor:i.a.string};var L=Object(E.connect)(function(e){var t=e.container.previewSetting;return{userPickColor:t.userPickColor,focusColor:t.focusColor}})(I),P=function(e,t,n){return Object(d.b)(e?Object(d.e)(t):t,n)},A=function(e){var t=e.color,n=e.rgbaColor,r=e.colorUnit,o=(e.index,e.handleDelColor),i=e.canDel,s=e.title,l=e.focusColor,u=t===Object(d.b)(l,r);return a.a.createElement(C.a,{inflexible:!0,position:"top",unfold:"right",arrowed:!0,shouldOpenOnHover:!0,className:k("color-dropdown",{"is-focus":u}),opener:a.a.createElement(c.d,{arrowed:!1,"data-type":"copy","data-click-reason":s,"data-clipboard-text":t,className:"row-item color-block",style:{background:n},duration:1e3,content:{click:I18N.preview_panel.copied}}),menu:a.a.createElement(B,{color:t,rgbaColor:n,canDel:i,handleDelColor:o}),menuClassName:Object(S.g)(["palette-dropdown-menu",r])})};A.propTypes={color:i.a.string.isRequired,title:i.a.string,handleDelColor:i.a.func,index:i.a.number,colorUnit:i.a.string,rgbaColor:i.a.string,canDel:i.a.bool,focusColor:i.a.string};var D=function(){return a.a.createElement("div",{className:"forbid-color"},a.a.createElement("div",{className:"transparent"}))},B=function(e){function t(){var n,r;j(this,t);for(var a=arguments.length,o=Array(a),i=0;i<a;i++)o[i]=arguments[i];return n=r=x(this,e.call.apply(e,[this].concat(o))),r.handleClick=function(e){var t=r.props,n=t.rgbaColor;(0,t.handleDelColor)(n)},x(r,n)}return T(t,e),t.prototype.render=function(){var e=this.props,t=e.color,n=e.canDel;return a.a.createElement("div",null,a.a.createElement("span",null,t),n&&a.a.createElement(O.b,{type:"dora",name:"trash",className:"trash",onClick:this.handleClick}))},t}(r.PureComponent);function U(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}B.propTypes={color:i.a.string.isRequired,rgbaColor:i.a.string,handleDelColor:i.a.func.isRequired,canDel:i.a.bool};var F=function(e){function t(){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=Array(o),c=0;c<o;c++)i[c]=arguments[c];return n=r=U(this,e.call.apply(e,[this].concat(i))),r.renderCode=function(e){return{px:r.renderCss,dp:r.renderAndroidCode,pt:r.renderIos}[Object(y.f)(e)]()},r.renderIos=function(){var e=r.props,t=e.code,n=e.language,o=e.text;return a.a.createElement(W,{code:t,language:n,text:o})},r.renderCss=function(){var e=r.props,t=e.code,n=e.language;return a.a.createElement(q,{language:n,code:t})},r.renderAndroidCode=function(){var e=r.props,t=e.whichAndView,n=e.code,o=e.text;return a.a.createElement(z,{code:n,text:o,whichAndView:t})},U(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.render=function(){var e=this.props.language;return a.a.createElement(ue,null,a.a.createElement("div",null,e.toUpperCase(),a.a.createElement(te,{text:"#code-content"})),a.a.createElement("div",{className:"code-content",id:"code-content"},this.renderCode(e)))},t}(r.PureComponent);F.propTypes={code:i.a.object,whichAndView:i.a.string,language:i.a.string,text:i.a.string};var q=function(e){var t=e.language,n=e.code,r=H(t),o=V(t),i=K(n);return Object.entries(i).map(function(e){var t=e[0],n=e[1];return a.a.createElement("div",{key:t},""+t+o+n+r)})};q.propTypes={code:i.a.object.isRequired,language:i.a.string};var W=function(e){var t=e.code,n=e.text;return G({code:t,text:n}).map(function(e){return a.a.createElement("div",{key:e},e)})};W.propTypes={code:i.a.object.isRequired,text:i.a.string};var z=function(e){var t=e.code,n=e.text,r=e.whichAndView;return a.a.createElement("div",null,a.a.createElement("div",{className:"highlight-row"},"<"+r),Object.entries(t).map(function(e){var t=e[0],n=e[1];return a.a.createElement("div",{key:t},"android:"+t+'="'+n+'"')}),n.length>0&&a.a.createElement("div",null,'android:text="'+n+'"'),a.a.createElement("div",{className:"highlight-row"},"/>"))};z.propTypes={code:i.a.object.isRequired,text:i.a.string,whichAndView:i.a.string};var H=function(e){switch(e){case"stylus":case"sass":return"";default:return";"}},V=function(e){switch(e){case"stylus":return" ";default:return": "}},G=function(e){var t=e.code,n=e.text,r=t.width,a=t.height,o=t.x,i=t.y,c=t.fontFamily,s=t.cornerRadius,l=t.fontSize,u=t.opacity,p=t.borderWidth,d=t.borderColor,f=t.alignment,h=t.backgroundColor,m=n?"textLayer":"layer",v=n?"UILabel":"UIView",g=[];return g.push("let "+m+" = "+v+"(frame: CGRect(x: "+o+", y:"+i+", width: "+r+", height: "+a+"))"),h&&g.push(m+".backgroundColor = "+h),u&&g.push(m+".alpha = "+u),s&&g.push("layer.layer.cornerRadius = "+s),p&&g.push("layer.layer.borderWidth = "+p),d&&g.push("layer.layer.borderColor = "+d+".cgColor"),n&&(g.push('let textContent = "'+n+'"'),g.push('let textString = NSMutableAttributedString(string: textContent, attributes: [\n      NSAttributedStringKey.font: UIFont(name: "'+c+'", size: '+l+")!\n      ])"),g.push("let textRange = NSRange(location:0, length: textString.length)"),g.push("let paragraphStyle = NSMutableParagraphStyle()"),g.push("paragraphStyle.alignment = ."+f),g.push("textString.addAttribute(NSAttributedStringKey.paragraphStyle, value: paragraphStyle, range: textRange)"),g.push("textLayer.attributedText = textString")),g},K=function(e){if(e["border-color"]&&e["border-width"]){var t={border:e["border-width"]+" solid "+e["border-color"]};return delete e["border-color"],delete e["border-width"],Object.assign(e,t)}return e},X=n("sEfC"),Y=n.n(X);function Z(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Q=function(e){function t(){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=Array(a),i=0;i<a;i++)o[i]=arguments[i];return n=r=Z(this,e.call.apply(e,[this].concat(o))),r.imageRef=function(e){return r.$image=e},r.handleClick=function(){var e=r.props,t=e.imageSetZip,n=e.name;Object(_.f)({url:t,name:n,type:"zip"})},r.handleOnload=function(){Object(_.c)({image:r.$image,adjust:38}),r.setState({imageLoad:!0})},r.handleError=function(){console.error("image info error")},r.debounceClick=Y()(r.handleClick,500,{leading:!0}),Z(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.render=function(){var e=this.props,t=e.imageSet,n=e.name,r=t[0].src,o={background:"url("+J+") left top",backgroundSize:"cover"};return a.a.createElement(ue,null,a.a.createElement("div",{className:"slice-title"},I18N.preview_panel.export,a.a.createElement("span",{onClick:this.debounceClick},I18N.preview_panel.download_single)),a.a.createElement("div",{className:"slice-panel"},a.a.createElement("div",{className:"slice-item-wrap",style:o},a.a.createElement("img",{src:r,alt:n,ref:this.imageRef,onLoad:this.handleOnload,onError:this.handleError})),a.a.createElement("p",{className:"slice-item-name"},n)))},t}(r.PureComponent);Q.propTypes={imageSetZip:i.a.string,imageSet:i.a.array,name:i.a.string};var J="/images/preview/slice-bg.png",$=n("sxGJ"),ee=n.n($);var te=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return n.onClipboardEvent=n.onClipboardEvent.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props,n=t.target,r=t.text;this.clipboard=r?new ee.a(this.$copyBtn,{text:function(){return Object(_.p)(document.querySelector(r).innerText)}}):new ee.a(this.$copyBtn,{target:function(){return document.querySelector(n)}}),this.clipboard.on("success",function(t){e.error=!1,window.getSelection().removeAllRanges(),e.onClipboardEvent()}),this.clipboard.on("error",function(t){e.error=!0,e.onClipboardEvent()})},t.prototype.componentWillUnmount=function(){this.clipboard.destroy()},t.prototype.onClipboardEvent=function(){MB.event("使用了代码复制","运行页")},t.prototype.render=function(){var e=this;return a.a.createElement(c.d,{arrowed:!1,content:{click:I18N.preview_panel.copied},duration:1e3,className:l.a.copyBtn},a.a.createElement("span",{ref:function(t){return e.$copyBtn=t}},I18N.copy))},t}(r.Component);te.propTypes={target:i.a.string,text:i.a.string};var ne=p.a.bind(l.a),re=function(e){var t=e.value;return a.a.createElement("div",{className:ne("container")+" "+ne("layer-name")},a.a.createElement(h,{title:I18N.preview_panel.layer_name,data:[t]}))};re.propTypes={value:i.a.string};var ae=function(e){var t=e.colorUnit,n=e.backgroundColorSort;return a.a.createElement(ue,null,I18N.preview_panel.fills,n.map(function(e,n){var r=e.value,o=e.type,i=void 0===o?"color":o,c=e.opacity,s=e.gradient,l=Object(d.c)(r),u=l&&Object(d.b)(l,t);return"color"===i?a.a.createElement(v,{stateColor:u,rgbaColor:l,title:I18N.preview_panel.color,key:n}):a.a.createElement(oe,{gradient:s,colorUnit:t,opacity:c,key:n})}))};ae.propTypes={backgroundColorSort:i.a.array,colorUnit:i.a.string};var oe=function(e){var t=e.gradient,n=t.color_stops,r=void 0===n?[]:n,o=(t.from,t.to,t.type),i=e.opacity,c=e.colorUnit;return a.a.createElement("div",null,r.length>0&&r.map(function(e,t){var n=e.color;e.position;return a.a.createElement("div",{key:""+n+t},a.a.createElement(h,{colorUnit:c,color:Object(d.c)(n),title:0==t?I18N.preview_panel.gradient:""}))}),i&&a.a.createElement(h,{title:I18N.preview_panel.opacity,data:[100*i+"%"]}),o&&a.a.createElement(h,{data:[o],title:I18N.preview_panel.type}))};oe.propTypes={gradient:i.a.object.isRequired,opacity:i.a.number,colorUnit:i.a.string.isRequired};var ie=function(e){var t=e.shadows,n=void 0===t?[]:t,r=e.isInnerShaow,o=void 0!==r&&r,i=e.unit,c=e.ratio,s=e.colorUnit,l=e.textShadows,u=void 0===l?[]:l;return a.a.createElement(ue,null,o?I18N.preview_panel.inner_shadow:I18N.preview_panel.shadow,n.length>0&&a.a.createElement(ce,{shadows:n,unit:i,ratio:c,colorUnit:s}),u.length>0&&a.a.createElement(ce,{shadows:u,unit:i,ratio:c,colorUnit:s}))};ie.propTypes={shadows:i.a.array,textShadows:i.a.array,isInnerShaow:i.a.bool,unit:i.a.string.isRequired,ratio:i.a.number.isRequired,colorUnit:i.a.string.isRequired};var ce=function(e){var t=e.shadows,n=e.unit,r=e.ratio,o=e.colorUnit;return t.map(function(e,t){var i=e.color,c=e.offset_x,s=void 0===c?0:c,l=e.offset_y,u=void 0===l?0:l,p=e.blur_radius,f=void 0===p?0:p,m=e.spread,v=void 0===m?0:m,g=Object(y.a)(s,r,n),b=Object(y.a)(u,r,n),w=Object(y.a)(f,r,n),C=Object(y.a)(v,r,n);return a.a.createElement("div",{className:"shadow-item-gap",key:t},i&&a.a.createElement(h,{title:I18N.preview_panel.color,color:Object(d.c)(i),colorUnit:o}),a.a.createElement(h,{data:[g,b,w,C],dataValue:[I18N.preview_panel._x,I18N.preview_panel._y,I18N.preview_panel.blur,I18N.preview_panel.spread]}))})};ce.propTypes={shadows:i.a.array,unit:i.a.string,ratio:i.a.number,colorUnit:i.a.string};var se=function(e){var t=e.colorUnit,n=e.borderSort,r=e.unit,o=e.ratio;return a.a.createElement(ue,null,I18N.preview_panel.borders,n.reverse().map(function(e,n){var i=e.position,c=void 0===i?"inside":i,s=e.color,l=e.thickness,u=e.gradient,p=s&&Object(d.c)(s),f=l&&Object(y.a)(l,o,r);return[s?a.a.createElement(h,{key:""+n+p,color:p,title:I18N.preview_panel.color,colorUnit:t}):a.a.createElement(oe,{gradient:u,colorUnit:t}),c&&a.a.createElement(h,{key:""+n+c,title:I18N.preview_panel.position,data:[c]}),f&&a.a.createElement(h,{key:""+n+f,title:I18N.preview_panel.thickness,data:[f]})]}))};se.propTypes={borderSort:i.a.array.isRequired,colorUnit:i.a.string.isRequired,unit:i.a.string.isRequired,ratio:i.a.number.isRequired};var le=function(){return a.a.createElement("div",{className:ne("layer-load")},a.a.createElement("span",{className:ne("spinner")}))},ue=function(e){var t=e.children;return a.a.createElement("section",null,a.a.createElement("div",{className:ne("header")},t[0]),a.a.createElement("div",{className:ne("container")},t.slice(1)))};ue.propTypes={children:i.a.array},n.d(t,"a",function(){return h}),n.d(t,"e",function(){return v}),n.d(t,"m",function(){return b}),n.d(t,"b",function(){return w}),n.d(t,"h",function(){return N}),n.d(t,"d",function(){return F}),n.d(t,"i",function(){return Q}),n.d(t,"f",function(){return te}),n.d(t,"l",function(){return ie}),n.d(t,"g",function(){return ae}),n.d(t,"j",function(){return re}),n.d(t,"c",function(){return se}),n.d(t,"k",function(){return le}),n.d(t,"n",function(){return ue})},S8MF:function(e,t,n){"use strict";n("j21k");var r=n("bz01"),a=(n("vece"),n("9DKN")),o=n("q1tI"),i=n.n(o),c=n("17x9"),s=n.n(c),l=n("t3Un"),u=n("XkTy"),p=n("rbsZ"),d=n("6hLF"),f=n("PYuP");n("cWnZ");var h=window.MBServer,m="file:"===location.protocol?"https://"+h:"https://"+location.host,v=function(e){function t(n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a,o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n));return o.updateEmbeddedHTML=function(){var e=o.props.app;if(e.homeScreen()){var t=80+e.shell().width,n=80+e.shell().height;o.setState({embeddedHTML:'<iframe src="'+m+"/app/"+e.access_token+'/embed" width="'+t+'" height="'+n+'" allowTransparency="true" frameborder="0"></iframe>'})}else Object(l.a)("/api/v2/projects/orientations.json",{}).then(function(t){var n="portrait"===t.projects.find(function(t){return t.cid===e.cid}).orientation,r=80+(n?e.shell().width:e.shell().height),a=80+(n?e.shell().height:e.shell().width);o.setState({embeddedHTML:'<iframe src="'+m+"/app/"+e.access_token+'/embed" width="'+r+'" height="'+a+'" allowTransparency="true" frameborder="0"></iframe>'})})},o.setQRCodeRef=function(e){return o.$qrcode=e},o.refreshQRCode=function(){return $(o.$qrcode).empty().qrcode({text:o.state.sharingURL+"?via=qrcode",width:100,height:100})},o.handleSelectAll=function(e){return e.target.select()},o.generateSharingURL=function(e){return o.setState({sharingURL:MB.isOffline()&&"file:"!==location.protocol?location.toString():"file:"===location.protocol?"https://"+h+"/app/"+e:"https://"+location.host+"/app/"+e})},o.handleRefresh=(a=regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.b)({title:I18N.regenerate_url_title,desc:I18N.regenerate_url_desc});case 2:if(!e.sent){e.next=6;break}t=Math.uuid(31),o.generateSharingURL(t),o.setAttr("access_token",t);case 6:case"end":return e.stop()}},e,r)}),function(){var e=a.apply(this,arguments);return new Promise(function(t,n){return function r(a,o){try{var i=e[a](o),c=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(c).then(function(e){r("next",e)},function(e){r("throw",e)});t(c)}("next")})}),o.handleUpdateShell=function(e){var t=e.value,n=o.props.app;n.shell_type=t,n.lsave(MB.user.id===n.owner_id),$("body").trigger("queue:save"),o.forceUpdate(),MB.currentProject&&MB.runner.reload(!0)},o.handlePasswordChange=function(e){return o.setAttr("password",e)},o.handleAccess=function(e){var t=e.value;"restricted"===t&&(o.props.app.password=""),o.setAttr("access",t)},o.handleCollaborators=function(){o.setState({isCollaboratorModalOpen:!0})},o.handlePreviewSettings=function(e){var t=e.idxList,n=o.props.app,r=new Set(t);Object.assign(n,{highlight:r.has(0),wechat:r.has(1)}),o.props.app.lsave(),$("body").trigger("queue:save"),o.forceUpdate()},o.handleSlackWebHook=function(e){return o.setAttr("slack_web_hook_url",e.target.value)},o.onCloseCollaboratorModal=function(){return o.setState({isCollaboratorModalOpen:!1})},o.state={sharingURL:"",embeddedHTML:"en"===MBLocale?"generating code...":"正在生成...",isCollaboratorModalOpen:!1},o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillMount=function(){var e=this.props.app;this.generateSharingURL(e.access_token)},t.prototype.componentDidMount=function(){this.updateEmbeddedHTML(),setTimeout(this.refreshQRCode,50)},t.prototype.componentWillReceiveProps=function(e){var t=e.app,n=e.isOpen,r=this.props.isOpen;r&&!n?(this.setState({sharingURL:"",embeddedHTML:"en"===MBLocale?"generating code...":"正在生成..."}),$(this.$qrcode).empty()):!r&&n&&(this.updateEmbeddedHTML(),this.generateSharingURL(t.access_token))},t.prototype.componentDidUpdate=function(e,t){var n=e.isOpen,r=t.sharingURL,a=this.props.isOpen,o=this.state.sharingURL;(!n&&a||r!==o)&&setTimeout(this.refreshQRCode,50)},t.prototype.setAttr=function(e,t){this.props.app[e]=t,this.props.app.lsave(),$("body").trigger("queue:save"),this.forceUpdate()},t.prototype.render=function(){var e=this.props,t=e.isOpen,n=e.onClose,o=e.app,c=e.dispatch,s=this.state,l=s.sharingURL,u=s.embeddedHTML,h=s.isCollaboratorModalOpen,m=/edge.modao.cc/.test(location.href),v=o.owner_id===MB.user.id,g=v||o.canAdmin(),y=v||o.canEdit(),b=!/^\/app\//i.test(location.pathname),w=[{value:"restricted",label:i.a.createElement("span",{className:"restricted-access"},i.a.createElement("span",null,I18N.restricted_intro),"restricted"===o.access&&i.a.createElement(a.a,{type:"text",className:"manage-collaborators",onClick:this.handleCollaborators},I18N.manage))},{value:"private",label:i.a.createElement("span",null,I18N.private_intro,i.a.createElement("p",null,"private"===o.access&&(MB.user.id&&MB.user.limitation.encryptable?i.a.createElement(d.e,{placeholder:I18N.sharing_password,value:o.password||"",onChange:this.handlePasswordChange,readOnly:!g}):i.a.createElement(a.a,{type:"text",className:"renew",onClick:p.b},I18N.password_protection))))}],C=[{value:"device",label:I18N.device_shell},{value:"default",label:I18N.default_shell},{value:"none",label:I18N.none_shell}],E=[{value:"highlight",label:I18N.highlight_clickable},{value:"wechat",label:I18N.view_in_browser}],S=E.reduce(function(e,t,n){return o[t.value]&&e.push(n),e},[]),O=o.team_cid?o.cteam():o;return i.a.createElement(r.a,{isOpen:t,className:"sharing-modal",title:I18N.share,onClose:n},i.a.createElement("section",{className:"qrcode",ref:this.setQRCodeRef}),i.a.createElement("section",{className:"sharing-url"},i.a.createElement(d.e,{readOnly:!0,value:l,onClick:this.handleSelectAll}),g&&i.a.createElement(a.a,{type:"primary",onClick:this.handleRefresh},I18N.regenerate)),i.a.createElement("section",{className:"sharing-code"},i.a.createElement("p",null,I18N.embed_tips),i.a.createElement(d.j,{readOnly:!0,onClick:this.handleSelectAll,value:u})),b&&i.a.createElement("section",null,i.a.createElement(d.c,{name:I18N.access_permission},i.a.createElement(d.h,{isDisabled:!g,optionList:w,onChange:this.handleAccess,value:o.access}))),y&&"web"!==o.device&&i.a.createElement("section",null,i.a.createElement(d.d,{name:I18N.default_shell_field},i.a.createElement(d.i,{optionList:C,value:o.shell_type,onChange:this.handleUpdateShell}))),g&&i.a.createElement("section",null,i.a.createElement(d.c,{name:I18N.preview_settings},i.a.createElement(d.b,{optionList:E,onChange:this.handlePreviewSettings,currentOptionIdxList:S}))),m&&i.a.createElement(d.c,{name:"Slack Web Hook"},i.a.createElement("input",{type:"text",value:o.slack_web_hook_url||"",onBlur:this.handleSlackWebHook})),i.a.createElement(f.a,{isOpen:h,onClose:this.onCloseCollaboratorModal,dispatch:c,host:O,userRole:O.owner_id===MB.user.id?"owner":O.roleByUid(MB.user.id)}))},t}(o.PureComponent);v.propTypes={dispatch:s.a.func.isRequired,isOpen:s.a.bool,onClose:s.a.func,app:s.a.object},t.a=v},Sxd8:function(e,t){e.exports=function(e){return e}},TKrE:function(e,t){e.exports=function(e){return e}},TSYQ:function(e,t,n){var r;!function(){"use strict";var n={}.hasOwnProperty;function a(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var o=typeof r;if("string"===o||"number"===o)e.push(r);else if(Array.isArray(r))e.push(a.apply(null,r));else if("object"===o)for(var i in r)n.call(r,i)&&r[i]&&e.push(i)}}return e.join(" ")}void 0!==e&&e.exports?e.exports=a:void 0===(r=function(){return a}.apply(t,[]))||(e.exports=r)}()},UbMB:function(e,t,n){var r;!function(){"use strict";var n={}.hasOwnProperty;function a(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var o=typeof r;if("string"===o||"number"===o)e.push(this&&this[r]||r);else if(Array.isArray(r))e.push(a.apply(this,r));else if("object"===o)for(var i in r)n.call(r,i)&&r[i]&&e.push(this&&this[i]||i)}}return e.join(" ")}void 0!==e&&e.exports?e.exports=a:void 0===(r=function(){return a}.apply(t,[]))||(e.exports=r)}()},UfWW:function(e,t,n){var r=n("KwMD"),a=n("ut/Y"),o=n("Sxd8"),i=Math.max;e.exports=function(e,t,n){var c=null==e?0:e.length;if(!c)return-1;var s=null==n?0:o(n);return s<0&&(s=i(c+s,0)),r(e,a(t,3),s)}},WVP6:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.createReduxEntry=function(){var e=null,t={},n=function(e,n){if("string"!=typeof e)throw new Error("[ReduxEntry][setEntry] non-string actionType: "+e);if("function"!=typeof n)throw new Error("[ReduxEntry][setEntry] non-function entryFunction: "+e+", "+n);t[e]&&console.warn("[ReduxEntry][setEntry] possible unexpected entry overwrite: "+e),t[e]=n};return{middleware:function(n){if("function"!=typeof n.getState||"function"!=typeof n.dispatch)throw new Error("[ReduxEntry][middleware] invalid reduxMiddlewareStore");if(null!==e)throw new Error("[ReduxEntry][middleware] already set reduxMiddlewareStore");return e=n,function(n){return function(r){return!0===function(n){var r=t[n.type];return r&&r(e,n)}(r)||n(r)}}},setEntry:n,setEntryMap:function(e){return Object.keys(e).forEach(function(t){return n(t,e[t])})}}},t.createStateStore=function(e){if(void 0===e)throw new Error("[ReduxEntry][createStateStore] initialState expected");return{getState:function(){return e},setState:function(t){return e=t},wrapEntry:function(t){return function(n,r){return t(e,n,r)}}}},t.createStateStoreReducer=function(e,t){var n=t.getState,r=t.setState;return function(t,a){var o=a.type,i=a.payload;return o===e&&r(i),n()}},t.createStateStoreMergeReducer=function(e,t){var n=t.getState,a=t.setState;return function(t,o){var i=o.type,c=o.payload;return i===e&&a(r({},n(),c)),n()}}},WcC0:function(e,t){},XKAG:function(e,t,n){var r=n("ut/Y"),a=n("MMmD"),o=n("7GkX");e.exports=function(e){return function(t,n,i){var c=Object(t);if(!a(t)){var s=r(n,3);t=o(t),n=function(e){return s(c[e],e,c)}}var l=e(t,n,i);return l>-1?c[s?t[l]:l]:void 0}}},XO3k:function(e,t,n){"use strict";n("Xgir")},XQpQ:function(e,t,n){"use strict";var r=n("q1tI"),a=n.n(r),o=n("wd/R"),i=n.n(o),c=n("bz01"),s=n("9DKN"),l=n("6hLF"),u='<svg viewBox="0 0 64 64"><g fill="none" fill-rule="evenodd"><circle stroke-opacity=".854" stroke="#8D9EA7" cx="32" cy="32" r="31.5"/><path d="M32 28.23l12.67-12.67c.292-.293.767-.293 1.06 0l2.71 2.71c.293.293.293.768 0 1.06L35.77 32l12.67 12.67c.293.292.293.767 0 1.06l-2.71 2.71c-.293.293-.768.293-1.06 0L32 35.77 19.33 48.44c-.292.293-.767.293-1.06 0l-2.71-2.71c-.293-.293-.293-.768 0-1.06L28.23 32 15.56 19.33c-.293-.292-.293-.767 0-1.06l2.71-2.71c.293-.293.768-.293 1.06 0L32 28.23z" fill="#415058"/></g></svg>',p=n("i6OX"),d=n("RUem"),f=n("7Qib"),h=n("zAG7"),m=["zh-CN","en"],v={gift:["最高领取价值<em>{price} 元 VIP 会员</em>","Get<br>VIP membership <em>up to {price}</em>"],joinNow:["立即参与","Join Now"],signupNow:["立即注册","Sign up"],signup:["注册","Sign up"],signupForMockingBot:["注册墨刀帐户","Sign up for MockingBot"],name:["姓名","Name"],email:["Email 地址","Email"],pwd:["密码","Password"],emailTaken:["Email 已被使用","The email has been taken already!"],agreeToTOS:['点击「立即注册」按钮将视为您<br />同意墨刀<a href="/tos" target="_blank">使用条款</a>','By clicking ‘Sign up’, <br>you are agreeing to MockingBot’s <a href="/tos" target="_blank">Terms of Service</a>.'],alreadyAUser:["已有墨刀帐戶，查看活动详情","Already a user? Join the event now!"],youveWon:["您已获得","You’ve won the "],newbieAward:["尝鲜奖","Newbie Award"],stormAward:["神器奖","Storm Award"],checkAccountForAward:['可在「<a href="/account" target="_blank">我的帐户</a>」中查看','Check the award in your “<a href="/account" target="_blank">Account</a>”'],eventURL:["活动链接","Event URL"],checkStormAward:["去了解神器奖","Check out Storm Award"],shareWithFriends:["分享活动给好友","Share with Friends"]},g=["CN","US","IN"],y={currencySymbol:["¥","$","$"],sketchPluginEvent201801Value:["78","19.98","9.98"],sketchPluginEvent201801URL:["https://modao.cc/event/2018/01/sketch-plugin","https://mockingbot.com/event/2018/01/sketch-plugin","https://mockingbot.in/event/2018/01/sketch-plugin"]};n("hcHk");n.d(t,"b",function(){return U}),n.d(t,"d",function(){return F}),n.d(t,"a",function(){return q}),n.d(t,"c",function(){return W});var b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function E(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var S=window.MB,O=(S=void 0===S?{}:S).localStorageDelegate,_=void 0===O?localStorage:O,j=document.documentElement,x=(window.MB||j.dataset).serverCountry,T=void 0===x?"CN":x,k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"CN";return y.currencySymbol[g.indexOf(e)]}(T),M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en";return function(t){return v[t][m.indexOf(e)]}}("en"===j.lang?"en":"zh-CN"),N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"CN";return function(t){return y[t][g.indexOf(e)]}}(T),R="sketch_plugin_event_2018_01_holy_grail",I="sketch_plugin_event_2018_01_gift_closed",L=new Set(JSON.parse(_.getItem(R)||"[]")),P="CN"===T&&i()().isBefore("2018-02-10","day")||"CN"!==T&&i()().isAfter("2018-02-13","hour"),A=new URLSearchParams(location.search),D=A.has("inspect"),B=/^2\.3\.\d+/.test(A.get("sketch_plugin_version")),U=function(e){function t(n){w(this,t);var r=C(this,e.call(this,n));r.onSignUp=function(){return r.setState({hasSignedUp:!0})},r.onCloseEventGift=function(){return r.setState({isEventGiftClosedByUser:!0},function(){return!r.props.isDemo&&_.setItem(I,!0)})},r.onOpenTrialAward=function(){return r.setState({shouldShowTrialAward:!0})},r.onCloseAward=function(){return r.setState({shouldShowTrialAward:!1,shouldShowHolyGrailAward:!1})};var a=MB.user&&MB.user.email,o=L.has(a),i=!!a&&!o&&D&&B;return i&&_.setItem(R,JSON.stringify(L.add(a))),r.state={isFormDataWrong:!1,hasSignedUp:!1,shouldShowHolyGrailAward:i,shouldShowTrialAward:!1,isEventGiftClosedByUser:!n.isDemo&&!!_.getItem(I)},r}return E(t,e),t.prototype.render=function(){var e=this.props.isLoggedIn,t=this.state,n=t.isEventGiftClosedByUser,r=t.hasSignedUp,o=t.shouldShowTrialAward,i=t.shouldShowHolyGrailAward,c=P&&!n;return a.a.createElement("div",null,c&&a.a.createElement("div",{className:"event-gift"},a.a.createElement("button",{className:"close",onClick:this.onCloseEventGift,dangerouslySetInnerHTML:{__html:u}}),a.a.createElement("span",{className:"desc",dangerouslySetInnerHTML:{__html:M("gift").replace(/\{price\}/g,""+k+N("sketchPluginEvent201801Value"))}}),e||r?a.a.createElement("a",{className:"start",href:"/event/2018/01/sketch-plugin",target:"_blank"},M("joinNow")):a.a.createElement(F,{onOpenTrialAward:this.onOpenTrialAward,onSignUp:this.onSignUp})),a.a.createElement(q,{isOpen:o||i,type:o?"trial":i?"holy-grail":null,onClose:this.onCloseAward}))},t}(r.PureComponent),F=function(e){function t(n){w(this,t);var r=C(this,e.call(this,n));return r.createOnFormDataChange=function(e){return function(t){var n;return r.setState({formData:b({},r.state.formData,(n={},n[e]=t,n))})}},r.onChangeEmail=function(e){return r.setState({formData:b({},r.state.formData,{email:e})})},r.onSubmitSignUp=function(){var e=r.state.formData,t=e.name,n=e.email,a=e.pwd;r.setState({isFormDataWrong:!1}),Object(f.e)("/events/sketch_plugin_sign_up.json",JSON.stringify({username:t,email:n,password:a,locale:"zh-CN"})).then(function(){return Object(f.e)("/sessions.json",JSON.stringify({email:n,password:a})).then(function(){var e=r.props,t=e.onOpenTrialAward,n=e.onSignUp;if(!P)return location.assign("/workspace/apps");$(".sign-up-modal .close-btn").click(),t(),n()})}).catch(function(){return r.setState({isFormDataWrong:!0})})},r.state={formData:{name:"",email:"",pwd:""},isFormDataWrong:!1},r}return E(t,e),t.prototype.render=function(){var e=this.state,t=e.formData,n=t.name,r=t.email,o=t.pwd,i=e.isFormDataWrong,u=!!n&&h.a.test(r)&&!!o;return a.a.createElement(c.a,{openerType:"custom",opener:a.a.createElement("button",{className:"start"},M("signupNow")),className:"sign-up-modal",title:M("signupForMockingBot")},a.a.createElement("div",{className:"input-entry"},a.a.createElement(p.b,{type:"mb",name:"user"}),a.a.createElement(l.e,{placeholder:M("name"),defaultValue:n,onChange:this.createOnFormDataChange("name")})),a.a.createElement("div",{className:"input-entry"},a.a.createElement(p.b,{type:"mb",name:"mail"}),a.a.createElement(l.f,{placeholder:M("email"),defaultValue:r,onChange:this.onChangeEmail})),a.a.createElement("div",{className:"input-entry"},a.a.createElement(p.b,{type:"mb",name:"lock"}),a.a.createElement(l.e,{placeholder:M("pwd"),type:"password",defaultValue:o,onChange:this.createOnFormDataChange("pwd")})),a.a.createElement(s.a,{type:"primary",isDisabled:!u,onClick:this.onSubmitSignUp},M("signup")),i?a.a.createElement("p",{className:"error-msg"},M("emailTaken")):a.a.createElement("p",{dangerouslySetInnerHTML:{__html:M("agreeToTOS")}}),a.a.createElement("a",{className:"RegularButton",target:"_blank",href:"/event/2018/01/sketch-plugin"},M("alreadyAUser")))},t}(r.PureComponent),q=function(e){function t(n){w(this,t);var r=C(this,e.call(this,n));return r.onShare=function(){return r.setState({isSharing:!0})},r.onClose=function(){var e=r.props,t=e.type,n=e.onClose;return"trial"===t?location.reload(!0):n()},r.state={isSharing:!1},r}return E(t,e),t.prototype.render=function(){var e=this.props,t=e.isOpen,n=e.onClose,r=e.type,o=this.state.isSharing;return P&&a.a.createElement(c.a,{isOpen:t,className:"award-modal "+r+" "+(o?"is-sharing":""),onClose:n},a.a.createElement("button",{className:"close-btn",dangerouslySetInnerHTML:{__html:u},onClick:this.onClose}),a.a.createElement("div",{className:"award"}),a.a.createElement("div",{className:"awarding"},a.a.createElement("h2",null,M("youveWon"),M("trial"===r?"newbieAward":"stormAward")),a.a.createElement("p",{dangerouslySetInnerHTML:{__html:M("checkAccountForAward")}})),a.a.createElement("div",{className:"sharing"},a.a.createElement("div",{className:"qrcode"}),a.a.createElement(d.f,{text:"#event-url"},M("eventURL")),a.a.createElement("span",{hidden:!0,id:"event-url"},N("sketchPluginEvent201801URL"))),a.a.createElement("footer",null,"trial"===r&&a.a.createElement("a",{className:"go-to-event-page",target:"_blank",href:"/event/2018/01/sketch-plugin#holy-grail-award",onClick:this.onClose},M("checkStormAward")),a.a.createElement("button",{className:"share",onClick:this.onShare},M("shareWithFriends"))))},t}(r.PureComponent),W=function(e){function t(){return w(this,t),C(this,e.apply(this,arguments))}return E(t,e),t.prototype.render=function(){return P&&a.a.createElement("a",{className:"SantaBot",target:"_blank",href:"/event/2018/01/sketch-plugin"})},t}(r.PureComponent)},Xgir:function(e,t){},XkTy:function(e,t,n){"use strict";function r(e){var t=e.dispatch,n=void 0===t?MB.webpackInterface.store.dispatch:t,r=e.type,a=void 0===r?"alert":r,o=e.title,i=e.desc,c=e.isHTML,s=e.confirmText,l=e.cancelText;return new Promise(function(e){return n({type:"container:modal:open",payload:{type:a,title:o,desc:i,isHTML:c,alertType:"confirm",canCancel:!0,canConfirm:!0,cancelText:l,confirmText:s,onCancel:function(){return e(!1)},onConfirm:function(){return e(!0)}}})})}function a(e){var t=e.dispatch,n=void 0===t?MB.webpackInterface.store.dispatch:t,r=e.type,a=void 0===r?"alert":r,o=e.title,i=e.desc,c=e.isHTML,s=e.confirmText;return new Promise(function(e){return n({type:"container:modal:open",payload:{type:a,title:o,desc:i,isHTML:c,alertType:"alert",canCancel:!1,canConfirm:!0,confirmText:s,onConfirm:function(){return e(!0)}}})})}function o(e){var t=e.dispatch,n=void 0===t?MB.webpackInterface.store.dispatch:t,r=e.type,a=void 0===r?"form":r,o=e.title,i=e.desc,c=e.isHTML,s=e.confirmText;return new Promise(function(e,t){return n({type:"container:modal:open",payload:{type:a,title:o,desc:i,isHTML:c,alertType:"prompt",canCancel:!1,canConfirm:!0,confirmText:s,canClose:!1,onConfirm:function(){var n=(document.querySelector(".global-alert-portal .prompt-pwd input")||{}).value;return n?e(n):t()},onCancel:t}})})}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"c",function(){return o}),Object.assign(MB,{confirm:r,alert:a,prompt:o})},XpKX:function(e,t){e.exports={"adjust-container":"_2767PBbPLOHyCg-9kbwJq7","is-offline-mode":"_2Rn4b7GJxlQ8HllhNCcowW"}},XrEr:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",function(){return getNormalRgbaColor}),__webpack_require__.d(__webpack_exports__,"e",function(){return parseSketchColor2rgba}),__webpack_require__.d(__webpack_exports__,"b",function(){return getColorFromUnit}),__webpack_require__.d(__webpack_exports__,"d",function(){return getUIColor}),__webpack_require__.d(__webpack_exports__,"a",function(){return DEFAULT_COLOR});var lodash_round__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("tpxX"),lodash_round__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash_round__WEBPACK_IMPORTED_MODULE_0__),_utils___WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("/5+U"),rgba2hexWithA=function(e){if(checkColorUnit(e)!==RGBA)return console.warn("Not rgbacolor but use rgba2hexWithA"),e;var t=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+(\.\d+)?)[\s+]?/i);return t&&t.length>=4?{hex:("#"+("0"+parseInt(t[1],10).toString(16)).slice(-2)+("0"+parseInt(t[2],10).toString(16)).slice(-2)+("0"+parseInt(t[3],10).toString(16)).slice(-2)).toUpperCase(),o:Number((+t[4]).toFixed(2))}:e},getNormalRgbaColor=function(e){if(!e)return DEFAULT_COLOR;var t=parseSketchColor2rgba(e);return t?getColorFromUnit(t,RGBA):e},parseSketchColor2rgba=function parseSketchColor2rgba(rgbaFuncStr){var colorType=checkColorUnit(rgbaFuncStr);if(colorType!==RGBA)return getColorFromUnit(rgbaFuncStr,RGBA);function rgba(){var e=arguments[0],t=arguments[1],n=arguments[2],r=arguments[3];return e<=1&&t<=1&&n<=1?{r:parseInt(lodash_round__WEBPACK_IMPORTED_MODULE_0___default()(255*e),10),g:parseInt(lodash_round__WEBPACK_IMPORTED_MODULE_0___default()(255*t),10),b:parseInt(lodash_round__WEBPACK_IMPORTED_MODULE_0___default()(255*n),10),a:Number(Number(r).toFixed(2))}:{r:e,g:t,b:n,a:r}}var _eval=eval(rgbaFuncStr),r=_eval.r,g=_eval.g,b=_eval.b,a=_eval.a;return"rgba("+r+", "+g+", "+b+", "+a+")"},checkColorUnit=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:DEFAULT_COLOR;return e.includes(RGBA)?RGBA:e.includes(RGB)?RGB:e.includes("#")&&9===e.length?ARGB:!!e.includes("#")&&HEX},getColorFromUnit=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:RGBA;if(!e)return DEFAULT_COLOR;var n=checkColorUnit(e);if(!n)return DEFAULT_COLOR;switch(n){case RGBA:if(t===n)return e;if(t===RGB)return rgba2rgb(e);if(t===HEX)return rgba2hex(e);if(t===ARGB)return rgba2argb(e);break;case RGB:if(t===n)return e;if(t===RGBA)return rgb2rgba(e);if(t===HEX)return rgb2hex(e);if(t===ARGB)return rgb2argb(e);break;case HEX:if(t===n)return e;if(t===RGBA)return hex2rgba(e);if(t===RGB)return hex2rgb(e);if(t===ARGB)return hex2argb(e);break;case ARGB:if(t===n)return e;if(t===RGBA)return argb2rgba(e);if(t===RGB)return argb2rgbWithA(e);if(t===HEX)return argb2hexWithA(e);break;default:return e}},rgba2rgbWithA=function(e){if(checkColorUnit(e)!==RGBA)return console.warn("Not rgbacolor but use rgba2rgbWithA"),e;var t=rgba2hexWithA(e),n=t.hex,r=t.o;return n?{rgb:hex2rgb(n),o:r}:DEFAULT_COLOR},hex2rgb=function(e){if(checkColorUnit(e)!==HEX)return console.warn("Not hexcolor but use hex2rgb"),e;if(3===(e=e.replace("#","")).length){var t=e.split(""),n=t[0],r=t[1],a=t[2];e=""+n+n+r+r+a+a}return"rgb("+parseInt(e.substring(0,2),16)+", "+parseInt(e.substring(2,4),16)+", "+parseInt(e.substring(4,6),16)+")"},rgba2rgb=function(e){var t=rgba2rgbWithA(e),n=t.rgb,r=t.o;return n?n+" "+Math.round(100*r)+"%":e},rgba2hex=function(e){var t=rgba2hexWithA(e),n=t.hex,r=t.o;return n?n.toUpperCase()+" "+Math.round(100*r)+"%":e},rgba2argb=function(e){if(checkColorUnit(e)!==RGBA)return console.warn("Not rgbacolor but use rgba2argb"),e;var t=rgba2hexWithA(e),n=t.hex,r=t.o;return n?"#"+("0"+parseInt(255*r,10).toString(16)).slice(-2).toUpperCase()+n.slice(1):e},rgb2rgba=function(e){return checkColorUnit(e)!==RGB?(console.warn("Not rgbcolor but use rgb2rgba"),e):"rgba("+e.slice(4,-1)+", 1)"},rgb2hex=function(e){if(checkColorUnit(e)!==RGB)return console.warn("Not rgbcolor but use rgb2hex"),e;var t=e.match(/^rgb?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return t&&4===t.length?("#"+("0"+parseInt(t[1],10).toString(16)).slice(-2)+("0"+parseInt(t[2],10).toString(16)).slice(-2)+("0"+parseInt(t[3],10).toString(16)).slice(-2)).toUpperCase():void 0},rgb2argb=function(e){return checkColorUnit(e)!==RGB?(console.warn("Not rgbcolor but use rgb2argb"),e):hex2argb(rgb2hex(e))},hex2argb=function(e){return checkColorUnit(e)!==HEX?(console.warn("Not hexcolor but use hex2argb"),e):"#FF"+e.slice(1)},hex2rgba=function(e){return checkColorUnit(e)!==HEX?(console.warn("Not hexcolor but use hex2rgba"),e):rgb2rgba(hex2rgb(e))},argb2rgba=function(e){if(checkColorUnit(e)!==ARGB)return console.warn("Not argbcolor but use argb2rgba"),e;for(var t=[],n=1;n<e.length;n+=2)t.push(e.slice(n,n+2));var r=t[0],a=t[1],o=t[2],i=t[3];return"rgba("+(a=parseInt(a,16))+", "+(o=parseInt(o,16))+", "+(i=parseInt(i,16))+", "+(r=Number((parseInt(r,16)/255).toString().slice(0,4)))+")"},argb2rgbWithA=function(e){if(checkColorUnit(e)!==ARGB)return console.warn("Not argbcolor but use argb2rgbWithA"),e;var t=argb2rgba(e),n=rgba2rgbWithA(t),r=n.rgb,a=n.o;return r?r+" "+Math.round(100*a)+"%":e},argb2hexWithA=function(e){if(checkColorUnit(e)!==ARGB)return console.warn("Not argbcolor but use argb2hexWithA"),e;var t=argb2rgba(e),n=rgba2hexWithA(t),r=n.hex,a=n.o;return r?r.toUpperCase()+" "+Math.round(100*a)+"%":e},getUIColor=function getUIColor(color){if(!color)return DEFAULT_COLOR;var rgbaColor=getColorFromUnit(color,"rgba");function rgba(){return{r:arguments[0],g:arguments[1],b:arguments[2],a:arguments[3]}}var _eval2=eval(rgbaColor),r=_eval2.r,g=_eval2.g,b=_eval2.b,a=_eval2.a;return r=Object(_utils___WEBPACK_IMPORTED_MODULE_1__.m)(r/255),g=Object(_utils___WEBPACK_IMPORTED_MODULE_1__.m)(g/255),b=Object(_utils___WEBPACK_IMPORTED_MODULE_1__.m)(b/255),"UIColor(red:"+r+", green:"+g+", blue:"+b+", alpha:"+a+")"},RGBA="rgba",ARGB="argb",RGB="rgb",HEX="hex",DEFAULT_COLOR="#FFFFFF"},"Xt/L":function(e,t){e.exports=function(e,t,n){for(var r=-1,a=null==e?0:e.length;++r<a;)if(n(t,e[r]))return!0;return!1}},"Y+p1":function(e,t,n){var r=n("wF/u");e.exports=function(e,t){return r(e,t)}},ZCpW:function(e,t,n){var r=n("lm/5"),a=n("O7RO"),o=n("IOzZ");e.exports=function(e){var t=a(e);return 1==t.length&&t[0][2]?o(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},ZWtO:function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},a1Ia:function(e,t){e.exports={"sub-toolbar":"_1_GW4ZPKsACMqmFUgNIiea","select-input":"_1z2tl9KzoQhfo9Vd0AnQNl"}},aGLX:function(e,t){e.exports={imageList:"_3ficRHuvBnw8OpmrNQhWx2","image-item":"bAb8vOu-aZtn1Y-6uUVYK","image-wrap":"_1utFJlUiQEYi0SQneiT6Af","opacity-0":"_2HO0IDXv1rZt1QRmvrC5JB","opacity-1":"I2CG014sVtCTkxi-kF0by","comment-count":"_2c1WzxIpT8o5B2Ol-zS0Rf","image-title":"_1gio49aYGcJE3bFQogMark",active:"_38c-sH3yvaLWSfdG2i6FOf"}},aqSL:function(e,t,n){"use strict";var r=n("q1tI"),a=n.n(r),o=n("i8i4"),i=n.n(o),c=n("/MKj"),s=n("q3nj"),l=n("6x+O"),u=n("6ZRU"),p=window.$;t.a={containerReducerMap:s.b,sagaMap:s.c,extendCallback:function(e){e.setObserver("focus-method:request-focus",d),e.renderPreview=function(t){var n=e.store;n.dispatch({type:"entry:refresh:project-related"}),i.a.render(a.a.createElement(c.Provider,{store:n},a.a.createElement(s.a,null)),t)},e.renderPreviewAlert=function(){i.a.render(a.a.createElement(u.a.containers.Alert,{store:e.store}),Object(l.b)())},e.pushData=function(t,n,r){e.store.dispatch({type:"entry:state:push-data",payload:{pushType:t,action:n,data:r}})},e.checkLocationHash=function(){var t=window.location.hash||"",n=e.store,r=n.getState,a=n.dispatch;if(t.startsWith("#thread=")){var o=t.substr("#thread=".length),i=r().model.commentThreads.find(function(e){return e.cid===o});if(!i)return console.warn("[checkLocationHash] missing commentThread: "+o);a({type:"entry:sync-runner:set-screen",payload:{cid:i.screen_cid}}),a({type:"entry:comment:set:active",payload:{isActive:!0}}),a({type:"container:comment:select",payload:{select:i.cid}})}else if(t.startsWith("#screen=")){var c=t.substr("#screen=".length),s=r().model.screens.find(function(e){return e.cid===c});if(!s)return console.warn("[checkLocationHash] missing screen: "+c);a({type:"entry:sync-runner:set-screen",payload:{cid:s.cid}})}},e.updateCurrentScreenRunner=function(t){if(!t)return console.warn("[updateCurrentScreenRunner] missing currentScreen");e.store.dispatch({type:"entry:current:set-screen",payload:t}),window.location.hash="#screen="+t.cid}}};var d=function(e,t){var n=document.getElementById("simulator-container"),r=t.getBoundingClientRect(),a=n.getBoundingClientRect();if(!(r.top>a.top&&r.bottom<a.bottom)){var o=r.top+.5*r.height-(a.top+.5*a.height),i=o<0?"up":"down",c=document.getElementById("simulator-wrapper"),s=f(i,o,n,a,c.getBoundingClientRect());if(n.scrollTop+=s,0!==(o-=s)){var l=p(".pcanvas.active .widgets")[0],u=p(".pcanvas.active .widgets .scontainer")[0];s=f(i,o,l,l.getBoundingClientRect(),u.getBoundingClientRect()),l.scrollTop+=s}}},f=function(e,t,n,r,a){return"up"===e&&n.scrollTop>0?Math.max(t,0-n.scrollTop):"down"===e&&n.scrollTop<a.height-r.height?Math.min(t,a.bottom-r.bottom):0}},asDA:function(e,t){e.exports=function(e,t,n,r){var a=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++a]);++a<o;)n=t(n,e[a],a,e);return n}},bahg:function(e,t){e.exports=function(e){return e.split("")}},cAqp:function(e,t){e.exports={"comment-marker":"_2DdCe4X_4uBwFVlS753YET"}},cWnZ:function(e,t){},dAiO:function(e,t){},dQpi:function(e,t){e.exports=function(){}},dVn5:function(e,t){var n=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;e.exports=function(e){return e.match(n)||[]}},dppN:function(e,t){},dt0z:function(e,t){e.exports=function(e){return e}},dzIi:function(e,t){e.exports={"screen-node-content":"Uuhb0VzPcnrk3zgUGbW_Q"}},e5cp:function(e,t,n){var r=n("fmRc"),a=n("or5M"),o=n("HDyB"),i=n("seXi"),c=n("QqLw"),s=n("Z0cm"),l=n("DSRE"),u=n("c6wG"),p=1,d="[object Arguments]",f="[object Array]",h="[object Object]",m=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,v,g,y){var b=s(e),w=s(t),C=b?f:c(e),E=w?f:c(t),S=(C=C==d?h:C)==h,O=(E=E==d?h:E)==h,_=C==E;if(_&&l(e)){if(!l(t))return!1;b=!0,S=!1}if(_&&!S)return y||(y=new r),b||u(e)?a(e,t,n,v,g,y):o(e,t,C,n,v,g,y);if(!(n&p)){var j=S&&m.call(e,"__wrapped__"),x=O&&m.call(t,"__wrapped__");if(j||x){var T=j?e.value():e,k=x?t.value():t;return y||(y=new r),g(T,k,n,v,y)}}return!!_&&(y||(y=new r),i(e,t,n,v,g,y))}},eaeY:function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var a=n("q1tI");n("17x9");var o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"componentDidMount",value:function(){this.props.enabled&&this.bindHandlers()}},{key:"componentWillUnmount",value:function(){this.unbindHandlers()}},{key:"componentWillReceiveProps",value:function(e){this.props.enabled&&!e.enabled?this.unbindHandlers():!this.props.enabled&&e.enabled&&this.bindHandlers()}},{key:"getKeys",value:function(){this.props.target,window;return Object.keys(this.props).filter(function(e){return"on"===e.slice(0,2)}).map(function(e){return[e,e.slice(2).toLowerCase()]})}},{key:"getTarget",value:function(){var e=this.props,t="function"==typeof e.target?e.target():e.target;return t||(t=this.node&&this.node.ownerDocument),t}},{key:"bindHandlers",value:function(){this._adjustHandlers(i)}},{key:"unbindHandlers",value:function(){this._adjustHandlers(c)}},{key:"_adjustHandlers",value:function(e){var t=this.props,n=this.getTarget();if(n){var r=s?{passive:t.passive,capture:t.capture}:t.capture;this.getKeys().forEach(function(a){e(n,a[1],t[a[0]],r)})}}},{key:"render",value:function(){var e=this;return this.props.target?null:a.createElement("noscript",{ref:function(t){e.node=t}})}}]),t}();function i(e,t,n,r){return!e.addEventListener&&(t="on"+t),(e.addEventListener||e.attachEvent).call(e,t,n,r),n}function c(e,t,n,r){return!e.removeEventListener&&(t="on"+t),(e.removeEventListener||e.detachEvent).call(e,t,n,r),n}o.displayName="DocumentEvents",o.defaultProps={capture:!1,enabled:!0,passive:!1};var s=function(){try{var e=!1;return document.createElement("div").addEventListener("test",function(){},{get passive(){e=!0}}),e}catch(e){return!1}}();e.exports=o},edRh:function(e,t){},fRjM:function(e,t){},fSKh:function(e,t){},fo6e:function(e,t){var n=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;e.exports=function(e){return n.test(e)}},foKU:function(e,t,n){"use strict";var r=n("17x9"),a=n.n(r),o=n("q1tI"),i=n.n(o),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var l=MB.config.SCALES[0],u=MB.config.SCALES[MB.config.SCALES.length-1],p=function(e){function t(){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=Array(a),i=0;i<a;i++)o[i]=arguments[i];return n=r=s(this,e.call.apply(e,[this].concat(o))),r.setElementRef=function(e){return r.$elem=e},r.handleWheel=function(e){e.preventDefault();var t=r.props,n=t.x,a=t.y,o=t.scale,i=t.onOffsetChange;if(e.ctrlKey||e.metaKey){var c=r.$elem.getBoundingClientRect(),s=c.top,l=(c.left+c.right)/2,u=(s+c.bottom)/2,p=o-e.deltaY/1.5,d=e.pageX-l,f=e.pageY-u;r.handleZoom(p,d,f)}else i(n-e.deltaX,a-e.deltaY)},s(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.handleZoom=function(e,t,n){var r=this.props,a=r.x,o=r.y,i=r.scale,c=r.onOffsetChange,s=r.onScaleChange,p=(e=Math.min(Math.max(e,l),u))/i;1!==p&&(c(t+p*(a-t),n+p*(o-n)),s(e))},t.prototype.render=function(){var e=this.props,t=e.x,n=e.y,r=e.scale,a=e.children,o=(e.onOffsetChange,e.onScaleChange,function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["x","y","scale","children","onOffsetChange","onScaleChange"]));return i.a.createElement("div",c({},o,{ref:this.setElementRef,onWheel:this.handleWheel}),a.map(function(e){return"function"==typeof e?e(t,n,r):e}))},t}(o.PureComponent);t.a=p,p.propTypes={x:a.a.number,y:a.a.number,scale:a.a.number,children:a.a.array,onScaleChange:a.a.func,onOffsetChange:a.a.func}},gQMU:function(e,t,n){var r=n("0ZTe")("toUpperCase");e.exports=r},gX9a:function(e,t){e.exports={"play-setting-menu":"_1FA8P7EgiQtr3ukFbj9cuo"}},hcHk:function(e,t){},hgQt:function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},j21k:function(e,t,n){"use strict";n("rXnp")},"jbM+":function(e,t,n){var r=n("R/W3");e.exports=function(e,t){return!(null==e||!e.length)&&r(e,t,0)>-1}},jl5L:function(e,t,n){var r=n("Sxd8"),a=n("tLB3"),o=n("dt0z"),i=Math.min;e.exports=function(e){var t=Math[e];return function(e,n){if(e=a(e),n=null==n?0:i(r(n),292)){var c=(o(e)+"e").split("e"),s=t(c[0]+"e"+(+c[1]+n));return+((c=(o(s)+"e").split("e"))[0]+"e"+(+c[1]-n))}return t(e)}}},knB1:function(e,t,n){"use strict";t.a={prefixAgo:null,prefixFromNow:"从现在开始",suffixAgo:"之前",suffixFromNow:null,seconds:"不到 1 分钟",minute:"大约 1 分钟",minutes:"%d 分钟",hour:"大约 1 小时",hours:"大约 %d 小时",day:"1 天",days:"%d 天",month:"大约 1 个月",months:"%d 月",year:"大约 1 年",years:"%d 年",numbers:[],wordSeparator:""}},"lm/5":function(e,t,n){var r=n("fmRc"),a=n("wF/u"),o=1,i=2;e.exports=function(e,t,n,c){var s=n.length,l=s,u=!c;if(null==e)return!l;for(e=Object(e);s--;){var p=n[s];if(u&&p[2]?p[1]!==e[p[0]]:!(p[0]in e))return!1}for(;++s<l;){var d=(p=n[s])[0],f=e[d],h=p[1];if(u&&p[2]){if(void 0===f&&!(d in e))return!1}else{var m=new r;if(c)var v=c(f,h,d,e,t,m);if(!(void 0===v?a(h,f,o|i,c,m):v))return!1}}return!0}},lw2U:function(e,t,n){"use strict";var r=n("yLV6"),a=n.n(r);var o=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.elementFrom=null,this.elementTo=null,this._delayedSync=null,this.delaySync=function(){t._delayedSync&&clearTimeout(t._delayedSync),t._delayedSync=setTimeout(function(){return t.sync()},100),t.sync()}}return e.prototype.init=function(e,t){this.elementFrom=e,this.elementTo=t,this.sync()},e.prototype.sync=function(){if(this.elementFrom&&this.elementTo){var e=this.elementFrom.scrollTop;this.elementTo.querySelector("#stickies").style.marginTop=0-e+"px"}},e}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.timeoutMap=new Map}return e.prototype.setTimeout=function(e){function t(t,n,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t,n){var r=this,a=setTimeout(function(){t(),r.clearTimeout(e,t)},n);return this.setToken(e,t,a),a}),e.prototype.clearTimeout=function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){var n=this.getToken(e,t);void 0!==n&&(clearTimeout(n),this.clearToken(e,t))}),e.prototype.clearTimeoutByKey=function(e){var t=this,n=this.timeoutMap.get(e);void 0!==n&&(n.forEach(function(n,r){return t.clearTimeout(e,r)}),this.timeoutMap.delete(e))},e.prototype.clear=function(){var e=this;this.timeoutMap.forEach(function(t,n){return e.clearTimeoutByKey(n)})},e.prototype.setToken=function(e,t,n){var r=this.timeoutMap.get(e);void 0===r&&(r=new Map,this.timeoutMap.set(e,r)),r.set(t,n)},e.prototype.getToken=function(e,t){var n=this.timeoutMap.get(e);if(n)return n.get(t)},e.prototype.clearToken=function(e,t){var n=this.timeoutMap.get(e);n&&n.delete(t)},e}();var c=function(){return(new Date).getTime()},s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mouseState={down:!1,moved:!1},this.scrollState={x:null,y:null,left:null,top:null,target:null},this.windowState={blur:!1},this.coolDownTime=c(),this.coolDownInterval=200}return e.prototype.isCoolDown=function(){var e=c()-this.coolDownTime;return this.coolDownTime+=e,e>this.coolDownInterval},e.prototype.resetCoolDown=function(){this.coolDownTime-=this.coolDownInterval},e.prototype.bind=function(e){var t=this,n=e.onScreenFocus;window.addEventListener("blur",function(){t.windowState.blur=!0}),window.addEventListener("focus",function(){t.windowState.blur&&(t.windowState.blur=!1,n())})},e.prototype.bindMobile=function(e){var t=this,n=e.onOrientationChange;window.addEventListener(void 0!==window.onorientationchange?"orientationchange":"resize",n),$("body").on("touchstart",".pcanvas",function(){t.mouseState.down=!0,t.mouseState.moved=!1}).on("touchmove",".pcanvas",function(){t.mouseState.down&&(t.mouseState.moved=!0)}).on("touchend",function(){t.mouseState.down=!1})},e.prototype.bindDesktop=function(e){var t=this,n=e.onAppMouseDown,r=e.onAppMouseMove;$("body").on("mousedown","#simulator-container",function(e){if(n(e,t.scrollState,t.mouseState))return!0;t.mouseState.down=!0,t.mouseState.moved=!1,t.scrollState.x=e.clientX,t.scrollState.y=e.clientY}).on("mousemove","#simulator-container",function(e){if(r(e,t.scrollState,t.mouseState))return!0;t.mouseState.moved=!0}),window.addEventListener("mouseup",function(){t.mouseState.down=!1})},e}();var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.setObjectUrl=function(e,t){e&&(e.contentWindow?e.contentWindow.location.replace(t):e.setAttribute("data",t))},e.prototype.deviceOrient=function(){return $(window).width()>$(window).height()?"landscape":"portrait"},e.prototype.cloneFixed=function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=n.show().clone();return a.attr("id",a.attr("id")+"gh"),t.v&&a.css("opacity",t.o/100),a.css("top",t.t()),a.hasClass("clickable")&&a.css("pointer-events","auto"),n.hide(),r?(t.isBottomFixed(e)&&(MB.isOddIOS()&&this.deviceOrient()===e.orient()?a.css("top",$("#simulator").height()-(e.h()-t.t())+MB.COMPONENTS.status_bar.height):a.css("top",$("#simulator").height()-(e.h()-t.t()))),a):a},e.prototype.setScreenBg=function(e){var t=Screen.find(e.data("cid"));t&&e.css({"background-color":t.bg(),"background-image":t.bgimage?"url("+t.getRealBgImage()+")":""})},e.prototype.screenPreview=function(e){return'\n      <div id="pscreen'+e.cid+'" class="pcanvas '+e.orient()+'" data-cid="'+e.cid+'" data-orientation="'+e.orient()+'">\n      <div class="widgets">\n        <div class="scontainer">\n          <div class="sheader"></div>\n          <div class="sfooter"></div>\n        </div>\n      </div>\n      <div class="stickies"></div>\n    </div>\n    '},e}();var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.activeWidth=function(){return"portrait"===MB.currentScreen.orientation?MB.currentProject.width:MB.currentProject.height},e.prototype.activeHeight=function(){return"portrait"===MB.currentScreen.orientation?MB.currentProject.height:MB.currentProject.width},e.prototype.hideScreen=function(e){$(e).hide(),$(e).find(".iframe").each(function(e,t){MB.runner.runnerUtil.setObjectUrl(t,"about:blank")})},e.prototype.doTransition=function(e,t,n,r){var a=this;n.enableTransition(r.delay()),t.enableTransition(r.delay()),(0===parseFloat(r.delay())||r.template&&-1!==e.indexOf("menu"))&&(e="none"),$.nextTick(function(){a[e](t,n,r)})},e.prototype.none=function(e,t,n){t.addClass("active"),e.removeClass("active top"),this.hideScreen(e),MB.runner.doneTransition(t)},e.prototype.slideIn=function(e,t,n,r,a,o){var i=this;e.transitionEnd(function(){e.removeClass("active"),t.addClass("active top"),i.hideScreen(e),MB.runner.doneTransition(t)}),e[n](r),t[n](a)},e.prototype.slidebottom=function(e,t,n){this.slideIn(e,t,"translateY",0-this.activeHeight(),0,n)},e.prototype.slideleft=function(e,t,n){this.slideIn(e,t,"translateX",0-this.activeWidth(),0,n)},e.prototype.slidetop=function(e,t,n){this.slideIn(e,t,"translateY",this.activeHeight(),0,n)},e.prototype.slideright=function(e,t,n){this.slideIn(e,t,"translateX",this.activeWidth(),0,n)},e.prototype.slideMenu=function(e,t,n,r,a){t.zindex("2"),e.css("z-index","101"),e.transitionEnd(function(){MB.runner.doneTransition(t)}),e[n](r)},e.prototype.leftmenu=function(e,t,n){this.slideMenu(e,t,"translateX",this.activeWidth()*n.menu_offset/100,n)},e.prototype.rightmenu=function(e,t,n){this.slideMenu(e,t,"translateX",0-this.activeWidth()*n.menu_offset/100,n)},e.prototype.fixedIn=function(e,t,n,r,a){var o=this;t.addClass("top"),t.css("z-index","101"),t.transitionEnd(function(){0===r&&(e.removeClass("active"),t.addClass("active"),o.hideScreen(e)),MB.runner.doneTransition(t),0!==r&&t.css("z-index","101")}),t[n](r)},e.prototype.topin=function(e,t,n){this.fixedIn(e,t,"translateY",0,n)},e.prototype.popin=function(e,t,n){this.fixedIn(e,t,"translateY",0,n)},e.prototype.slideleft2=function(e,t,n){this.fixedIn(e,t,"translateX",0,n)},e.prototype.slideright2=function(e,t,n){this.fixedIn(e,t,"translateX",0,n)},e.prototype.leftdrawer=function(e,t,n){this.fixedIn(e,t,"translateX",this.activeWidth()*(n.menu_offset-100)/100,n)},e.prototype.rightdrawer=function(e,t,n){this.fixedIn(e,t,"translateX",this.activeWidth()*(100-n.menu_offset)/100,n)},e.prototype.fixedOut=function(e,t,n,r,a){var o=this;t.zindex("2"),e.transitionEnd(function(){e.removeClass("active"),t.addClass("active"),o.hideScreen(e),MB.runner.doneTransition(t)}),e[n](r)},e.prototype.leftout=function(e,t,n){this.fixedOut(e,t,"translateX",0-this.activeWidth(),n)},e.prototype.rightout=function(e,t,n){this.fixedOut(e,t,"translateX",this.activeWidth(),n)},e.prototype.topout=function(e,t,n){this.fixedOut(e,t,"translateY",0-this.activeHeight(),n)},e.prototype.popout=function(e,t,n){this.fixedOut(e,t,"translateY",this.activeHeight(),n)},e.prototype.transitionHandler=function(e,t,n,r,a){switch("leftmenu"===e&&t.addClass("menu lmenu"),"rightmenu"===e&&t.addClass("menu rmenu"),"leftdrawer"===e&&n.addClass("drawer ldrawer"),"rightdrawer"===e&&n.addClass("drawer rdrawer"),e){case"popin":case"slidebottom":n.translate(0,a);break;case"topin":case"slidetop":n.translate(0,0-a);break;case"popout":case"none":case"leftout":case"rightout":case"topout":case"leftmenu":case"rightmenu":n.translate(0,0);break;case"slideright":case"slideleft2":case"leftdrawer":n.translate(0-r,0);break;case"slideleft":case"slideright2":case"rightdrawer":n.translate(r,0)}n[0].offsetHeight},e}();function p(e){e.Hammer=a.a,e.ScrollSync=o,e.TimeoutBucket=i,e.EventBucket=s,e.RunnerUtil=l,e.TransitionUtil=u}n.d(t,"a",function(){return p})},mbVZ:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n("Ev6p"),a="Channel's Buffer overflow!",o=1,i=3,c=4,s={isEmpty:r.o,put:r.r,take:r.r};function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments[1],n=new Array(e),r=0,s=0,l=0,u=function(t){n[s]=t,s=(s+1)%e,r++},p=function(){if(0!=r){var t=n[l];return n[l]=null,r--,l=(l+1)%e,t}},d=function(){for(var e=[];r;)e.push(p());return e};return{isEmpty:function(){return 0==r},put:function(p){if(r<e)u(p);else{var f=void 0;switch(t){case o:throw new Error(a);case i:n[s]=p,l=s=(s+1)%e;break;case c:f=2*e,n=d(),r=n.length,s=n.length,l=0,n.length=f,e=f,u(p)}}},take:p,flush:d}}var u={none:function(){return s},fixed:function(e){return l(e,o)},dropping:function(e){return l(e,2)},sliding:function(e){return l(e,i)},expanding:function(e){return l(e,c)}}},mfFm:function(e,t){e.exports={"global-attributes":"_2WW4d3N_h0ptLMSIJiNVZb","layer-name":"lHQ2gR47fywCXPyoNOQt-",header:"_3jioi4K2B2yOsbmLPodNyM",panel:"YjFkC1l7Pq0gsLgl2dq1C",container:"_3_XaUvUOzD1MeTPSGbtmJY",copyBtn:"M4cHnCN2XUVYXQ2Ez48Vk _2TAID7TnzAXoGA-jTBc04W","layer-load":"_3f1x0LwZiq_7c8_TaXvySo",spinner:"xKsPnP6rU53wBVIz85ai_","rotate-infinite":"_2ch38-nvB58TUdWQkKGJJo"}},mnpx:function(e,t){},mquD:function(e,t){e.exports={"comment-panel":"_2dY-aWly_WWZi-IGQ1xR4-","comment-title":"YqyjN9C59bWFJEndyU0x9","comment-thread":"_2JvGmMk3y1PjWCGDPVg4a3","content-reply":"_3VE5NwR9zvovJS1MW0BZbq",login:"_3t2Lcd3f0_H-u_GDe-KBQH",comment:"_2VqB6xZz3ZMhBswl_nFEOz","comment-content":"_2v8U22g6c4LkqK5BL4vOFl",folded:"_2uqO0IUh-mZN2HrJNeYj7n",edited:"_1unY7SoIkJpoCKI6YJj0dE","container-bottom":"_3z71HOTNMRJiMUXUxvQLa6",time:"dqXdK9pZPQyb9a-WoxDNQ","reply-sort":"_2bgB1qJyRonhAvn0gkm7vp","btn-reply":"_2CrlxaEt8G-J3ewI5c7TJD","header-container":"_1-DcnhePZGe-xicn8UM249","header-tool":"_3xcyCaTVLHlRdVbQjfMz9E","container-reply":"_2ApZU5bkYTTCyGA9Q2EwqQ",expand:"TuQgu47qydj8ZTQmbo3DZ","container-main":"_2OH87H-fOvv_HWhtjy1Arh","content-empty":"_3ICZ7qT9DBPhbMD02jZj25","add-comment":"_9237vxHyzd4yQZU3S8N9b","dropdown-reply":"_233Za55WRs0z9Ihd8UD-Rt","dropdown-on":"_6n2zhtMRn75CqBn6WWw3_","dropdown-off":"_3PfmWXeb9PKYb5ow8kDTMe","comment-focus":"hlPioZEAv4Td4VsmcHhIc","comment-noFocus":"_2j-cKmNGnUn_tT7eJlcXxe","reply-header":"xUcJzT-vOVVhL37FQnaC-","reply-content":"_1GkaiuxL0rWoniFDn2WBfK","remove-background":"e3k5YtTFT1_zohcDsL8Zv"}},mwIZ:function(e,t,n){var r=n("ZWtO");e.exports=function(e,t,n){var a=null==e?void 0:r(e,t);return void 0===a?n:a}},nLLt:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=function(e){return e.reduce(function(e,t){var n,r=(n=t)instanceof Array?n:n?[n]:[];return r.length?e.reduce(function(e,t){return r.forEach(function(n){return e.push(t+"-"+n)}),e},[]):e},["@"])},a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.permissionMap={}}return e.prototype.set=function(){for(var e=this,t=arguments.length,n=Array(t),a=0;a<t;a++)n[a]=arguments[a];r(n).forEach(function(t){return e.permissionMap[t]=!0})},e.prototype.check=function(){for(var e=this,t=arguments.length,n=Array(t),a=0;a<t;a++)n[a]=arguments[a];var o=r(n);return!!o.length&&o.every(function(t){return e.permissionMap[t]})},e}(),o=["owner","admin","editor","viewer","guest"],i=o.reduce(function(e,t,n){return e[t]=n,e},{}),c=function(e){return o.filter(function(t,n){return i[t]<=i[e]})},s=new a,l=s.set.bind(s),u=s.check.bind(s);l("project",["delete","create"],c("owner")),l("project-update",c("editor")),l("project-read-whitelist",c("viewer")),l("project-read",c("guest")),l("team-project-delete",c("admin")),l("team-project-create",c("editor")),l("team-project-read-whitelist",c("viewer")),l("team-project-read",c("guest")),l("collaborator",["delete","create","update"],["editor","viewer"],c("owner")),l("collaborator-read",["editor","viewer"],c("viewer")),l("team-collaborator",["delete","create","update"],["admin"],c("owner")),l("team-collaborator",["delete","create","update"],["editor","viewer"],c("admin")),l("team-collaborator-read",["admin","editor","viewer"],c("viewer"))},oKLx:function(e,t){},oZtI:function(e,t,n){"use strict";var r=n("tw9P");n.d(t,"f",function(){return r.i}),n.d(t,"d",function(){return r.g}),n.d(t,"a",function(){return r.b}),n.d(t,"b",function(){return r.d}),n.d(t,"c",function(){return r.f}),n.d(t,"e",function(){return r.h}),n.d(t,"g",function(){return r.j})},or5M:function(e,t,n){var r=n("1hJj"),a=n("QoRX"),o=n("xYSL"),i=1,c=2;e.exports=function(e,t,n,s,l,u){var p=n&i,d=e.length,f=t.length;if(d!=f&&!(p&&f>d))return!1;var h=u.get(e);if(h&&u.get(t))return h==t;var m=-1,v=!0,g=n&c?new r:void 0;for(u.set(e,t),u.set(t,e);++m<d;){var y=e[m],b=t[m];if(s)var w=p?s(b,y,m,t,e,u):s(y,b,m,e,t,u);if(void 0!==w){if(w)continue;v=!1;break}if(g){if(!a(t,function(e,t){if(!o(g,t)&&(y===e||l(y,e,n,s,u)))return g.push(t)})){v=!1;break}}else if(y!==b&&!l(y,b,n,s,u)){v=!1;break}}return u.delete(e),u.delete(t),v}},peh1:function(e,t,n){"use strict";function r(e,t){return e===t}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,n=null,a=null;return function(){return function(e,t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var r=t.length,a=0;a<r;a++)if(!e(t[a],n[a]))return!1;return!0}(t,n,arguments)||(a=e.apply(null,arguments)),n=arguments,a}}function o(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];var i=0,c=r.pop(),s=function(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every(function(e){return"function"==typeof e})){var n=t.map(function(e){return typeof e}).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+n+"]")}return t}(r),l=e.apply(void 0,[function(){return i++,c.apply(null,arguments)}].concat(n)),u=a(function(){for(var e=[],t=s.length,n=0;n<t;n++)e.push(s[n].apply(null,arguments));return l.apply(null,e)});return u.resultFunc=c,u.recomputations=function(){return i},u.resetRecomputations=function(){return i=0},u}}t.__esModule=!0,t.defaultMemoize=a,t.createSelectorCreator=o,t.createStructuredSelector=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;if("object"!=typeof e)throw new Error("createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);var n=Object.keys(e);return t(n.map(function(t){return e[t]}),function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce(function(e,t,r){return e[n[r]]=t,e},{})})};var i=t.createSelector=o(a)},q09E:function(e,t,n){"use strict";var r=n("Ev6p"),a={done:!0,value:void 0},o={};function i(e){return r.n.channel(e)?"channel":Array.isArray(e)?String(e.map(function(e){return String(e)})):String(e)}function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"iterator",i=void 0,c=t;function s(t,n){if(c===o)return a;if(n)throw c=o,n;i&&i(t);var r=e[c](),s=r[0],l=r[1],u=r[2];return i=u,(c=s)===o?a:l}return Object(r.q)(s,function(e){return s(null,e)},n,!0)}var s=n("tw9P"),l=n("92lH");function u(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var u={done:!1,value:Object(s.i)(e)},p=void 0,d=function(e){return p=e};return c({q1:function(){return["q2",u,d]},q2:function(){return p===l.a?[o]:["q1",(e=p,{done:!1,value:s.f.apply(void 0,[t].concat(r,[e]))})];var e}},"q1","takeEvery("+i(e)+", "+t.name+")")}function p(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var u={done:!1,value:Object(s.i)(e)},p=function(e){return{done:!1,value:s.f.apply(void 0,[t].concat(r,[e]))}},d=void 0,f=void 0,h=function(e){return d=e},m=function(e){return f=e};return c({q1:function(){return["q2",u,m]},q2:function(){return f===l.a?[o]:d?["q3",function(e){return{done:!1,value:Object(s.e)(e)}}(d)]:["q1",p(f),h]},q3:function(){return["q1",p(f),h]}},"q1","takeLatest("+i(e)+", "+t.name+")")}var d=n("mbVZ");function f(e,t,n){for(var a=arguments.length,u=Array(a>3?a-3:0),p=3;p<a;p++)u[p-3]=arguments[p];var f=void 0,h=void 0,m={done:!1,value:Object(s.a)(t,d.a.sliding(1))},v={done:!1,value:Object(s.d)(r.j,e)},g=function(e){return f=e},y=function(e){return h=e};return c({q1:function(){return["q2",m,y]},q2:function(){return["q3",{done:!1,value:Object(s.i)(h)},g]},q3:function(){return f===l.a?[o]:["q4",(e=f,{done:!1,value:s.f.apply(void 0,[n].concat(u,[e]))})];var e},q4:function(){return["q2",v]}},"q1","throttle("+i(t)+", "+n.name+")")}n.d(t,"a",function(){return u}),n.d(t,"b",function(){return p}),n.d(t,"c",function(){return f})},q3nj:function(e,t,n){"use strict";var r=n("oZtI"),a=n("t3Un"),o=function(e){return Object(a.a)("/api/v2/projects/"+e+"/sketch_slices.json")},i=function(e){return Object(a.a)("/api/v2/projects/"+e+"/build/slices_zips.json",null,{method:"POST"})},c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=regeneratorRuntime.mark(p),l=regeneratorRuntime.mark(d),u=regeneratorRuntime.mark(f);function p(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(r.a)([d()]);case 2:case"end":return e.stop()}},s,this)}function d(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(r.g)("reducer:slice:init",f);case 2:case"end":return e.stop()}},l,this)}function f(e){var t,n,a,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(r.e)();case 2:if(t=e.sent,n=t.model.current.projectCid,e.prev=4,a=void 0,!n){e.next=15;break}return e.next=9,Object(r.b)(o,n);case 9:a=e.sent,i=a.slices,s=i.filter(h),a.slices=s,e.next=16;break;case 15:a={slices:[{id:1,name:"test",screen_cid:"sssss1232",image:"/uploads/images/14/149316/artboard_1506665060.png",src:"ssss",image_set:[{size:1,src:"src"}],image_set_zip:"src"},{id:2,name:"test",screen_cid:"sssss1232",image:"/uploads/images/14/149316/artboard_1506665060.png",image_set:[{size:1,src:"src"}],image_set_zip:"src"},{id:3,name:"test",screen_cid:"sssss1232",image:"/uploads/images/14/149316/artboard_1506665060.png",image_set:[{size:1,src:"src"}],image_set_zip:"src"}]};case 16:return e.next=18,Object(r.d)({type:"reducer:slice:success",payload:c({},a)});case 18:e.next=25;break;case 20:return e.prev=20,e.t0=e.catch(4),console.log(e.t0.stack),e.next=25,Object(r.d)({type:"reducer:slice:fail"});case 25:case"end":return e.stop()}},u,this,[[4,20]])}var h=function(e){var t=e.width,n=void 0===t?1:t,r=e.height;return n>0&&(void 0===r?1:r)>0},m=function(e){return window.MBArtboards?{artboards:Object.values(window.MBArtboards).map(function(e){return e.artboard})}:Object(a.a)("/api/v2/projects/"+e+"/artboards.json")},v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},g=regeneratorRuntime.mark(w),y=regeneratorRuntime.mark(C),b=regeneratorRuntime.mark(E);function w(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(r.a)([C()]);case 2:case"end":return e.stop()}},g,this)}function C(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(r.g)("reducer:artboards:init",E);case 2:case"end":return e.stop()}},y,this)}function E(e){var t,n,a,o,i,c,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(r.e)();case 2:if(t=e.sent,n=t.model,a=n.current.projectCid,o=n.screens,e.prev=4,i={},o.forEach(function(e){var t=e.width,n=e.height,r=e.cid;i[r]={width:t,height:n}}),!a){e.next=13;break}return e.next=10,Object(r.b)(m,a);case 10:c=e.sent,(s=c.artboards).length>0&&s.forEach(function(e){var t=e.width,n=e.height,r=e.screen_cid;i[r]={width:t,height:n}});case 13:return i={artboards:i},e.next=16,Object(r.d)({type:"reducer:artboards:success",payload:v({},i)});case 16:e.next=23;break;case 18:return e.prev=18,e.t0=e.catch(4),console.log(e.t0.stack),e.next=23,Object(r.d)({type:"reducer:artboards:fail"});case 23:case"end":return e.stop()}},b,this,[[4,18]])}var S=n("fvjX"),O=n("/MKj"),_=n("17x9"),j=n.n(_),x=n("q1tI"),T=n.n(x),k=n("M8nv"),M=n.n(k),N=n("TSYQ"),R=n.n(N),I="REQUEST_SELECT_LAYER",L="SELECT_LAYER",P=function(e){return{type:L,payload:{layerID:e}}},A="ACTIVATE_LAYER",D=function(e){return MB.event("点击了 Layer 元素","运行页"),{type:A,payload:{layerID:e}}},B="ENTER_LAYER",U=n("J2m7"),F=n.n(U),q=n("/5+U"),W=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},z=function(e){var t=e.layer,n=t.top,r=t.left,a=t.width,o=t.height,i=t.rotation,c=void 0===i?0:i,s=e.currentScreen,l=Object(q.l)({width:a,height:o,left:r,top:n,rotate:c}),u=l[0],p=l[1],d=l[2],f=l[3],h=s.width,m=s.height,v={top:u/m*100+"%"},g={left:"calc("+(p+d)/h*100+"% - 1px)"},y={top:"calc("+(u+f)/m*100+"% - 1px)"},b={left:p/h*100+"%"};return T.a.createElement("ul",{className:"LayerBoundings"},T.a.createElement("li",{className:"LayerBounding LayerBounding--top",style:v}),T.a.createElement("li",{className:"LayerBounding LayerBounding--right",style:g}),T.a.createElement("li",{className:"LayerBounding LayerBounding--bottom",style:y}),T.a.createElement("li",{className:"LayerBounding LayerBounding--left",style:b}))};z.propTypes={layer:j.a.object,currentScreen:j.a.object};var H=function(e,t,n){return n>e&&n<t},V=function(e){var t=e.activeLayer,n=e.enteredLayer,r=e.currentScreen,a=e.unit,o=e.ratio;if(!t||!n||t.id===n.id)return null;var i=Object(q.l)({width:t.width,height:t.height,top:t.top,left:t.left,rotate:t.rotation||0}),c=i[0],s=i[1],l=i[2],u=i[3],p=Object(q.l)({width:n.width,height:n.height,left:n.left,top:n.top,rotate:n.rotation||0}),d=p[0],f=p[1],h=p[2],m=p[3],v={horizontal:{line1:[{display:s,src:t.src_left},{display:s+l,src:t.src_left+t.src_width}],line2:[{display:f,src:n.src_left},{display:f+h,src:n.src_left+n.src_width}]},vertical:{line1:[{display:c,src:t.src_top},{display:c+u,src:t.src_top+t.src_height}],line2:[{display:d,src:n.src_top},{display:d+m,src:n.src_top+n.src_height}]}},g={horizontal:[],vertical:[]},y={horizontal:{},vertical:{}};for(var b in v)for(var w=v[b].line1,C=v[b].line2,E=0;E<w.length;E++)for(var S=0;S<C.length;S++){var O=w[E].display>C[S].display?{start:C[S],end:w[E]}:{start:w[E],end:C[S]},_=O.start,j=O.end;H(_.display,j.display,w[1-E].display)||H(_.display,j.display,C[1-S].display)||!(j.display-_.display>0)||_.display===w[0].display&&j.display===w[1].display||_.display===C[0].display&&j.display===C[1].display||y[b][_.display]||(y[b][j.display]=!0,g[b].push({start:_,end:j}))}var x=[],k=r.width,M=r.height,N=function(e,t){var n=Object(q.l)({width:e.width,height:e.height,top:e.top,left:e.left,rotate:e.ro}),r=n[0],a=n[1],o=n[2],i=n[3],c=t.width,s=t.left,l=t.top,u=a+o,p=s+c,d=r+i,f=l+t.height,h=!1,m=!1,v=!1;return(a<=s&&u>=p&&r<=l&&d>=f||a>=s&&a<=p&&r>=l&&d<=f)&&(v=!0),(a>=s&&a<=p||s>=a&&s<=u)&&(h=!0),(r<=l&&d>=l||r>=l&&f>=r)&&(m=!0),{ifHorizontal:h,ifVertical:m,ifAllWraped:v}}(t,n),R=N.ifHorizontal,I=N.ifVertical,L=N.ifAllWraped,P=function(e){switch(e){case"horizontal":case"vertical":return delete g[e];case"all":return delete g.horizontal,void delete g.vertical;default:return}};!L&&R&&!I&&P("horizontal"),!L&&I&&!R&&P("vertical"),!L&&R&&I&&P("all");var A=function(e){x.push(g[e].map(function(t,n){var r=void 0;r="horizontal"===e?{left:t.start.display/k*100+"%",width:(t.end.display-t.start.display)/k*100+"%",top:(u/2+c)/M*100+"%"}:{top:t.start.display/M*100+"%",height:(t.end.display-t.start.display)/M*100+"%",left:(l/2+s)/k*100+"%"},Object.assign(r,{zIndex:Math.pow(2,31)});var i=Object(q.b)(t.end.src-t.start.src,o);return T.a.createElement("li",{key:""+e+n,className:"LayerDistance LayerDistance--"+e,"data-length":t.end.src-t.start.src,style:r},T.a.createElement("span",null,""+i+a))}))};for(var D in g)A(D);return T.a.createElement("ul",{className:"LayerDistances"},Array.prototype.concat.apply([],x))};V.propTypes={activeLayer:j.a.object,enteredLayer:j.a.object,currentScreen:j.a.object,unit:j.a.string,ratio:j.a.number};var G=function(e){var t=e.activeLayer,n=e.enteredLayer,r=e.currentScreen,a=e.unit,o=e.ratio;return T.a.createElement("div",{className:"MeasuresContainer"},n&&n!=t&&T.a.createElement(z,{layer:n,currentScreen:r,unit:a,ratio:o}),T.a.createElement(V,{activeLayer:t,enteredLayer:n,currentScreen:r,unit:a,ratio:o}))};G.propTypes={activeLayer:j.a.object,enteredLayer:j.a.object,currentScreen:j.a.object,unit:j.a.string,ratio:j.a.number};var K=Object(O.connect)(function(e){return W({},function(e){var t=e.container,n=t.layers,r=n.resourceByScreen,a=n.visibilityScreenID,o=n.activeLayerID,i=n.enteredLayerID,c=t.previewSetting,s=c.ratio,l=c.unit,u=e.model,p=u.current.screenCid,d=u.screens,f=r[a];return f?{activeLayer:F()(f.layers,function(e){return e.id===o}),enteredLayer:F()(f.layers,function(e){return e.id===i}),currentScreen:d.find(function(e){return e.cid===p}),ratio:s,unit:l}:{activeLayer:{},enteredLayer:{},currentScreen:{}}}(e))})(G);function X(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function Z(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Q=function(e){function t(){X(this,t);var n=Y(this,e.call(this));return n.handleClick=function(){var e=n.props,t=e.requestSelectLayer,r=e.layer.id,a=e.handleShowlayerInfo;t(r),a(!0)},n.onMouseEnter=n.onMouseEnter.bind(n),n.onMouseLeave=n.onMouseLeave.bind(n),n}return Z(t,e),t.prototype.onMouseEnter=function(e){-1!==this.props.activeLayerID&&this.props.enterLayer(this.props.layer.id)},t.prototype.onMouseLeave=function(e){-1!==this.props.activeLayerID&&this.props.enterLayer(-1)},t.prototype.render=function(){var e=this.props,t=e.layer,n=e.activeLayerID,r=e.enteredLayerID,a=e.currentScreen,o=e.unit,i=e.ratio,c=t.id,s=t.kind,l=t.width,u=t.height,p=t.top,d=t.left,f=t.src_width,h=t.src_height,m=t.z,v=a.width,g=a.height,y=Math.pow(2,30)+m,b=t.rotation||0,w=Object(q.l)({width:l,height:u,rotate:b,top:p,left:d}),C=w[0],E=w[1],S={width:w[2]/v*100+"%",height:w[3]/g*100+"%",top:C/g*100+"%",left:E/v*100+"%",zIndex:"group"===s?y-1:y||0},O=c===n,_=c===r||-1===r,j=R()("Layer",{"is-active":O,"is-focus":_}),x=Object(q.b)(f,i),k=Object(q.b)(h,i);return T.a.createElement("div",{className:j,style:S,"data-width":""+x+o,"data-height":""+k+o,"data-lid":c,onClick:this.handleClick,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},O&&T.a.createElement("span",{className:"LayerCorner left top"}),O&&T.a.createElement("span",{className:"LayerCorner left bottom"}),O&&T.a.createElement("span",{className:"LayerCorner right top"}),O&&T.a.createElement("span",{className:"LayerCorner right bottom"}))},t}(x.Component);Q.propTypes={layer:j.a.object,artboard:j.a.object,requestSelectLayer:j.a.func,enterLayer:j.a.func,currentScreen:j.a.object,handleShowlayerInfo:j.a.func,activeLayerID:j.a.oneOfType([j.a.number,j.a.string]),enteredLayerID:j.a.oneOfType([j.a.number,j.a.string]),unit:j.a.string,ratio:j.a.number,scale:j.a.number};var J=function(e){function t(){var n,r;X(this,t);for(var a=arguments.length,o=Array(a),i=0;i<a;i++)o[i]=arguments[i];return n=r=Y(this,e.call.apply(e,[this].concat(o))),r.state={ifHideLayer:!1},r.onMouseLeave=function(){r.props.enterLayer(r.props.currentScreen.cid)},r.checkIfNeedHideLayer=function(e){var t=r.props,n=t.isSpaceDown,a=t.requestSelectLayer,o=t.handleShowlayerInfo;!n&&e.target.contains(document.getElementById("simulator-wrapper"))&&(a(-1),o(!1))},Y(r,n)}return Z(t,e),t.prototype.componentWillReceiveProps=function(e){var t=e.currentScreen,n=e.activeLayerID,r=this.props,a=r.currentScreen,o=r.enterLayer;t!=a&&o(-1),-1!==n&&n?this.setState({ifHideLayer:!1}):this.setState({ifHideLayer:!0})},t.prototype.render=function(){var e=this.props,t=e.layers,n=e.project.scale,r=e.requestSelectLayer,a=e.enterLayer,o=e.activeLayerID,i=e.enteredLayerID,c=e.currentScreen,s=e.unit,l=e.ratio,u=e.handleShowlayerInfo,p=e.isShowLayerList,d=e.isSelectLayer,f=this.state.ifHideLayer,h=R()({hiddenLayer:f&&p}),m=ee({ifHideLayer:f,activeLayerID:o,isShowLayerList:p});return T.a.createElement("div",{className:h},T.a.createElement("ul",{className:"LayerList checkIfClickLayer",onMouseLeave:this.onMouseLeave},t.map(function(e){return T.a.createElement("li",{key:e.id},T.a.createElement(Q,{layer:e,requestSelectLayer:r,enterLayer:a,activeLayerID:o,enteredLayerID:i,currentScreen:c,handleShowlayerInfo:u,scale:n,unit:s,ratio:l}))})),m&&T.a.createElement(K,null),d&&T.a.createElement(M.a,{onClick:this.checkIfNeedHideLayer}))},t}(x.Component);J.propTypes={isSpaceDown:j.a.bool,project:j.a.object,layers:j.a.array,requestSelectLayer:j.a.func,resetLayer:j.a.func,enterLayer:j.a.func,handleShowlayerInfo:j.a.func,isSelectLayer:j.a.bool,currentScreen:j.a.object,activeLayerID:j.a.oneOfType([j.a.number,j.a.string]),enteredLayerID:j.a.oneOfType([j.a.number,j.a.string]),isShowLayerList:j.a.bool,unit:j.a.string,ratio:j.a.number,dispatch:j.a.func};var ee=function(e){var t=e.ifHideLayer,n=e.activeLayerID,r=e.isShowLayerList;return-1!==n&&r&&!t},te=Object(q.h)(function(e,t){return e.find(function(e){return e.cid===t})}),ne=Object(O.connect)(function(e){var t=e.container,n=t.common.keyFlags.isSpaceDown,r=t.layers,a=r.resourceByScreen,o=r.visibilityScreenID,i=r.activeLayerID,c=r.enteredLayerID,s=t.previewSetting,l=s.unit,u=s.ratio,p=s.isShowColorPicker,d=s.isSelectLayer,f=e.model,h=f.current,m=h.screenCid,v=h.projectCid,g=f.screens,y=f.projects,b=g.find(function(e){return e.cid===m}),w=te(y,v);return{isSpaceDown:n,layers:a[o]&&a[o].layers||[],currentScreen:b,activeLayerID:i,enteredLayerID:c,isShowLayerList:!p,isSelectLayer:d,project:w,unit:l,ratio:u}},function(e){return{requestSelectLayer:function(t){e(function(e){return!(arguments.length>1&&void 0!==arguments[1])||arguments[1],{type:I,payload:{layerID:e}}}(t))},enterLayer:function(t){e(function(e){return{type:B,payload:{layerID:e}}}(t))},handleShowlayerInfo:function(t){e({type:"reducer:preview-toolbar:update",payload:{isSelectLayer:t}})}}})(J),re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ae="SET_VISIBILITY_SCREEN",oe="RECEIVE_RESOURCE_SUCCESS",ie=function(e,t){var n=t.document,r=t.layers,a=t.artboard;return{type:oe,payload:re({screenID:e},n,{layers:r,artboard:a})}},ce="RECEIVE_RESOURCE_ERROR",se=function(e,t){return{type:ce,payload:{screenID:e,error:t}}};var le={selectedLayerID:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments[1];switch(t.type){case L:return t.payload.layerID===e?-1:t.payload.layerID;case ae:return-1;default:return e}},activeLayerID:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments[1];switch(t.type){case A:return t.payload.layerID;case ae:return-1;default:return e}},enteredLayerID:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments[1];switch(t.type){case B:return t.payload.layerID;default:return e}}},ue=(n("oKLx"),{actions:{activateLayer:D},container:ne,reducer:le}),pe=function(e){var t=e.children;return T.a.createElement("div",null,t)};pe.propTypes={children:j.a.element};var de=pe;var fe=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.render=function(){var e=this.props,t=e.isFetching,n=e.error;return e.isActive?t?null:n?null:T.a.createElement(de,null,T.a.createElement(ue.container,null)):null},t}(T.a.Component);fe.propTypes={isFetching:j.a.bool,error:j.a.string,isActive:j.a.bool};var he=fe,me=Object(O.connect)(function(e){var t=e.container,n=t.previewSetting.toolbarActiveItem,r=t.layers,a=r.resourceByScreen[r.visibilityScreenID]||{},o=a.isFetching,i=void 0===o||o,c=a.screen,s=void 0===c?{}:c,l=a.error;return{isFetching:i,screen:s,error:void 0===l?"":l,isActive:"inspect"==n}})(he);var ve={"-1":{isFetching:!1,layers:[],error:""}};var ge={visibilityScreenID:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"-1",t=arguments[1];switch(t.type){case ae:return t.payload.screenID;default:return e}},resourceByScreen:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,n=arguments[1];switch(n.type){case oe:case ce:return Object.assign({},t,((e={})[n.payload.screenID]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,layers:[],error:""},t=arguments[1];switch(t.type){case oe:return Object.assign({},e,{isFetching:!1,layers:t.payload.layers,error:void 0,artboard:t.payload.artboard,documentColor:t.payload.document_colors,globalColor:t.payload.global_colors,globalText:t.payload.text_styles});case ce:return Object.assign({},e,{isFetching:!1,layers:[],error:t.payload.error});default:return e}}(t[n.payload],n),e));case"container:layers:clear":return ve;default:return t}}},ye=(n("AbUM"),function(e){return window.MBArtboards[e]}),be=function(e){return Object(a.a)("/apis/sketch/artboards/"+e+".json")},we=n("qOCw"),Ce=function(e){return["navigation_bar","status_bar","tab_bar","keyboard"].includes(e)},Ee=/<[^>]+>/gi,Se=n("9ndP"),Oe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_e=regeneratorRuntime.mark(De),je=regeneratorRuntime.mark(Be),xe=regeneratorRuntime.mark(qe),Te=regeneratorRuntime.mark(We),ke=regeneratorRuntime.mark(ze),Me=function(e,t){var n=e+"_"+MB.currentProject.device,r=e,a=Se.a[n]||Se.a[r];return a&&a[t]?a[t]:Se.a[t]},Ne=[],Re=/\\\w+/gi,Ie=function(e){return e?e.replace(Re,"").trim():Se.a},Le=function(e,t){var n,r={},a=e.name,o=e.ro,i=e.br,c=e.bs,s=e.ha,l=e.va,u=e.lh,p=e.sc,d=e.ds,f=e.text,h=void 0;return f&&(h=!!(n=f)&&n.replace(Ee,""),r.text_styles=[{font_size:e.fs,color:Ie(e.tc||Me(a,"tc")),length:h.length,font_face:function(e,t){var n=Object(q.i)(e)?"chinese":"english",r="iphone"===t||"ipad"===t?"ios":t,a=Fe()?"mac":"windows";return Xe[a][r][n]}(f,t)}],r.text=h),s&&(r.alignment=s),l&&(r.vertical_alignment=l),u&&(r.line_height=u),i&&(r.bd_radius=i),o&&(r.rotation=o),r.bc=Ie(e.bc||Me(a,"bc")),c&&(r.borders=[{thickness:c,color:Ie(r.bc)}]),e.bg&&(r.bg_colors=[{value:Ie(e.bg)}]),"triangleb"!==a&&"triangletl"!==a&&"icon_button"!==a||(r.bg_colors=[{value:Ie(e.tc||Me(a,"tc"))}]),p&&d&&(r.shadows=[{color:Ie(p.replace(Re,"")),blur_radius:d}]),e.ts&&(r.textShadows=[{color:Ie(e.tsc.replace(Re,"")),blur_radius:e.ts}]),"label"!==a&&"text_view"!==a||(r.hiddSpacing=!0),Object.assign({},e,r)},Pe=function(e){return e&&"w"===e[0]},Ae=function(e){if(!e.layers.some(function(e){return e.z})){var t=Math.pow(2,30);e.layers.forEach(function(e){e.z=t-Math.round(parseInt(e.width)*parseInt(e.height))})}};function De(e){var t,n,a,o,i,c,s,l,u,p,d,f,h,m,v,g,y,b;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(r.e)();case 2:if(t=e.sent,n=t.container.layers,a=n.resourceByScreen,o=n.visibilityScreenID,i=t.model,c=i.current,s=c.screenCid,l=c.projectCid,u=i.screens,p=i.widgets,d=i.projects,f=u.find(function(e){return e.cid===s}),h=Ue(d,l),m=h.device,v=Ge(s),g=p.concat(v),a[o]&&!a[o].error){e.next=40;break}if(Ne.includes(o)){e.next=40;break}if(Ne.push(o),e.prev=11,y=void 0,!f.artboard_id){e.next=26;break}if(!window.MBArtboards){e.next=20;break}return e.next=17,Object(r.b)(ye,f.cid);case 17:y=e.sent,e.next=24;break;case 20:return e.next=22,Object(r.b)(be,f.artboard_id);case 22:y=e.sent,Ae(y);case 24:e.next=27;break;case 26:y={artboard:{width:f.width,height:f.height},layers:[],document:{document_colors:[],text_styles:[],global_colors:Ke()}};case 27:return b=0,y.layers=[{type:"screen",id:f.cid,name:f.name,top:0,left:0,width:f.width,height:f.height,src_left:0,src_top:0,src_width:y.artboard.width,src_height:y.artboard.height,bg_colors:[{value:Ie(f.bgcolor)}]}].concat(g.filter(function(e){return b||e.screen_cid!==f.cid||"status_bar"!==e.name||(b=e.height),e.screen_cid===f.cid&&!["pg","lr","sticky"].includes(e.name)&&e.v&&!("image_view"===e.name&&e.width===f.width&&e.height===f.height)}).map(function(e){var t=void 0;switch(e.name){case"status_bar":t=0;break;case"keyboard":case"tab_bar":t=f.height-e.height;break;case"navigation_bar":t=b;break;default:t=e.top}return e.top=t,Ce(e.name)&&(e.width=f.width),Le(e,m)}).concat(y.layers).reduce(function(e,t){var n=t.id,r=t.top,a=t.left,o=t.width,i=t.height,c=Pe(n)?1:f.width/y.artboard.width,s=a*c,l=r*c,u=o*c,p=i*c,d=Math.min(Math.max(s,0),f.width),h=Math.min(Math.max(s+u,0),f.width),m=Math.min(Math.max(l,0),f.height),v=Math.min(Math.max(l+p,0),f.height);return h-d!=0&&v-m!=0?e.concat([Object.assign({},t,{left:d,top:m,width:h-d,height:v-m,src_top:Number(parseFloat(Math.max(r,0)).toFixed(2)),src_left:Number(parseFloat(Math.max(a,0)).toFixed(2)),src_width:Number(parseFloat(Math.min(a+o,y.artboard.width)-Math.max(a,0)).toFixed(2)),src_height:Number(parseFloat(Math.min(r+i,y.artboard.height)-Math.max(r,0)).toFixed(2))})]):e.concat([])},[])),Ne.splice(Ne.indexOf(o),1),e.next=32,Object(r.d)(ie(o,y));case 32:e.next=40;break;case 34:return e.prev=34,e.t0=e.catch(11),console.log(e.t0.stack),Ne.splice(Ne.indexOf(o),1),e.next=40,Object(r.d)(se(o,e.t0.message));case 40:case"end":return e.stop()}},_e,this,[[11,34]])}function Be(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(r.g)(ae,De);case 2:case"end":return e.stop()}},je,this)}var Ue=Object(q.h)(function(e,t){return e.find(function(e){return e.cid===t})}),Fe=function(){return/Mac|iPod|iPhone|iPad/.test(window.navigator.platform)};function qe(e){var t,n,a,o,i,c;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=e.payload.layerID,s.next=3,Object(r.e)();case 3:return n=s.sent,a=n.container.layers,o=a.resourceByScreen,i=a.visibilityScreenID,c=Ve(o[i].layers,t),He&&console.log("[makeSureWithSliceId]",c),s.next=9,Object(r.d)(P(c));case 9:return s.next=11,Object(r.d)(D(c));case 11:case"end":return s.stop()}},xe,this)}function We(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(r.g)(I,qe);case 2:case"end":return e.stop()}},Te,this)}function ze(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,[Be(),We()];case 2:case"end":return e.stop()}},ke,this)}var He=!1,Ve=function(e,t){var n=F()(e,{id:t});if(!n||!n.parent||n.image_set_zip)return t;for(;n;){var r=F()(e,{id:n.parent});if(!r||!r.image_set_zip||!r.parent)return t;if(r.image_set_zip)return n.parent;n=r.parent}},Ge=function(e){var t=window.Screen;return t?t.find(e).cpanels().reduce(function(t,n){var r=n.top,a=n.left,o=n.mainState().cwidgets();return t.concat(o.map(function(t){var o=t.__proto__;return Oe({},o,{z:n.z+o.z,top:t.top+r,left:t.left+a,screen_cid:e})}))},[]):[]},Ke=function(){return He?["rgba(0.816203773021698,0.007513228338211775,0.1066960170865059,1)","rgba(0.9617109894752502,0.6503673195838928,0.1385422945022583,0.2)"]:[]},Xe={mac:{ios:{chinese:"PingFang SC",english:"-apple-system"},android:{chinese:"PingFang SC",english:"Roboto"},web:{chinese:"PingFang SC",english:"Roboto"}},windows:{ios:{chinese:"Microsoft Yahei",english:"Arial"},android:{chinese:"Microsoft Yahei",english:"Roboto"},web:{chinese:"Microsoft Yahei",english:"Roboto"}}},Ye=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ze=Object(S.combineReducers)(Ye({},ge,ue.reducer)),Qe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Je={screenSearch:""};var $e=n("1iCU"),et=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tt={ratio:1,emPixel:16,unit:"px",colorUnit:"hex",language:"css",toolbarActiveItem:$e.c,isShowColorPicker:!1,isSelectLayer:!1,userPickColor:Object(q.g)(),focusColor:null,loadSliceUrl:""};var nt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rt={artboards:[],error:!1};var at=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ot={slices:[],loading:!0,error:!1};var it=[0,1,2,3,4,5,6,7].map(function(e){return{create:!!(1&e),update:!!(2&e),delete:!!(4&e)}}),ct={owner:!0,admin:!0,editor:!0,viewer:!0},st={owner:!0,admin:!0},lt={allowComment:!1,denyMessage:""},ut=function(){return lt},pt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"INVALID_ID_0",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"INVALID_ID_1",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments[4],o=lt.allowComment,i=a&&"owner"===a.role,c=n===t,s="owner"===e,l=o&&ct[e]||!1,u=o&&l&&c,p=void 0;return p=null===r?o&&(u||st[e]||!1)||c:o&&(i?s:"admin"===e)||c||s,it[(l?1:0)+(u?2:0)+(p?4:0)]},dt=n("cAqp"),ft=n.n(dt),ht=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var mt=ft.a["comment-marker"],vt=function(e){function t(n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n)),a={isDragging:!1,position:{left:0,top:0}},o=ht({},yt,{mousemove:Object(q.j)(function(e){var t=r.props,n=t.offsetLeft,a=t.offsetTop,o=(0,t.markerOperations.getMarkerPosition)(e);(r.state.isDragging||function(e,t,n){var r=e-n.left,a=t-n.top;return r*r+a*a>=bt}(n,a,o))&&r.setState({isDragging:!0,position:o})}),mouseup:Object(q.j)(function(e){if(c(),r.state.isDragging){var t=r.props,n=t.commentThreadCid,o=t.markerOperations,i=o.doUpdateCommentThread,s=(0,o.getMarkerPosition)(e);i({cid:n,left:s.left,top:s.top})}else setTimeout(function(){var e=r.props,t=e.isSelect,n=e.commentThreadCid;(0,e.markerOperations.setSelectCommentThreadCid)(t?null:n)},0);r.setState(a)}),mouseleave:function(){c(),r.props.markerOperations.setFocusCommentThreadCid(null),r.setState(a)}}),i=ht({},yt,{mouseup:o.mouseup}),c=function(){return r.props.markerOperations.removeContainerEventListener(r.props.isEditable?o:i)};return r.markerListenerMap={onMouseDown:Object(q.j)(function(){return r.props.markerOperations.addContainerEventListener(r.props.isEditable?o:i)}),onMouseEnter:Object(q.j)(function(){return r.props.markerOperations.setFocusCommentThreadCid(r.props.commentThreadCid)}),onMouseLeave:Object(q.j)(function(){return r.props.markerOperations.setFocusCommentThreadCid(null)}),onMouseUp:gt,onDoubleClick:gt,onClick:gt},r.isFocused=!1,r.setElementRef=function(e){return r.elementRef=e},r.elementRef=null,r.state=a,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentDidUpdate=function(){var e=this.props,t=e.isFocus,n=e.markerOperations.doFocusAtElement;t&&!this.isFocused&&n(this.elementRef),this.isFocused=t},t.prototype.render=function(){var e=this.props,t=e.offsetLeft,n=e.offsetTop,r=e.isFocus,a=e.isFade,o=e.commentMarkerIndex,i=this.state,c=i.isDragging,s=i.position,l=r?"focus":!r&&a?"fade":"",u=c?s:{left:t+"px",top:n+"px"};return T.a.createElement("div",{className:mt+" "+l,style:u},T.a.createElement("span",ht({ref:this.setElementRef,tabIndex:o},this.markerListenerMap),o))},t}(x.PureComponent);vt.propTypes={commentMarkerIndex:j.a.number,commentThreadCid:j.a.string,offsetLeft:j.a.number,offsetTop:j.a.number,isEditable:j.a.bool,isSelect:j.a.bool,isFocus:j.a.bool,isFade:j.a.bool,markerOperations:j.a.object};var gt=Object(q.j)(),yt={mouseup:gt,mousedown:gt,mousemove:gt,mouseleave:gt,mouseout:gt,click:gt,dblclick:gt},bt=225;var wt=20,Ct=function(e){function t(n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n));return r.addCommentThreadListener=Object(q.j)(function(e){var t=r.props,n=t.getContentElement,a=t.isActive,o=t.currentUserRole,i=t.dispatch;a&&pt(o).create&&Et(e,n().getBoundingClientRect())&&i({type:"entry:comment-threads:add",payload:r.markerOperations.getMarkerPosition(e)})}),r.markerOperations={addContainerEventListener:function(e){for(var t in e)r.props.getContentElement().addEventListener(t,e[t])},removeContainerEventListener:function(e){for(var t in e)r.props.getContentElement().removeEventListener(t,e[t])},setFocusCommentThreadCid:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return r.props.dispatch({type:"container:comment:focus",payload:{focus:e,from:"mask"}})},setSelectCommentThreadCid:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return r.props.dispatch({type:"container:comment:select",payload:{select:e,from:"mask"}})},doUpdateCommentThread:function(e){var t=e.cid,n=e.top,a=e.left;return r.props.dispatch({type:"entry:comment-threads:update",payload:{cid:t,top:n,left:a}})},doFocusAtElement:function(e){return r.props.dispatch({type:"entry:focus-element",payload:{focusType:"external",element:e}})},getMarkerPosition:function(e){var t=r.props.queryCurrentScreenContainerElement().getBoundingClientRect(),n=r.props.getContentElement().getBoundingClientRect();return{left:Object(q.k)(e.clientX,n.left+wt,n.right-wt)-t.left,top:Object(q.k)(e.clientY,n.top+wt,n.bottom-wt)-t.top}}},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentDidUpdate=function(e){var t=this.props,n=t.isActive,r=t.getContentElement;n!==e.isActive&&r()&&(n?r().addEventListener("dblclick",this.addCommentThreadListener):r().removeEventListener("dblclick",this.addCommentThreadListener))},t.prototype.componentWillUnmount=function(){var e=this.props.getContentElement;e()&&e().removeEventListener("dblclick",this.addCommentThreadListener)},t.prototype.render=function(){var e=this;if(!this.props.isActive)return null;var t=this.props,n=t.commentContainer,r=n.select,a=n.focus,o=t.scale,i=t.commentThreadList,c=t.userId,s=t.currentUserRole;return T.a.createElement("div",null,i.map(function(t,n){var i=t.cid,l=t.left,u=t.top,p=t.user_id,d=r===i,f=d||a===i,h=r&&!d||a&&!f;return T.a.createElement(vt,{key:i,commentMarkerIndex:n+1,commentThreadCid:i,offsetLeft:l*o,offsetTop:u*o,isEditable:pt(s,c,p).update,isSelect:d,isFocus:f,isFade:h,markerOperations:e.markerOperations})}))},t}(x.PureComponent);Ct.propTypes={getContentElement:j.a.func.isRequired,scale:j.a.number,queryCurrentScreenContainerElement:j.a.func.isRequired,isActive:j.a.bool,commentContainer:j.a.object,commentThreadList:j.a.array,userId:j.a.number,currentUserRole:j.a.string,dispatch:j.a.func};var Et=function(e,t){var n=t.left,r=t.top,a=t.width,o=t.height;return n<=e.clientX&&r<=e.clientY&&n+a>=e.clientX&&r+o>=e.clientY},St=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ot={focus:null,select:null,from:null};var _t=n("zkrS"),jt=n("Ku8Y"),xt=n.n(jt);function Tt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function Mt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Nt=xt.a["editable-span"],Rt=xt.a["reply-textarea"],It=function(e){function t(n){Tt(this,t);var r=kt(this,e.call(this,n));return r.toggleEditing=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];r.setState({isEditing:e,editingValue:r.props.getValue()}),e&&setTimeout(r.focusTextarea,0)},r.startEditing=function(){return r.toggleEditing(!0)},r.onEditUpdate=function(e){return r.setState({editingValue:e.target.value})},r.onEditKeyPress=function(e){return Pt(e)&&(!r.props.isMultiLine||!e.shiftKey)&&r.onEditFinish()},r.onEditFinish=function(){var e=r.state.editingValue.trim();e!==(r.props.getValue()||"")&&r.props.onValueChange(e),r.props.toggleEdit()},r.focusTextarea=function(){if(r.elementRef){r.elementRef.focus&&r.elementRef.focus();var e=r.elementRef.value.length;r.elementRef.setSelectionRange(e,e)}},r.setElementRef=function(e){r.elementRef=e},r.elementRef=null,r.state={isEditing:n.isEditing,editingValue:""},n.initEditing&&setTimeout(r.startEditing,50),r}return Mt(t,e),t.prototype.render=function(){var e=this.props,t=e.placeholder,n=e.isEditLocked,r=e.getValue,a=e.toggleEdit,o=this.state,i=o.isEditing,c=o.editingValue,s=r()||"",l=xt.a["btn-sure"]+" "+(c.length&&xt.a.active);return n?T.a.createElement("span",{className:Nt+" span"},s):i?T.a.createElement("div",{className:xt.a.container},T.a.createElement("textarea",{ref:this.setElementRef,className:Nt+" textarea",value:c,placeholder:t||"",onChange:this.onEditUpdate,onKeyDown:this.onEditKeyPress}),T.a.createElement("div",{className:xt.a["btn-sort"]},T.a.createElement("button",{className:xt.a["btn-cancel"],onClick:a},_t.a.I18N.preview.comment.cancelEdit),T.a.createElement("button",{className:l,onClick:this.onEditFinish},_t.a.I18N.preview.comment.updateEdit))):T.a.createElement("span",{className:Nt+" span"},s)},t}(x.PureComponent);It.propTypes={onValueChange:j.a.func,getValue:j.a.func,placeholder:j.a.string,isMultiLine:j.a.bool,initEditing:j.a.bool,isEditLocked:j.a.bool,isEditing:j.a.bool,toggleEdit:j.a.func};var Lt=function(e){function t(n){Tt(this,t);var r=kt(this,e.call(this,n));return r.onEditUpdate=function(e){var t=e.target.value,n=r.props.handleActive;t.length?n(!0):n(!1),!r.props.isEditLocked&&r.setState({editingValue:t})},r.onEditKeyPress=function(e){return Pt(e)&&(!r.props.isMultiLine||!e.shiftKey)&&r.onEditFinish(e)},r.onEditFinish=Object(q.j)(function(){var e=r.getEditingValue();e&&r.props.onValueChange(e),r.setState(function(){return{editingValue:""}},function(){r.props.handleActive(!1)}),setTimeout(function(){return r.setState({editingValue:""})})}),r.getEditingValue=function(){return(r.state.editingValue||"").trim()},r.focus=function(){r.setState({disabled:!1}),r.elementRef&&r.elementRef.focus()},r.disabledEdit=function(){return r.setState({disabled:!0})},r.setElementRef=function(e){r.elementRef=e},r.elementRef=null,r.state={editingValue:"",disabled:!1},r}return Mt(t,e),t.prototype.componentDidUpdate=function(){if(this.props.isAutoHeight&&this.elementRef){this.elementRef.style.height="auto";var e=Math.max(this.elementRef.scrollHeight+2,this.elementRef.offsetHeight,this.props.minHeight);this.elementRef.style.height=e+"px"}},t.prototype.render=function(){var e=this.props.placeholder,t=void 0===e?"":e,n=this.state,r=n.editingValue,a=n.disabled;return T.a.createElement("textarea",{disabled:a,ref:this.setElementRef,className:Rt,value:r,placeholder:t,rows:1,onChange:this.onEditUpdate,onKeyDown:this.onEditKeyPress})},t}(x.PureComponent);Lt.propTypes={onValueChange:j.a.func,placeholder:j.a.string,handleActive:j.a.func,isMultiLine:j.a.bool,isEditLocked:j.a.bool,isAutoHeight:j.a.bool,minHeight:j.a.number};var Pt=function(e){return"Enter"===e.key||13===e.which||13===e.keyCode},At=function(e){var t=e.avatar,n=e.width,r=e.height,a=e.name,o=e.index;e.isDot;return T.a.createElement("div",{className:xt.a.avatarInform},T.a.createElement("img",{className:xt.a.avatar,src:t,width:n,height:r}),T.a.createElement("div",{className:xt.a["avatar-slide"]},o&&T.a.createElement("span",{className:xt.a.index},"#"+o+" "),T.a.createElement("span",{className:"name"},a)))};At.propTypes={avatar:j.a.string.isRequired,width:j.a.number,height:j.a.number,name:j.a.string,index:j.a.number,isDot:j.a.bool},At.defaultProps={width:24,height:24};var Dt=n("i6OX"),Bt=(n("XO3k"),n("Lluz")),Ut=n("lVR5"),Ft=n("mquD"),qt=n.n(Ft),Wt=n("UbMB"),zt=n.n(Wt);var Ht=zt.a.bind(qt.a),Vt=function(e){var t=e.onDelete;return T.a.createElement(Ut.d,{content:{hover:I18N.preview.comment.modify_delete},duration:1e3},T.a.createElement(Bt.a,{opener:T.a.createElement(Dt.b,{type:"dora",name:"trash",className:qt.a.modify}),menuList:[I18N.preview.comment.modify_delete],unfold:"right",menuClassName:"comment-delete",arrowed:!0,onSelect:t}))};Vt.propTypes={onDelete:j.a.func.isRequired};var Gt=function(e){var t=e.onSelect;return T.a.createElement(Ut.d,{content:{hover:I18N.preview.setting},duration:1e3},T.a.createElement(Bt.a,{opener:T.a.createElement(Dt.b,{name:"cog",type:"dora",className:qt.a.edit}),menuList:[I18N.preview.comment.modify_edit],unfold:"right",arrowed:!0,menuClassName:"comment-setting",onSelect:t}))};Gt.propTypes={onSelect:j.a.func.isRequired};var Kt=function(e){var t=e.hasUser,n=e.hasSelectCommentThread;return T.a.createElement("div",{className:Ht("content-empty")},T.a.createElement("img",{src:"/images/preview/no-comment@2x.png"}),T.a.createElement("h3",{className:Ht("add-comment")},I18N.preview.comment.add_comment),T.a.createElement("span",null,ut().allowComment?t?_t.a.I18N.preview.comment.thread_none_tip_signin:n?_t.a.I18N.preview.comment.reply_none_tip:_t.a.I18N.preview.comment.thread_none_tip:ut().denyMessage))};Kt.propTypes={hasUser:j.a.bool,hasSelectCommentThread:j.a.bool};var Xt="#8D9EA7",Yt="#5B6B73",Zt=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return n.unMountShow=function(){n.setState({animate:!1})},n.handleAnimateEnd=function(){n.props.isReply||n.setState({show:!1})},n.state={backgroundColor:Xt,disabled:!0,show:!1,animate:!1},n.handleActive=function(e){n.setState({backgroundColor:e?Yt:Xt,disabled:!e})},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillReceiveProps=function(e){var t=this;if(!e.isReply)return this.unMountShow();this.setState({show:!0}),setTimeout(function(){t.setState({animate:!0})},0)},t.prototype.componentDidUpdate=function(e,t){this.props.isReply&&t.show===this.state.show&&rn(this.containerRef)},t.prototype.render=function(){var e=this,t=this.props,n=t.setReplyTextareaRef,r=t.onValueChange,a=t.doReply,o=this.state,i=o.backgroundColor,c=o.disabled,s=o.show,l=o.animate,u=Ht("dropdown-reply",{"dropdown-on":l,"dropdown-off":!l});return s?T.a.createElement("div",{className:u,onTransitionEnd:this.handleAnimateEnd,ref:function(t){return e.containerRef=t}},T.a.createElement(Lt,{ref:n,onValueChange:r,handleActive:this.handleActive,placeholder:_t.a.I18N.preview.comment.comment_placeholder,minHeight:60,isMultiLine:!0,isAutoHeight:!0}),T.a.createElement("button",{onClick:a,style:{backgroundColor:i,cursor:c?"not-allowed":"pointer"},disabled:c},_t.a.I18N.preview.comment.comment_create)):null},t}(x.PureComponent);Zt.propTypes={setReplyTextareaRef:j.a.func.isRequired,onValueChange:j.a.func.isRequired,doReply:j.a.func.isRequired,isReply:j.a.bool.isRequired};var Qt=function(e){var t=e.permission,n=(e.comment,e.isFolded),r=e.setEditableSpanComponent,a=e.onValueChange,o=e.getValue,i=e.isEdit,c=e.toggleEdit;return T.a.createElement("div",{className:Ht("comment-content")+" "+n+" ?'folded' : ''}"},T.a.createElement(It,{ref:r,onValueChange:a,getValue:o,placeholder:_t.a.I18N.preview.comment.comment_placeholder,isEditLocked:!t.update,isEditing:i,toggleEdit:c,isMultiLine:!0}))};Qt.propTypes={permission:j.a.object,comment:j.a.object,isFolded:j.a.bool,isEdit:j.a.bool,setEditableSpanComponent:j.a.func,onValueChange:j.a.func,getValue:j.a.func,toggleEdit:j.a.func,handleActive:j.a.func};var Jt=function(e){var t=e.markIndex,n=e.information,r=e.onSelect,a=e.onDelete,o=e.permission,i=e.ifShowBtn,c=e.className,s=void 0===c?"":c,l=e.showByEnter,u=n.avatar,p=n.name;return T.a.createElement("div",{className:Ht("header-container")+" "+s},T.a.createElement("div",{className:Ht("header-info")},T.a.createElement(At,{avatar:u,name:p,index:t})),(o.update||o.delete)&&i&&l&&T.a.createElement("div",{className:Ht("header-tool")},o.update&&T.a.createElement(Gt,{onSelect:r}),o.delete&&T.a.createElement(Vt,{onDelete:a})))};Jt.propTypes={markIndex:j.a.number,information:j.a.object,permission:j.a.object,onSelect:j.a.func,onDelete:j.a.func,ifShowBtn:j.a.bool,className:j.a.string,showByEnter:j.a.bool};var $t="collaborator",en=function(e,t){return e?"guest"===t.userRole?"not_collaborator":$t:"not_signin"},tn=function(e){var t=e.userId,n=e.currentState,r=e.permission;return en(t,n)===$t&&r.create},nn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:120;return e.length>t},rn=function(e){if(e){var t=e.getBoundingClientRect().bottom+an,n=document.getElementById("comment-thread"),r=n.scrollTop,a=n.scrollHeight;t+r>a?setTimeout(function(){return n.scrollTop=r+an},300):t>on&&(n.scrollTop=r+an)}},an=120,on=window.innerHeight,cn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var sn=zt.a.bind(qt.a),ln=function(e){var t=e.replyList,n=e.commentOperations,r=(e.current,e.currentState),a=e.doCreateComment;return t.map(function(e,t){var o=e.user_id,i=e.cid,c=n.getCollaborator(o),s=c.name,l=c.avatar;return T.a.createElement(un,{key:i,name:s,avatar:l,comment:e,permission:n.getPermission(o),currentState:r,commentOperations:n,doCreateComment:a})})};ln.propTypes={replyList:j.a.array,commentOperations:j.a.object,permission:j.a.object,current:j.a.object,currentState:j.a.object,doCreateComment:j.a.func};var un=function(e){function t(n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n));r.doCreateComment=function(e){r.props.doCreateComment(e,!0),r.state.isReply&&r.toggleReply()},r.getCommentMessage=function(){return r.props.comment&&r.props.comment.message},r.handleSetting=function(e){0===Number(e)&&(r.toggleEditing(),MB.event("二次编辑","运行页"))},r.toggleEditing=function(){r.toggleEditState(),r.editableSpanComponent&&r.editableSpanComponent.toggleEditing(!r.state.isEdit)};var a=n.commentOperations,o=n.comment;return r.editableSpanComponent=null,r.setEditableSpanComponent=function(e){return r.editableSpanComponent=e},r.setReplyTextareaRef=function(e){return r.replyTextareaRef=e},r.doReply=function(e){r.replyTextareaRef&&r.replyTextareaRef.onEditFinish(e)},r.doUpdateComment=function(e){return a.doUpdateComment(cn({},o,{message:e}))},r.doDeleteComment=function(){return a.doDeleteComment(o)},r.toggleReply=function(){return r.setState(function(e){return{isReply:!e.isReply}})},r.toggleFolded=function(){return r.setState(function(e){return{isFolded:!e.isFolded}})},r.toggleEditState=function(){return r.setState(function(e){return{isEdit:!e.isEdit}})},r.state={isReply:!1,isFolded:!1,isEdit:!1,showByEnter:!0},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillReceiveProps=function(e){var t=e.nextComment,n=t&&nn(t.message);n!=this.state.isFolded&&this.setState({isFolded:n})},t.prototype.componentDidUpdate=function(){var e=this.state,t=e.isReply;e.isFolded&&this.replyTextareaRef.focus(),t&&this.replyTextareaRef.focus()},t.prototype.render=function(){var e=this.props,t=e.comment,n=e.name,r=e.avatar,a=e.permission,o=e.currentState,i=t.message,c=t.updated_at,s=t.user_id,l=this.state,u=l.isReply,p=l.isFolded,d=l.isEdit,f=l.showByEnter,h=tn({userId:s,currentState:o,permission:a});return T.a.createElement("div",{className:sn("container-reply")+"  "+(d&&sn("remove-background"))},T.a.createElement(Jt,{onDelete:this.doDeleteComment,onSelect:this.handleSetting,permission:a,information:{avatar:r,name:n},className:sn("reply-header"),ifShowBtn:!d,showByEnter:f}),T.a.createElement("div",{className:sn("container-main")+" "+sn("reply-content")},i&&T.a.createElement(Qt,{permission:a,onValueChange:this.doUpdateComment,getValue:this.getCommentMessage,setEditableSpanComponent:this.setEditableSpanComponent,isEdit:d,toggleEdit:this.toggleEditing,comment:t,isFolded:p})),!this.state.isEdit&&T.a.createElement("div",{className:sn("container-bottom")},T.a.createElement("div",{className:qt.a.time},_t.a.L10N.parseTimeAgo(1e3*c)),h&&T.a.createElement("div",{className:sn("reply-sort"),onClick:this.toggleReply},T.a.createElement(Dt.b,{type:"dora",name:"reply",className:sn("btn-reply")}),u?_t.a.I18N.preview.comment.cancel_reply:_t.a.I18N.preview.comment.comment_create)),T.a.createElement(Zt,{isReply:u,setReplyTextareaRef:this.setReplyTextareaRef,onValueChange:this.doCreateComment,doReply:this.doReply}))},t}(x.PureComponent);un.propTypes={comment:j.a.object,commentOperations:j.a.object,currentState:j.a.object,name:j.a.string,avatar:j.a.string,permission:j.a.object,doCreateComment:j.a.func};var pn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var dn=zt.a.bind(qt.a),fn=function(e){function t(n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n));hn.call(r);var a=r.props,o=a.commentOperations,i=a.commentThreadCid,c=a.commentList[0];return r.setReplyTextareaRef=function(e){return r.replyTextareaRef=e},r.setCommentRef=function(e){return r.commentRef=e},r.doReply=function(e){r.replyTextareaRef&&r.replyTextareaRef.onEditFinish(e)},r.doDeleteThread=function(){return o.doDeleteCommentThread(i)},r.toggleEditing=function(){r.toggleEditState(),r.editableSpanComponent&&r.editableSpanComponent.toggleEditing(!r.state.isEdit)},r.setEditableSpanComponent=function(e){return r.editableSpanComponent=e},r.editableSpanComponent=null,r.toggleFolded=function(){return r.setState(function(e){return{isFolded:!e.isFolded}})},r.toggleReply=function(){return r.setState(function(e){return{isReply:!e.isReply}})},r.toggleEditState=function(){return r.setState(function(e){return{isEdit:!e.isEdit}})},r.toggleRenderMore=function(){return r.setState(function(e){return{renderMore:!e.renderMore}})},r.state={isFolded:c&&nn(c.message)||!1,isReply:!1,renderMore:!1,isEdit:!1,showByEnter:!0},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillReceiveProps=function(e){var t=e.commentList,n=t[0]&&nn(t[0].message);n!=this.state.isFolded&&this.setState({isFolded:n})},t.prototype.componentDidUpdate=function(){var e=this.props,t=e.focusCid===e.commentThreadCid;this.state.isReply&&this.replyTextareaRef.focus(),!this.props.fromComment&&t&&this.commentRef&&this.commentRef.scrollIntoView()},t.prototype.render=function(){var e=this.props,t=e.commentList,n=e.userId,r=e.currentState,a=e.commentThreadCid,o=e.permission,i=e.commentMarkerIndex,c=e.commentOperations,s=e.focusCid,l=e.fromComment,u=this.state,p=u.isReply,d=u.renderMore,f=u.isFolded,h=u.isEdit,m=u.showByEnter,v=s===a,g=t[0]||null,y=g&&c.getCollaborator(g.user_id),b=t.slice(1)||[],w=b.length>2,C=t.length,E=qt.a.comment+" thread-initial entry "+(l?"":null==s?"":dn(v?"comment-focus":"comment-noFocus")),S=tn({userId:n,currentState:r,permission:o});return 0==C?null:T.a.createElement("div",{ref:this.setCommentRef,className:E,onMouseEnter:this.toggleSelect,onMouseLeave:this.cancelSelect},T.a.createElement("div",null,T.a.createElement(Jt,{markIndex:i,onSelect:this.handleSetting,onDelete:this.doDeleteThread,permission:o,information:y,ifShowBtn:!h,showByEnter:m}),T.a.createElement("div",{className:dn("container-main")},g&&T.a.createElement(Qt,{permission:o,comment:g,isFolded:f,isEdit:h,toggleEdit:this.toggleEditing,getValue:this.getCommentMessage,setEditableSpanComponent:this.setEditableSpanComponent,onValueChange:this.doUpdateComment}),!this.state.isEdit&&T.a.createElement("div",{className:""+dn("container-bottom")},g&&T.a.createElement("div",{className:qt.a.time},_t.a.L10N.parseTimeAgo(1e3*g.updated_at)),S&&T.a.createElement("div",{className:dn("reply-sort"),onClick:this.toggleReply},T.a.createElement(Dt.b,{type:"dora",name:"reply",className:dn("btn-reply")}),p?_t.a.I18N.preview.comment.cancel_reply:_t.a.I18N.preview.comment.comment_create)))),T.a.createElement(Zt,{isReply:p,doReply:this.doReply,onValueChange:this.doCreateComment,setReplyTextareaRef:this.setReplyTextareaRef}),w?T.a.createElement(ln,pn({doCreateComment:this.doCreateComment,replyList:b.slice(0,2)},this.props)):T.a.createElement(ln,pn({doCreateComment:this.doCreateComment,replyList:b},this.props)),d&&T.a.createElement(ln,pn({doCreateComment:this.doCreateComment,replyList:b.slice(2)},this.props)),w&&T.a.createElement("div",{className:qt.a.expand,onClick:this.handleRenderMoreComments},d?I18N.preview.comment.fold:I18N.preview.comment.unfold))},t}(x.PureComponent);fn.propTypes={focusCid:j.a.oneOfType([j.a.string,j.a.object]),selectCid:j.a.oneOfType([j.a.string,j.a.object]),permission:j.a.object,fromComment:j.a.bool,commentList:j.a.array,commentMarkerIndex:j.a.number,commentThreadCid:j.a.string,commentOperations:j.a.object,userId:j.a.number,scrollRef:j.a.object,commentThreadList:j.a.array,currentState:j.a.object};var hn=function(){var e=this;this.handleSetting=function(t){0==Number(t)&&(e.toggleEditing(),MB.event("二次编辑","运行页"))},this.toggleSelect=function(){var t=e.props,n=t.selectCid,r=t.commentOperations,a=t.commentThreadCid;n||r.setFocusCommentThreadCid(a)},this.cancelSelect=function(){var t=e.props,n=t.selectCid,r=t.commentOperations;n||e.state.isEdit||r.cancelSelect()},this.doUpdateComment=function(t){var n=e.props,r=n.commentOperations,a=n.commentList[0];a&&r.doUpdateComment(pn({},a,{message:t}))},this.doCreateComment=function(t,n){var r=e.props,a=r.commentThreadCid;r.commentOperations.doCreateComment(t,a),!n&&e.toggleReply()},this.getCommentMessage=function(){return e.props.commentList[0]&&e.props.commentList[0].message},this.handleRenderMoreComments=function(t){t.stopPropagation(),e.toggleRenderMore(),MB.event("展开评论","运行页")}},mn=fn;var vn=zt.a.bind(qt.a),gn=function(e){function t(n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n));r.autoTextareaFocus=function(){return setTimeout(function(){return r.replyTextareaRef&&r.replyTextareaRef.focus()},200)},r.checkIsNewCreateComment=function(){var e=r.props;return!e.commentListMap[e.commentContainer.select]},r.doReply=function(e){r.replyTextareaRef&&r.replyTextareaRef.onEditFinish(e),r.scrollRef&&En(r.scrollRef)},r.doCreateCommentThread=function(e){e&&(r.props.dispatch({type:"entry:comment-threads:add",payload:{top:0,left:0,message:e,cancelSelect:!0}}),En(r.scrollRef))},r.doCreateComment=function(e){r.commentOperations.doCreateComment(e),En(r.scrollRef)},r.renderContentReply=function(e){if(!ut().allowComment)return null;var t=r.checkIsNewCreateComment(),n=r.props,a=n.userId,o=n.currentState,i=r.state,c=i.backgroundColor,s=i.disabled,l=en(a,o);return T.a.createElement("div",{className:vn("content-reply")},l===$t&&T.a.createElement(Lt,{ref:r.setReplyTextareaRef,onValueChange:e&&t?r.doCreateComment:r.doCreateCommentThread,placeholder:_t.a.I18N.preview.comment.comment_placeholder,handleActive:r.handleActive,minHeight:20,isMultiLine:!0,isAutoHeight:!0}),l===$t&&T.a.createElement("button",{onClick:r.doReply,style:{backgroundColor:c,cursor:s?"not-allowed":"pointer"},disabled:s},_t.a.I18N.preview.comment.thread_create),"not_signin"===l&&T.a.createElement("button",{className:qt.a.login,onClick:bn},_t.a.I18N.preview.comment.tip_signin),"not_collaborator"===l&&T.a.createElement("span",null,_t.a.I18N.preview.comment.tip_not_collaborator))};var a=r.props,o=a.currentState.screenCid;return(0,a.dispatch)({type:"unread-comment:set-read",payload:{screenCid:o}}),r.commentOperations={cancelSelect:function(){r.props.dispatch({type:"container:comment:select",payload:{select:null}})},getPermission:function(e){var t=r.commentOperations.getCollaborator(e);return pt(r.props.currentState.userRole,r.props.userId,e,r.props.currentState.teamCid,t)},getCollaborator:function(e){var t=r.props,n=t.collaboratorsState,a=t.currentState,o=a.projectCid,i=a.teamCid;return Sn(n,o,i)[e]||{name:wn,avatar:Cn}},setFocusCommentThreadCid:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return r.props.dispatch({type:"container:comment:focus",payload:{focus:e,from:"comment"}})},toggleSelectCommentThread:function(e){(0,r.props.dispatch)({type:"container:comment:select",payload:{select:e||null}})},doDeleteCommentThread:function(e){r.props.dispatch({type:"entry:comment-threads:delete",payload:{cid:e}})},doDeleteComment:function(e){return r.props.dispatch({type:"comments:delete",payload:e})},doUpdateComment:function(e){return r.props.dispatch({type:"entry:comments:update",payload:e})},doCreateComment:function(e,t){var n=r.props,a=n.selectCommentThread,o=n.dispatch,i=t||a.cid;e&&i&&o({type:"entry:comments:add",payload:{thread_cid:i,message:e}})},renderEmptyCommentList:function(){return T.a.createElement(Kt,{hasUser:"not_signin"===en(r.props.userId,r.props.currentState),hasSelectCommentThread:Boolean(r.props.selectCommentThread)})}},r.setReplyTextareaRef=function(e){r.replyTextareaRef=e},r.setScrollRef=function(e){return r.scrollRef=e},r.replyTextareaRef=null,r.scrollRef=null,r.state={backgroundColor:Xt,disabled:!0},r.handleActive=function(e){r.state.disabled===e&&r.setState({backgroundColor:e?Yt:Xt,disabled:!e})},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillReceiveProps=function(e){var t=e.unreadCommentState.unreadCountScreenMap,n=e.currentState.screenCid,r=e.dispatch;t[n]&&r({type:"unread-comment:set-read",payload:{screenCid:n}})},t.prototype.render=function(){var e=this,t=this.props,n=t.commentThreadList,r=t.commentListMap,a=t.currentScreenName,o=t.commentContainer,i=o.focus,c=o.select,s=o.from,l=t.selectCommentThread,u=t.unreadCommentState.unreadCountThreadMap,p=this.props,d=p.userId,f=p.currentState,h=n.length;return T.a.createElement("div",{className:vn("comment-panel")},h?[T.a.createElement("div",{key:"title",className:vn("comment-title")},a+" ("+h+") "),T.a.createElement("div",{key:"comment",ref:this.setScrollRef,className:vn("comment-thread"),id:"comment-thread"},n.map(function(t,n){var a=t.cid,o=t.user_id,l=r[a]||[],p=u[a]||0,h=e.commentOperations.getPermission(o),m=n+1,v="comment"===s;return T.a.createElement(mn,{key:a,commentThreadCid:a,commentMarkerIndex:m,focusCid:i,selectCid:c,fromComment:v,unreadCount:p,commentOperations:e.commentOperations,userId:d,permission:h,currentState:f,commentList:l,scrollRef:e.scrollRef})}))]:this.commentOperations.renderEmptyCommentList(),this.renderContentReply(l))},t}(x.PureComponent);gn.propTypes={commentContainer:j.a.object,currentState:j.a.object,collaboratorsState:j.a.array,unreadCommentState:j.a.object,commentThreadList:j.a.array,selectCommentThread:j.a.object,commentListMap:j.a.object,currentScreenName:j.a.string,userId:j.a.number,dispatch:j.a.func};var yn=gn,bn=function(){window.location.href="/signin?next="+window.location.pathname},wn="用户已退出协作",Cn="/images/avatar.png",En=function(e){return e&&setTimeout(function(){return e.scrollTop=e.scrollHeight-e.offsetHeight},0)},Sn=Object(q.h)(function(e,t,n){return e.reduce(function(e,r){return r.project_cid!==t&&r.team_cid!==n||(e[r.user_id]=r),e},{})}),On=Object(O.connect)(function(e){var t=e.model,n=t.commentThreads,r=t.screens,a=t.comments,o=t.user,i=t.current,c=t.collaborators,s=t.unreadComment,l=e.container;return{commentContainer:l.comment,currentState:i,collaboratorsState:c,unreadCommentState:s,commentThreadList:_n(n,i.screenCid),selectCommentThread:jn(n,i.screenCid,l.comment.select),commentListMap:xn(a),currentScreenName:Tn(r,i.screenCid),userId:o.id}})(yn),_n=Object(q.h)(function(e,t){return e.filter(function(e){return e.screen_cid===t})}),jn=Object(q.h)(function(e,t,n){return n&&e.find(function(e){return e.cid===n&&e.screen_cid===t})||null}),xn=Object(q.h)(function(e){return e.reduce(function(e,t){return void 0===e[t.thread_cid]?e[t.thread_cid]=[t]:e[t.thread_cid].push(t),e},{})}),Tn=Object(q.h)(function(e,t){return e.find(function(e){return e.cid==t}).name}),kn=Object(O.connect)(function(e){var t=e.model,n=t.current,r=t.user,a=t.commentThreads,o=e.container;return{queryCurrentScreenContainerElement:Mn(n.screenCid),scale:o.common.scale/100,isActive:"comment"==o.previewSetting.toolbarActiveItem,commentContainer:o.comment,commentThreadList:_n(a,n.screenCid),currentUserRole:n.userRole,userId:r.id}})(Ct),Mn=Object(q.h)(function(e){return function(){return document.querySelector("#pscreen"+e+" .scontainer")}}),Nn=n("6ZRU"),Rn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},In={isSpaceDown:!1},Ln={offset:{x:0,y:0},scale:100,keyFlags:In};var Pn={alert:Nn.a.reducers,common:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ln,t=arguments[1],n=t.type,r=t.payload;switch(n){case"preview:set:canvas:offset":return Rn({},e,{offset:r.offset});case"preview:set:scale":return Rn({},e,{scale:r.scale});case"preview:set:key:flags":return Rn({},e,{keyFlags:Rn({},In,r)});case"preview:reset:key:flags":return Rn({},e,{keyFlags:In});default:return e}},comment:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ot,t=arguments[1],n=t.type,r=t.payload;switch(n){case"container:comment:focus":return St({},e,{focus:r.focus,from:r.from});case"container:comment:select":return St({},e,{focus:r.select&&e.focus,select:r.select,from:r.from})}return e},layers:Ze,slices:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ot,t=arguments[1],n=t.type,r=t.payload;switch(n){case"reducer:slice:success":return at({},e,r,{loading:!1});case"reducer:slice:fail":return at({},e,r,{error:!0});default:return e}},screens:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je,t=arguments[1],n=t.type,r=t.payload;switch(n){case"reducer:preview-panel:search":return Qe({},e,r);case"reducer:preview-panel:reset":return Je;default:return e}},artboards:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rt,t=arguments[1],n=t.type,r=t.payload;switch(n){case"reducer:artboards:success":return nt({},e,r);case"reducer:artboards:fail":return nt({},e,r,{error:!0});default:return e}},previewSetting:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tt,t=arguments[1],n=t.type,r=t.payload;switch(n){case"reducer:preview-toolbar:sub-bar:active":case"reducer:preview-toolbar:update":return et({},e,r);case"reducer:preview-toolbar:active-item:init":return et({},e,{toolbarActiveItem:$e.c});default:return e}}},An=n("foKU"),Dn=n("An9T"),Bn=n.n(Dn);var Un=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.render=function(){var e=this.props,t=(e.project,e.shellType),n=function(e,t,n){switch(e){case"device":var r=MB.currentProject,a=r.deviceShell()||r.defaultShell();if(!a.bg)return null;var o=n?a.bg+"_land":a.bg,i=n?[-a.left,-a.top,a.height,a.width]:[-a.top,-a.left,a.width,a.height],c=i[0],s=i[1],l=i[2],u=i[3],p=MB.isOffline();return{top:c,left:s,width:l,height:u,backgroundImage:"url("+(p?".":"")+"/images/devices/"+o+".png)"};case"default":case"none":return null}}(t,0,e.isLandscape),r="device"===t&&null===n?"none":t;return T.a.createElement("div",{className:Bn.a.shell+" "+r,style:n})},t}(x.PureComponent),Fn=Un;Un.propTypes={project:j.a.object,shellType:j.a.string,isLandscape:j.a.bool};var qn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.render=function(){var e=this.props,t=e.project,n=e.screen,r=e.isLite,a=e.isImmersive,o=e.viewportWidth,i=e.viewportHeight,c=t.splash,s=void 0===c?"":c,l=t.device,u=void 0===l?"":l,p=function(e,t,n,r,a){var o=void 0;if(r){var i=Math.min(n.width,n.height),c=Math.max(n.width,n.height),s=Math.min(t.width,t.height),l=Math.max(t.width,t.height),u=e.width!==s,p=u!==n.width>n.height,d=void 0;u?(d=c/l,o={width:l,height:Math.min(s,i/d),transform:(p?"translate(-100%) rotate(-90deg)":"")+" scale("+d+")",transformOrigin:p?"top right":"top left"}):(d=i/s,o={width:s,height:Math.min(l,c/d),transform:(p?"translate(-100%) rotate(-90deg)":"")+" scale("+d+")",transformOrigin:p?"top right":"top left"})}else if(a)o={width:e.width,height:e.height};else{var f="landscape"===e.orientation,h=t.width,m=t.height,v=f?[m,h]:[h,m];o={width:v[0],height:v[1]}}return o}(n,t,{width:o,height:i},r,a),d=n.orientation+" "+t.device+" "+t.model;return T.a.createElement("div",{id:"simulator",className:d,style:p},T.a.createElement("div",{id:"app",className:"screens"},T.a.createElement("div",{id:"gs"}),T.a.createElement("div",{id:"gh",className:"fixed "+u}),T.a.createElement("div",{id:"gf",className:"fixed"})),T.a.createElement("div",{className:"splash"},s&&T.a.createElement("img",{src:s}),T.a.createElement("div",{className:"loading"},T.a.createElement("div",{className:"spinner"}))))},t}(x.PureComponent),Wn=qn;qn.propTypes={screen:j.a.object,project:j.a.object,isLite:j.a.bool,isImmersive:j.a.bool,viewportWidth:j.a.number,viewportHeight:j.a.number,dispatch:j.a.func};var zn=Object(O.connect)(function(e){var t=e.model,n=t.current,r=t.projects,a=t.screens,o=e.container.previewSetting.toolbarActiveItem,i=Hn(r,n.projectCid),c=Vn(a,n.screenCid),s=o==$e.b,l=o==$e.a,u=s||l||"none"===i._shell_type,p=MB.isMobile(),d=MB.isEmbedded(),f=p||d,h=d&&"landscape"===Project.find(i.cid).homeScreen().orientation?[i.height,i.width]:[i.width,i.height],m=d?h:[window.innerWidth,window.innerHeight];return{screen:c,project:i,isLite:f,isImmersive:u,viewportWidth:m[0],viewportHeight:m[1]}})(Wn),Hn=Object(q.h)(function(e,t){return e.find(function(e){return e.cid===t})}),Vn=Object(q.h)(function(e,t){return e.find(function(e){return e.cid===t})});n("v8PR");var Gn=10,Kn="hidden",Xn="#fff",Yn=function(e){function t(n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n));Zn.call(r);var a=r.props.scale;return r.iamgeContainerRef=function(e){return r.image=e},r.getImageCanvasRef=function(e){return r.imageCanvas=e},r.glassCanvasRef=function(e){return r.glassCanvas=e},r.finallyScale=Gn*(a<1?1:a),r.state={visibility:Kn,glassLeft:0,glassTop:0,color:Xn,R:0,G:0,B:0},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentDidMount=function(){ar&&(this.image.crossOrigin="Anonymous"),this.imageCtx=this.imageCanvas.getContext("2d"),this.glassCtx=this.glassCanvas.getContext("2d")},t.prototype.componentDidCatch=function(e){console.log(e),this.cancelPickerMode()},t.prototype.componentDidUpdate=function(){if(this.imageCanvas){var e=this.imageCanvas.getBoundingClientRect(),t=e.width,n=e.height,r=this.lastCanvasRect||{width:0,height:0},a=r.width,o=r.height;a==t&&o==n||(this.clearGlassRect(),this.renderImageCanvas())}else this.handleError()},t.prototype.render=function(){var e=this.props,t=e.width,n=e.height,r=e.glassWidth,a=e.glassHeight,o=e.src,i=this.state,c=i.visibility,s=i.glassLeft,l=i.glassTop,u=i.color,p=i.R,d=i.G,f=i.B;return T.a.createElement("div",{className:"mb-picker-container"},T.a.createElement("img",{ref:this.iamgeContainerRef,className:"mb-picker-image",width:t,height:n,src:o,onLoad:this.handleLoad,onError:this.handleError}),T.a.createElement("canvas",{ref:this.getImageCanvasRef,onMouseMove:this.handleMove,onMouseLeave:this.handleMouseLeave,onClick:this.handleClick,style:{width:t,height:n,opacity:0}}),T.a.createElement("div",{className:"mb-glass",style:{width:r,height:a,visibility:c,left:s,top:l}},T.a.createElement("div",{className:"shadow"}),T.a.createElement("canvas",{ref:this.glassCanvasRef,width:r,height:a,style:{width:r,height:a}}),T.a.createElement("div",{style:{top:a/2+15},className:"mb-glass-text"},T.a.createElement("div",{className:"mb-rgba-color"},"R:"+p+" G:"+d+" B:"+f+" "+String($n(u).hex).toUpperCase()))),T.a.createElement(M.a,{onKeyDown:this.handleKeyDown,onClick:this.cancelColorPicker}))},t}(x.PureComponent);Yn.propTypes={src:j.a.string,width:j.a.oneOfType([j.a.string,j.a.number]),height:j.a.oneOfType([j.a.string,j.a.number]),glassHeight:j.a.number,glassWidth:j.a.number,scale:j.a.number,dispatch:j.a.func},Yn.defaultProps={src:"/sec3.png",width:1300,height:769,glassWidth:200,glassHeight:200,scale:1,pickColor:function(e){return console.log(e)}};var Zn=function(){var e=this;this.cancelColorPicker=function(t){e.imageCanvas.contains(t.target)||e.cancelPickerMode()},this.cancelPickerMode=function(){return e.props.dispatch({type:"reducer:preview-toolbar:update",payload:{isShowColorPicker:!1}})},this.renderImageCanvas=function(){var t=e.imageCanvas.getBoundingClientRect(),n=t.width,r=t.height;e.lastCanvasRect={width:n,height:r},e.imageCanvas.width=n,e.imageCanvas.height=r,e.imageCtx.drawImage(e.image,0,0,n,r)},this.calculateCenterPoint=function(t){var n=e.image.getBoundingClientRect(),r=n.left,a=n.top;e.centerPoint={centerX:Math.floor(t.clientX-r),centerY:Math.floor(t.clientY-a)}},this.handleMove=function(t){e.image.complete&&e.state.visibility===Kn&&e.setState({visibility:"visible"}),e.calculateCenterPoint(t);var n=e.props,r=n.glassHeight,a=n.glassWidth,o=n.scale,i=e.centerPoint,c=i.centerX,s=i.centerY,l=Math.floor(c-a/2),u=Math.floor(s-r/2);e.setState({glassLeft:l,glassTop:u}),s<0&&e.clearGlassRect(),e.glassCtx.clearRect(0,0,a,r),o<1&&console.warn("Can't make the galss scale less than 1, It will make bed invision"),tr(e.glassCtx,!1),e.glassCtx.drawImage(e.imageCanvas,Math.floor(c-a/2/e.finallyScale),Math.floor(s-r/2/e.finallyScale),Math.floor(a/e.finallyScale),Math.floor(r/e.finallyScale),-Gn/2,-Gn/2,a,r),er(e.glassCtx,"lightgray",Gn,Gn),nr(e.glassCtx),rr(e.glassCtx,"black",Math.floor((a-Gn)/2),Math.floor((r-Gn)/2),Gn,Gn),e.getColor()},this.getColor=function(){var t=e.centerPoint,n=t.centerX,r=t.centerY,a=e.imageCtx.getImageData(n,r,1,1).data,o=Jn(a),i=o.rgba,c=o.R,s=o.G,l=o.B;e.setState({color:i,R:c,G:s,B:l}),e.color=i},this.handleClick=function(){e.getColor();var t=e.color,n=Object(q.n)(t),r=n.history,a=n.focusColor;clearTimeout(e.timeoutToken),e.props.dispatch({type:"reducer:preview-toolbar:update",payload:{userPickColor:r,focusColor:a}}),e.timeoutToken=setTimeout(function(){e.props.dispatch({type:"reducer:preview-toolbar:update",payload:{userPickColor:r,focusColor:null}})},1e3)},this.clearGlassRect=function(){var t=e.props,n=t.glassHeight,r=t.glassWidth;e.glassCtx.clearRect(0,0,r,n),e.setState({visibility:Kn})},this.handleMouseLeave=function(){e.clearGlassRect()},this.handleKeyDown=function(t){"escape"===t.key.toLowerCase()&&(e.clearGlassRect(),e.cancelPickerMode())},this.handleLoad=function(){e.renderImageCanvas()},this.handleError=function(){e.cancelPickerMode()}},Qn=Yn,Jn=function(e){return e[3]=parseFloat(e[3]/255),{rgba:"rgba("+e.join(", ")+")",R:e[0],G:e[1],B:e[2]}},$n=function(e){var t=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+(\.\d)?)[\s+]?/i);return t&&t.length>=4?{hex:"#"+("0"+parseInt(t[1],10).toString(16)).slice(-2)+("0"+parseInt(t[2],10).toString(16)).slice(-2)+("0"+parseInt(t[3],10).toString(16)).slice(-2),o:+t[4]}:e},er=function(e,t,n,r){e.strokeStyle=t,e.lineWidth=.5;for(var a=n+5.5;a<e.canvas.width-n;a+=n)e.beginPath(),e.moveTo(a,0),e.lineTo(a,e.canvas.height),e.stroke();for(var o=r+5.5;o<e.canvas.height-n;o+=r)e.beginPath(),e.moveTo(0,o),e.lineTo(e.canvas.width,o),e.stroke()},tr=function(e,t){e.mozImageSmoothingEnabled=t,e.webkitImageSmoothingEnabled=t,e.msImageSmoothingEnabled=t,e.imageSmoothingEnabled=t},nr=function(e){e.beginPath(),e.strokeStyle="#8D9EA7",e.lineWidth=8,e.arc(100,100,96,0,2*Math.PI),e.stroke(),e.strokeStyle="#D4D7DC",e.lineWidth=5,e.arc(100,100,96,0,2*Math.PI),e.stroke()},rr=function(e,t,n,r,a,o){e.beginPath(),n+=.5,r+=.5,e.strokeStyle=t,e.lineWidth=1,e.moveTo(n,r),e.lineTo(n+a,r),e.lineTo(n+a,r+o),e.lineTo(n,r+o),e.lineTo(n,r),e.stroke(),e.beginPath(),e.lineWidth=1,e.strokeStyle="white",e.moveTo(n-1,r-1),e.lineTo(n+a+1,r-1),e.lineTo(n+a+1,r+1+o),e.lineTo(n-1,r+o+1),e.lineTo(n-1,r-1),e.stroke()},ar=!1,or=Object(q.h)(function(e,t){return e.find(function(e){return e.cid===t})}),ir=Object(O.connect)(function(e){var t=e.model,n=t.current,r=t.projects,a=or(r,n.projectCid);return{scale:1,width:"100%",height:"100%",src:cr(a.access_token,n.screenCid)+"&"+Date.now()}})(Qn),cr=function(e,t){return"/snapshot.png?access-token="+e+"&screen-cid="+t+"&mode=zoom-1.00"};n("dAiO");var sr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.render=function(){return T.a.createElement("div",{id:"sticky-container"},T.a.createElement("div",{id:"stickies"}))},t}(x.PureComponent),lr=sr;sr.propTypes={scale:j.a.number};n("fSKh");var ur=function(e){function t(n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n));return r.getContentElementRef=function(){return document.querySelector("#simulator-container")},r.handleKeyDown=function(e){var t=e.target.matches("input")||e.target.matches("textarea");32===e.keyCode&&!t&&(e.preventDefault(),r.props.dispatch({type:"preview:set:key:flags",payload:{isSpaceDown:!0}}))},r.handleKeyUp=function(e){r.props.dispatch({type:"preview:reset:key:flags"})},r.handleMouseDown=function(e){r.props.isSpaceDown&&r.handleDrag(e)},r.handleDrag=function(e){var t=e.clientX,n=e.clientY,a=r.props.canvasOffset,o=a.x,i=a.y,c=function(e){var a={x:o+(e.clientX-t),y:i+(e.clientY-n)};r.props.dispatch({type:"preview:set:canvas:offset",payload:{offset:a}})};document.addEventListener("mousemove",c),document.addEventListener("mouseup",function e(t){document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",e)})},r.handleScaleChange=function(e){r.props.dispatch({type:"preview:set:scale",payload:{scale:e}})},r.handleOffsetChange=function(e,t){r.props.dispatch({type:"preview:set:canvas:offset",payload:{offset:{x:e,y:t}}})},n.dispatch({type:"reducer:artboards:init"}),n.dispatch({type:"entry:init:preview:scale"}),n.dispatch({type:"preview:set:canvas:offset",payload:{offset:{x:0,y:0}}}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.scale,r=t.canvasOffset,a=t.project,o=t.screen,i=t.isSpaceDown,c=t.isLayerActive,s=t.isCommentActive,l=t.isColorPickerActive,u=r.x,p=r.y,d="landscape"===o.orientation,f=c||s,h=f?"none":a._shell_type,m=a.width,v=a.height,g=d?[v,m]:[m,v],y={width:g[0],height:g[1],transform:"matrix(1, 0, 0, 1, "+u+", "+p+")"},b={transform:"scale("+n/100+")"},w={width:n+"%",height:n+"%"},C={width:o.width*n/100,height:o.height*n/100},E=R()({"wait-drag":i,"is-immersive":f,"is-layer-active":c});return T.a.createElement(An.a,{x:u,y:p,scale:n,id:"simulator-container",className:E,onMouseDown:this.handleMouseDown,onScaleChange:this.handleScaleChange,onOffsetChange:this.handleOffsetChange},function(t,n,r){return T.a.createElement("div",{key:"1",className:"screen-viewport",style:y},T.a.createElement("div",{className:"zoom-area",style:b},T.a.createElement(zn,null),!f&&T.a.createElement(Fn,{project:a,shellType:h,isLandscape:d}),T.a.createElement(lr,null)),T.a.createElement("div",{className:"no-zoom-area-wrapper",style:w},T.a.createElement("div",{className:"no-zoom-area",style:C},T.a.createElement("div",{id:"ui-layers",className:"ui-layers "+(c?"is-active":"")},l&&T.a.createElement(ir,null),c&&!l&&T.a.createElement(me,null)),T.a.createElement("div",{id:"ui-comment-marker-panel"},T.a.createElement(kn,{getContentElement:e.getContentElementRef})))))},T.a.createElement(M.a,{onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp}))},t}(x.PureComponent),pr=ur;ur.propTypes={scale:j.a.number,canvasOffset:j.a.object,screen:j.a.object,project:j.a.object,isSpaceDown:j.a.bool,isLayerActive:j.a.bool,isCommentActive:j.a.bool,isColorPickerActive:j.a.bool,dispatch:j.a.func};var dr=Object(O.connect)(function(e){var t=e.model,n=t.current,r=t.projects,a=t.screens,o=e.container,i=o.common,c=i.scale,s=i.offset,l=i.keyFlags.isSpaceDown,u=o.previewSetting,p=u.toolbarActiveItem,d=u.isShowColorPicker,f=fr(r,n.projectCid),h=n.screenCid;return{scale:c,canvasOffset:s,screen:hr(a,h),project:f,isSpaceDown:l,isLayerActive:"inspect"==p,isCommentActive:"comment"==p,isColorPickerActive:d}})(pr),fr=Object(q.h)(function(e,t){return e.find(function(e){return e.cid===t})}),hr=Object(q.h)(function(e,t){return e.find(function(e){return e.cid===t})}),mr=n("6hLF"),vr=n("Q+Vi"),gr=(n("WcC0"),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e});var yr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.menuClassName,r=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["className","menuClassName"]);return T.a.createElement(mr.i,gr({className:Object(vr.g)(["ToolbarSelect",t]),menuClassName:Object(vr.g)(["ToolbarSelectMenu",n])},r,{unstyled:!0}))},t}(x.PureComponent);yr.propTypes={className:j.a.string,menuClassName:j.a.string};var br=yr,wr=n("a1Ia"),Cr=n.n(wr),Er=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var Sr=zt.a.bind(Cr.a),Or=function(e){function t(n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n));return r.updateSubToolbar=function(e){r.props.dispatch({type:"reducer:preview-toolbar:update",payload:Er({},e)})},r.pickColor=function(e){e.nativeEvent.stopImmediatePropagation(),MB.event("在标注模式中使用了自定义取色","运行页"),r.updateSubToolbar({isShowColorPicker:!0,showLayerList:!1,isSelectLayer:!1})},r.updateDeviceUnit=function(e){var t=e.value,n=r.props.emPixel,a=Br(t,n);r.updateSubToolbar(a?{unit:t,ratio:a}:{unit:t}),MB.event("在"+t+"下切换倍率为"+a,"运行页")},r.updateLanguage=function(e){var t=e.value;MB.event("代码切换"+t,"运行页"),r.updateSubToolbar({language:t})},r.updateColorUnit=function(e){var t=e.value;r.updateSubToolbar({colorUnit:t})},r.updateEmPixel=function(e){var t=e.value;r.updateSubToolbar({emPixel:t,ratio:t}),r.setState({customEmPixel:""});var n=r.props.unit;MB.event("在"+n+"下切换倍率为"+t,"运行页")},r.onTypingEmPixel=function(e){if(e){r.setState({customEmPixel:e}),r.updateSubToolbar({emPixel:e,ratio:e});var t=r.props.unit;MB.event("在"+t+"在设置自定义倍率"+e,"运行页")}},r.handleMobileChange=function(e){var t=e.idx,n=r.props.unit,a=Rr(t,n);r.updateSubToolbar({ratio:a}),MB.event("在"+n+"下切换倍率为"+a,"运行页")},r.state={showLogin:!1,customEmPixel:""},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillReceiveProps=function(e){var t=e.unit;this.props.unit!==t&&t===jr&&this.updateSubToolbar({ratio:1})},t.prototype.render=function(){var e=this.props,t=e.unit,n=e.emPixel,r=e.ratio,a=e.language,o=e.isShowColorPicker,i=e.colorUnit,c=e.isLogin,s=this.state.customEmPixel,l=t===Tr||t===xr,u=t===jr,p=t===Tr?Dr:Pr,d=[{value:10,label:"10px"},{value:12,label:"12px"},{value:14,label:"14px"},{value:16,label:"16px"},{value:n,label:n+"px"},T.a.createElement("div",{onClick:function(e){return e.stopPropagation()}},T.a.createElement(mr.g,{size:"small",min:1,max:99,precision:0,value:s,placeholder:I18N.custom,onChange:this.onTypingEmPixel}))];return T.a.createElement("div",{className:Sr("sub-toolbar","preview-sub-toolbar")},T.a.createElement("div",{className:"mode"},T.a.createElement(Dt.b,{name:"cursor",type:"dora",className:Object(vr.g)(["cursor",!o&&"is-active"])}),T.a.createElement(Ut.d,{arrowed:!0,position:"bottom",duration:1500,className:Object(vr.g)(["picker",o&&"is-active"]),tipClassName:"marign-top-20",content:{click:c?null:I18N.preview.guide_login,hover:I18N.preview.color_picker}},T.a.createElement(Dt.b,{name:"tube",type:"dora",onClick:this.pickColor}))),T.a.createElement("div",{className:"param"},T.a.createElement(br,{className:"color-unit",menuClassName:"PreviewSubToolbarSelectMenu",size:"small",unstyled:!0,shouldMenuAlignCenter:!0,placeholder:" ",value:i,optionList:Nr,onChange:this.updateColorUnit}),T.a.createElement(br,{menuClassName:"PreviewSubToolbarSelectMenu",size:"small",unstyled:!0,shouldMenuAlignCenter:!0,placeholder:" ",optionList:Mr,value:a,onChange:this.updateLanguage}),T.a.createElement(br,{className:"device-unit",menuClassName:"PreviewSubToolbarSelectMenu",size:"small",unstyled:!0,shouldMenuAlignCenter:!0,placeholder:" ",optionList:kr,value:t,onChange:this.updateDeviceUnit}),l?T.a.createElement(br,{menuClassName:"PreviewSubToolbarSelectMenu",size:"small",unstyled:!0,shouldMenuAlignCenter:!0,placeholder:" ",optionList:p,currentOptionIdx:Ir({unit:t,ratio:r}),onChange:this.handleMobileChange}):u?T.a.createElement("span",{className:"px-ratio"},"@1x"):T.a.createElement(br,{className:"em-pixel",menuClassName:"PreviewSubToolbarSelectMenu scale-select-menu",size:"small",unstyled:!0,shouldMenuAlignCenter:!0,placeholder:" ",optionList:d,value:n,onChange:this.updateEmPixel})))},t}(x.PureComponent);Or.propTypes={unit:j.a.string,language:j.a.string,ratio:j.a.number,colorUnit:j.a.string,isShowColorPicker:j.a.bool,emPixel:j.a.number,isLogin:j.a.bool,dispatch:j.a.func};var _r=Or,jr="px",xr="pt",Tr="dp",kr=[jr,"em","rem",Tr,xr],Mr=[{value:"swift",label:"Swift"},{value:"android",label:"Android"},{value:"css",label:"CSS"},{value:"less",label:"Less"},{value:"sass",label:"Sass"},{value:"stylus",label:"Stylus"}],Nr=[{value:"hex",label:"Hex"},{value:"rgb",label:"RGB"},{value:"rgba",label:"RGBA"},{value:"argb",label:"ARGB"}],Rr=function(e,t){return t===Tr?Ar[e]:Lr[e]},Ir=function(e){var t=e.unit,n=e.ratio;switch(t){case Tr:return Math.max(Ar.indexOf(n),1);case xr:return Math.max(Lr.indexOf(n),0);default:return 0}},Lr=[1,2,3],Pr=Lr.map(function(e){return"@"+e+"x"}),Ar=[.75,1,1.5,2,3,4],Dr=Ar.map(function(e){return"@"+e+"x"}),Br=function(e,t){return"em"===e||"rem"===e?t:1},Ur=Object(O.connect)(function(e){var t=e.model.user,n=e.container.previewSetting;return{isLogin:Boolean(t.id),unit:n.unit,emPixel:n.emPixel,ratio:n.ratio,language:n.language,isShowColorPicker:n.isShowColorPicker,colorUnit:n.colorUnit}})(_r),Fr=n("DqDi"),qr=n("Lyer"),Wr=n("EDI8"),zr=n.n(Wr);var Hr=zt.a.bind(zr.a),Vr=MB.config.SCALES,Gr=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return n.handleZoomIn=function(){var e=n.props,t=e.scale,r=e.dispatch,a=Vr.findIndex(function(e){return e>t});r({type:"preview:set:scale",payload:{scale:Vr[a]||Vr[Vr.length-1]}})},n.handleZoomOut=function(){var e=n.props,t=e.scale,r=e.dispatch,a=Vr.findIndex(function(e){return e>=t});r({type:"preview:set:scale",payload:{scale:Vr[a-1]||Vr[0]}})},n.handleKeyDown=function(e){Xr(e,n.handleZoomIn,n.handleZoomOut)},n.state={isGuideShow:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentDidMount=function(){var e=this;this.openGuideTimer=setTimeout(function(){e.setState({isGuideShow:!0})},600)},t.prototype.componentWillUnmout=function(){clearTimeout(this.openGuideTimer)},t.prototype.render=function(){var e=this.props,t=e.scale,n=e.project,r=this.state.isGuideShow,a=t<400,o=t>20;return T.a.createElement(qr.a,{id:"preview-zoom",localeKey:"zoom",unfold:"right",isOpen:r,gotItBtn:!0,noCloseBtn:!0},T.a.createElement("div",{className:Hr("zoom-count","preview-zoom-btn",{template:n.template})},T.a.createElement("a",{id:"zoomout",disabled:!o,title:I18N.zoomout,onClick:this.handleZoomOut,className:"fs-16"},T.a.createElement(Dt.b,{type:"dora",name:"minus_fc"})),T.a.createElement("span",null,Math.round(t)+"%"),T.a.createElement("a",{id:"zoomin",disabled:!a,title:I18N.zoomin,onClick:this.handleZoomIn,className:"fs-16"},T.a.createElement(Dt.b,{type:"dora",name:"plus_fc"})),T.a.createElement(M.a,{onKeyDown:this.handleKeyDown})))},t}(x.PureComponent);Gr.propTypes={scale:j.a.number,project:j.a.object,dispatch:j.a.func};var Kr=Gr,Xr=function(e,t,n){(e.ctrlKey||e.metaKey)&&(187==e.keyCode&&(e.preventDefault(),t()),189==e.keyCode&&(e.preventDefault(),n()))},Yr=n("S8MF");var Zr=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return n.handleShare=function(){n.setState({isSharingModalOpen:!0}),MB.event("点击了分享按钮","运行页")},n.onCloseSharingModal=function(){return n.setState({isSharingModalOpen:!1})},n.state={isSharingModalOpen:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.render=function(){var e=this.props.dispatch,t=this.state.isSharingModalOpen;return T.a.createElement(Ut.d,{position:"bottom",duration:1e3,content:{hover:I18N.preview.share},tipClassName:"marign-top-20"},T.a.createElement(Dt.b,{type:"dora",name:"share",className:"share-icon",onClick:this.handleShare}),T.a.createElement(Yr.a,{dispatch:e,isOpen:t,onClose:this.onCloseSharingModal,app:MB.project()}))},t}(x.PureComponent),Qr=Zr;Zr.propTypes={dispatch:j.a.func};var Jr=n("gX9a"),$r=n.n(Jr),ea=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function ta(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function na(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function ra(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var aa=zt.a.bind($r.a),oa=[{value:"device",label:I18N.device_shell},{value:"default",label:I18N.default_shell},{value:"none",label:I18N.none_shell}],ia=function(e){function t(){var n,r;ta(this,t);for(var a=arguments.length,o=Array(a),i=0;i<a;i++)o[i]=arguments[i];return n=r=na(this,e.call.apply(e,[this].concat(o))),r.handleSelectChange=function(e){var t=e.value;r.props.dispatch({type:"projects:update-local",payload:ea({},r.props.project,{_shell_type:t})}),MB.currentProject._shell_type=t,MB.runner.reload(!0)},r.handleCheckChange=function(e,t,n){r.props.dispatch({type:"projects:update-local",payload:ea({},r.props.project,{_highlight:n})}),MB.currentProject._highlight=n},na(r,n)}return ra(t,e),t.prototype.render=function(){var e=this.props,t=e.project,n=e.disabled,r=!!t._highlight,a=T.a.createElement(Ut.d,{position:"bottom",tipClassName:"marign-top-20",duration:1e3,content:{hover:n?null:I18N.preview.setting}},T.a.createElement(Dt.b,{name:"cog",type:"dora"}));return T.a.createElement(Bt.a,{disabled:n,menuClassName:aa("play-setting-menu"),opener:a,menu:T.a.createElement(ca,{onSelect:this.handleSelectChange,value:t._shell_type,onCheck:this.handleCheckChange,isChecked:r})})},t}(x.PureComponent);ia.propTypes={project:j.a.object,disabled:j.a.bool,dispatch:j.a.func};var ca=function(e){function t(){return ta(this,t),na(this,e.apply(this,arguments))}return ra(t,e),t.prototype.render=function(){var e=this.props,t=e.onSelect,n=e.onCheck,r=e.value,a=e.isChecked;return T.a.createElement("div",null,T.a.createElement(br,{size:"small",optionList:oa,value:r,onChange:t}),T.a.createElement("hr",null),T.a.createElement(mr.a,{label:I18N.highlight_clickable,size:"small",onChange:n,isChecked:a}))},t}(x.PureComponent);ca.propTypes={onSelect:j.a.func.isRequired,onCheck:j.a.func.isRequired,value:j.a.string,isChecked:j.a.bool.isRequired};var sa=ia,la=n("rtgd"),ua=n.n(la);var pa=function(e){function t(n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n));return r.handleTabChange=function(e){var t=r.props.dispatch,n=$e.d[e];t({type:"entry:preview:select",payload:{toolbarActiveItem:$e.d[e]}}),MB.event(""+q.a[n],"运行页")},n.dispatch({type:"reducer:preview-toolbar:active-item:init"}),ba()&&r.props.dispatch({type:"entry:preview:select",payload:{toolbarActiveItem:$e.b}}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillReceiveProps=function(e){var t=e.toolbarActiveItem,n=e.loadSliceUrl;t!=this.props.toolbarActiveItem&&this.props.dispatch({type:"reducer:preview-toolbar:update",payload:{isShowColorPicker:!1,isSelectLayer:!1}}),n!=this.props.loadSliceUrl&&ya(n)},t.prototype.render=function(){var e=this.props,t=e.scale,n=e.project,r=e.dispatch,a=e.toolbarActiveItem,o=e.existUnreadComment,i=$e.d.indexOf(a)||0,c=a!=$e.c,s=n.name||"",l=!va(),u=!MB.isOffline(),p=u?$e.e:$e.f,d=u&&o,f=T.a.createElement(Kr,{scale:t,project:n,dispatch:r});return n.template?f:T.a.createElement("header",{className:ua.a["preview-toolbar"]},T.a.createElement("div",{className:"toolbar-left"},!l&&T.a.createElement("a",{title:I18N.back,onClick:ma},T.a.createElement(Dt.b,{name:"back_fc",type:"dora",className:"fs-16"})),T.a.createElement("span",{className:"project-name",title:s},s)),T.a.createElement("div",{className:"toolbar-main"},f,T.a.createElement("div",{className:"toolbar-main-wrapper"},T.a.createElement(Fr.b,{tabs:p,activeIndex:i,onChange:this.handleTabChange,className:"preview-toolbar-nav",hideBorder:!0}),d&&T.a.createElement("span",{className:"unread"}))),T.a.createElement("div",{className:"toolbar-right"},T.a.createElement(sa,{dispatch:r,project:n,disabled:c}),T.a.createElement("span",{className:"line"}),T.a.createElement(Qr,{dispatch:r})))},t}(x.PureComponent);pa.propTypes={scale:j.a.number,project:j.a.object,toolbarActiveItem:j.a.string,existUnreadComment:j.a.bool,loadSliceUrl:j.a.string,dispatch:j.a.func};var da,fa,ha=pa,ma=function(){va()&&MB.designer.backDesign()},va=function(){return!MB.f.inSharing&&"file:"!==window.location.protocol},ga=function(e){return Object(a.a)(e,null,{method:"POST"})},ya=(da=regeneratorRuntime.mark(function e(t){var n,r,a,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=!0,r=void 0,a=1;case 3:if(!n){e.next=17;break}return e.next=6,Object(q.o)(Math.min(2e3*a++,1e4));case 6:return e.next=8,ga(t);case 8:if(o=e.sent,i=o.url,"ok"===o.status&&(n=!1,r=i),!(a>20)){e.next=15;break}return Object(q.e)(),e.abrupt("return",!1);case 15:e.next=3;break;case 17:return Object(q.f)({url:"/"+r,name:name,type:"zip"}),e.abrupt("return",!0);case 19:case"end":return e.stop()}},e,void 0)}),fa=function(){var e=da.apply(this,arguments);return new Promise(function(t,n){return function r(a,o){try{var i=e[a](o),c=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(c).then(function(e){r("next",e)},function(e){r("throw",e)});t(c)}("next")})},function(e){return fa.apply(this,arguments)}),ba=function(){return new URLSearchParams(location.search).has("inspect")},wa=Object(q.h)(function(e,t){return e.find(function(e){return e.cid===t})}),Ca=Object(O.connect)(function(e){var t=e.model,n=t.current,r=n.screenCid,a=n.projectCid,o=t.unreadComment.unreadCountScreenMap,i=t.projects,c=e.container,s=c.common.scale,l=c.previewSetting,u=l.toolbarActiveItem,p=l.loadSliceUrl;return{scale:s,project:wa(i,a),toolbarActiveItem:u,existUnreadComment:!!o[r],loadSliceUrl:p}})(ha),Ea=n("sEfC"),Sa=n.n(Ea),Oa=n("i8i4"),_a=n.n(Oa),ja=function(e,t,n){var r=[],a=0,o=Object.entries(e),i=Array.isArray(o),c=0;for(o=i?o:o[Symbol.iterator]();;){var s;if(i){if(c>=o.length)break;s=o[c++]}else{if((c=o.next()).done)break;s=c.value}var l=s,u=l[0],p=l[1];t&&t.length>0&&p.toLowerCase().includes(t)&&r.push(Object.assign.apply(Object,[{}].concat(n[u],[{index:a++}])))}return r},xa=0,Ta=0,ka=function(e){return!!function(e,t){var n=_a.a.findDOMNode(e),r=void 0,a=void 0;try{var o=t.getBoundingClientRect();r=o.top,a=o.height}catch(e){r=xa,a=Ta}var i=window.innerHeight||document.documentElement.clientHeight,c=Math.max(r,0),s=Math.min(i,r+a)-c,l=void 0,u=void 0;try{var p=n.getBoundingClientRect();l=p.top,u=p.height}catch(e){l=xa,u=Ta}var d=l-c;return d<=s&&d+u>=0}(e,function(e){if(!e)return document.documentElement;for(var t="absolute"===e.style.position,n=/(scroll|auto)/,r=e;r;){if(!r.parentNode)return e.ownerDocument||document.documentElement;var a=window.getComputedStyle(r),o=a.position,i=a.overflow,c=a["overflow-x"],s=a["overflow-y"];if("static"===o&&t&&(r=r.parentNode),n.test(i)&&n.test(c)&&n.test(s))return r;r=r.parentNode}return e.ownerDocument||e.documentElement||document.documentElement}(_a.a.findDOMNode(e)))},Ma=n("dzIi"),Na=n.n(Ma),Ra=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function Ia(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function La(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function Pa(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Aa=Na.a["screen-node-content"],Da=function(e){function t(){var n,r;Ia(this,t);for(var a=arguments.length,o=Array(a),i=0;i<a;i++)o[i]=arguments[i];return n=r=La(this,e.call.apply(e,[this].concat(o))),r.renderSearch=function(e){var t=r.props.treeProps,n=t.currentScreenCid;return e.map(function(e){var r=e.cid,a=e.screen.name,o={doShowComment:Object(q.j)(function(){return t.doShowComment(r)}),doSelectScreen:Object(q.j)(function(){return t.doSelectScreen(r)}),doToggleExpand:Object(q.j)(function(){return t.doToggleExpand(r)})},i=n===r;return T.a.createElement(Ua,{key:r,screenName:a,isSelect:i,screenTreeOperations:o})})},La(r,n)}return Pa(t,e),t.prototype.render=function(){var e=this.props,t=e.cid,n=e.level,r=e.treeProps,a=e.className,o=e.isSearch,i=n+1,c=r.searchScreenKeyMap&&r.searchScreenKeyMap.length>0;return T.a.createElement("div",{className:a},o?c?this.renderSearch(r.searchScreenKeyMap):T.a.createElement("div",{className:"no-match"},I18N.preview_panel.not_match):r.childListMap[t].map(function(e){return T.a.createElement(Ba,Ra({key:e},{key:e,cid:e,level:i,treeProps:r}))}))},t}(x.PureComponent);Da.propTypes={cid:j.a.string,level:j.a.number,treeProps:j.a.object,className:j.a.string,isSearch:j.a.bool,currentScreenCid:j.a.string};var Ba=function(e){function t(n){Ia(this,t);var r=La(this,e.call(this,n));return r.screenTreeOperations={doShowComment:Object(q.j)(function(){return r.props.treeProps.doShowComment(r.props.cid)}),doSelectScreen:Object(q.j)(function(){return r.props.treeProps.doSelectScreen(r.props.cid)}),doToggleExpand:Object(q.j)(function(){return r.props.treeProps.doToggleExpand(r.props.cid)})},r}return Pa(t,e),t.prototype.render=function(){var e=this.props,t=e.cid,n=e.level,r=e.treeProps,a=r.nodeMap,o=r.childListMap,i=r.collapseKeySet,c=r.currentScreenCid,s=r.screenCommentThreadCountMap,l=o[t]&&o[t].length>0,u=c===t,p=!i.has(t),d=Object(q.p)(a[t].screen.name),f=s[t]||0;return T.a.createElement("div",null,T.a.createElement(Ua,{level:n,hasChildTab:l,isSelect:u,isExpand:p,screenName:d,screenCommentThreadCount:f,screenTreeOperations:this.screenTreeOperations}),l&&p&&T.a.createElement(Da,{cid:t,level:n,treeProps:r,currentScreenCid:c}))},t}(x.PureComponent);Ba.propTypes={cid:j.a.string,level:j.a.number,treeProps:j.a.object};var Ua=function(e){function t(){var n,r;Ia(this,t);for(var a=arguments.length,o=Array(a),i=0;i<a;i++)o[i]=arguments[i];return n=r=La(this,e.call.apply(e,[this].concat(o))),r.getElementRef=function(e){return r.$elem=e},La(r,n)}return Pa(t,e),t.prototype.componentDidMount=function(){this.props.isSelect&&!ka(this)&&this.$elem.scrollIntoView()},t.prototype.render=function(){var e=this.props,t=e.level,n=e.hasChildTab,r=e.isSelect,a=e.isExpand,o=e.screenName,i=e.screenCommentThreadCount,c=e.screenTreeOperations,s=c.doSelectScreen,l=c.doToggleExpand,u=r?n?l:null:s,p=i>=1&&!MB.isOffline();return T.a.createElement(Ut.d,{content:{hover:o},type:"block",duration:1e3},T.a.createElement("div",{ref:this.getElementRef,className:Aa+" "+(r?"select":""),style:{paddingLeft:Fa(t)},onClick:u},T.a.createElement("div",{className:"toggle-expand",onClick:n?l:null},n&&T.a.createElement(Dt.b,{type:"fa",name:a?"fa-caret-down":"fa-caret-right"})),T.a.createElement(Dt.b,{type:"mb",name:"layout",className:"screen-icon"}),T.a.createElement(Ut.f,{className:"screen-name",noTooltip:!0,name:o}),p&&T.a.createElement("span",{className:"toggle-comment"},T.a.createElement(Dt.b,{type:"dora",name:"comment"}))))},t}(x.PureComponent);Ua.propTypes={level:j.a.number,hasChildTab:j.a.bool,isSelect:j.a.bool,isExpand:j.a.bool,screenName:j.a.string,screenCommentThreadCount:j.a.number,screenTreeOperations:j.a.object};var Fa=function(e){return 2+12*e+"px"},qa=n("aGLX"),Wa=n.n(qa),za=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function Ha(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Va(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function Ga(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Ka=zt.a.bind(Wa.a),Xa=function(e){function t(n){Ha(this,t);var r=Va(this,e.call(this,n));return r.handleOnload=function(){r.setState({imageLoad:!0})},r.imageRef=function(e){return r.$image=e},r.getElementRef=function(e){return r.$elem=e},r.state={imageLoad:!1},r}return Ga(t,e),t.prototype.componentDidMount=function(){var e=this.props,t=e.isSelect,n=e.scrollIntoView,r=e.sortSource,a=e.src;t&&!ka(this)&&n(this.$elem),r(a,this.$image)},t.prototype.componentWillUnmount=function(){var e=this.props,t=e.src;(0,e.removeSource)(t)},t.prototype.render=function(){var e=this.props,t=e.cid,n=e.title,r=e.isSelect,a=e.screenCommentThreadCount,o=this.state.imageLoad,i=Ka(o?"opacity-1":"opacity-0"),c=r?"active":"",s=o?{background:"#F7F7FA"}:{background:'#F7F7FA url("/images/preview/image-load.png") no-repeat center center'};return T.a.createElement("div",{ref:this.getElementRef,className:Ka("image-item"),"data-cid":t},T.a.createElement(Ut.d,{arrowed:!1,content:{hover:n},duration:1e3,position:"bottom",type:"block"},T.a.createElement("div",{className:Ka("image-wrap",c),style:s,"data-cid":t},T.a.createElement("img",{className:i,ref:this.imageRef,"data-cid":t,alt:n,onLoad:this.handleOnload}))),!!a&&T.a.createElement(Dt.b,{className:Ka("comment-count"),type:"dora",name:"comment"}),T.a.createElement("p",{className:Ka("image-title"),"data-cid":t},n))},t}(x.PureComponent);Xa.propTypes={title:j.a.string,cid:j.a.string,src:j.a.string,isSelect:j.a.bool,scrollIntoView:j.a.func,screenCommentThreadCount:j.a.number,removeSource:j.a.func,sortSource:j.a.func};j.a.string,j.a.string,j.a.string;var Ya=function(e){function t(){return Ha(this,t),Va(this,e.call(this))}return Ga(t,e),t.prototype.render=function(){var e=this.props,t=e.treeProps,n=e.cid;return t.childListMap[n].map(function(e,n){return T.a.createElement(Za,{key:e,cid:e,index:n,treeProps:t})})},t}(x.PureComponent);Ya.propTypes={cid:j.a.string,treeProps:j.a.object};var Za=function(e){function t(){return Ha(this,t),Va(this,e.apply(this,arguments))}return Ga(t,e),t.prototype.render=function(){var e=this.props,t=e.treeProps,n=e.cid,r=e.index,a=t.nodeMap,o=t.childListMap,i=t.currentScreenCid,c=t.screenCommentThreadCountMap,s=t.scrollIntoView,l=t.sortSource,u=t.removeSource,p=a[n],d=p.screen.name,f=p.snapshot,h=i===n,m=o[n]&&o[n].length>0,v=c[n];return[T.a.createElement(Xa,{key:n,title:d,src:f,cid:n,isSelect:h,screenCommentThreadCount:v,scrollIntoView:s,sortSource:l,removeSource:u}),m&&T.a.createElement(Ya,za({key:""+n+r},{cid:n,treeProps:t,currentScreenCid:i}))]},t}(x.PureComponent);Za.propTypes={cid:j.a.string,treeProps:j.a.object,index:j.a.number};var Qa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var Ja=function(e){function t(n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n));r.handleClick=function(e){var t=r.props,n=t.currentScreenCid,a=t.dispatch,o=e.target.dataset.cid;o&&n!==o&&a({type:"entry:sync-runner:set-screen",payload:{cid:o}})},r.handleScroll=function(){io()},r.getContainerRef=function(e){return r.containerRef=e},r.debounceScroll=Sa()(r.handleScroll,300),r.imageTreeOperations={sortSource:function(e,t){ao.push({url:e,image:t})},removeSource:function(e,t){so(e,t)},scrollIntoView:function(e){e.scrollIntoView()}};var a=n.screenTreeData,o=a.nodeMap,i=a.screenNameCidMap,c=n.screenSearch;return r.state={collapseKeySet:new Set,searchScreenKeyMap:ja(i,c,o)||[]},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentDidMount=function(){io()},t.prototype.componentDidUpdate=function(e){e.imageNodeMap!==this.props.imageNodeMap&&io()},t.prototype.render=function(){var e=this,t=this.props,n=t.currentScreenCid,r=t.imageNodeMap,a=t.screenCommentThreadCountMap,o=t.screenTreeData,i=t.screenSearch,c=this.state,s=c.collapseKeySet,l=c.searchScreenKeyMap,u=ro(o,a,n,this.imageTreeOperations,s,l),p=i.length>0;return T.a.createElement("div",{ref:this.getContainerRef,className:Wa.a.imageList,onScroll:this.debounceScroll,onClick:this.handleClick},p?Object.entries(r).length?Object.entries(r).map(function(t,r){t[0];var o=t[1],i=o.name,c=o.snapshot,s=o.cid,l=a[s]||0,u=s==n;return T.a.createElement(Xa,{key:s,scrollIntoView:e.imageTreeOperations.scrollIntoView,isSelect:u,screenCommentThreadCount:l,src:c,index:r,title:i,cid:s,sortSource:e.imageTreeOperations.sortSource,removeSource:e.imageTreeOperations.removeSource})}):T.a.createElement("div",{className:"not-match"},I18N.preview_panel.not_match):T.a.createElement(Ya,{treeProps:u,cid:o.rootCid}))},t}(x.PureComponent);Ja.propTypes={currentScreenCid:j.a.string,screenTreeData:j.a.object.isRequired,screenCommentThreadCountMap:j.a.object,screenSearch:j.a.string,imageNodeMap:j.a.object,dispatch:j.a.func};var $a=Object(O.connect)(function(e){var t=e.model,n=t.projects,r=t.current,a=r.projectCid,o=r.screenCid,i=t.screens,c=n.find(function(e){return e.cid==a});return{screenTreeData:no(i,c,a),currentScreenCid:o,imageNodeMap:to(i,c,a,e.container.screens.screenSearch),screenSearch:e.container.screens.screenSearch,screenCommentThreadCountMap:eo(e.model.commentThreads)}})(Ja),eo=Object(q.h)(function(e){return e.reduce(function(e,t){return e[t.screen_cid]=(e[t.screen_cid]||0)+1,e},{})}),to=Object(q.h)(function(e,t,n,r){var a=t.access_token,o={};return e.forEach(function(e){var t=e.project_cid,i=e.cid,c=e.name;if(t===n){var s=lo(a,i);c.toLowerCase().includes(r.toLowerCase())&&(o[i]=Object.assign({},e,{snapshot:s}))}}),o}),no=Object(q.h)(function(e,t,n){var r,a=t.access_token,o={},i={},c=((r={}).null=[],r);return e.forEach(function(e){if(e.project_cid===n){var t=e.cid,r=e.position,s=e.parent_cid||"null",l=lo(a,t);o[t]={cid:t,parentCid:s,screen:e,position:r,snapshot:l},i[t]=String(e.name).toLowerCase(),void 0===c[s]&&(c[s]=[]),c[s].push(t)}}),Object.values(c).forEach(function(e){return e.sort(function(e,t){return o[e].position-o[t].position})}),{rootCid:"null",nodeMap:o,childListMap:c,screenNameCidMap:i}}),ro=Object(q.h)(function(e,t,n,r,a,o){return Qa({screenCommentThreadCountMap:t,collapseKeySet:a,searchScreenKeyMap:o,currentScreenCid:n},e,r)}),ao=[],oo=new Set,io=function(){var e,t=(e=regeneratorRuntime.mark(function e(){var t,n,r,a,o,i,c,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=ao,n=Array.isArray(t),r=0,t=n?t:t[Symbol.iterator]();case 1:if(!n){e.next=7;break}if(!(r>=t.length)){e.next=4;break}return e.abrupt("break",24);case 4:a=t[r++],e.next=11;break;case 7:if(!(r=t.next()).done){e.next=10;break}return e.abrupt("break",24);case 10:a=r.value;case 11:if(i=(o=a).url,c=o.image,!oo.has(i)){e.next=15;break}return e.abrupt("continue",22);case 15:if(ka(c)){e.next=18;break}return e.abrupt("continue",22);case 18:return e.next=20,co(i,c);case 20:s=e.sent,oo.add(s);case 22:e.next=1;break;case 24:case"end":return e.stop()}},e,void 0)}),function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(a,o){try{var i=t[a](o),c=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(c).then(function(e){r("next",e)},function(e){r("throw",e)});e(c)}("next")})});return function(){return t.apply(this,arguments)}}(),co=function(e,t){return new Promise(function(n,r){t.onload=function(){Object(q.c)({image:t,adjust:90}),n(e)},t.onerror=function(){return n(e)},t.src=e})},so=function(e,t){var n=ao.findIndex(function(t){return t.url==e});ao.splice(n,1),oo.delete(e)},lo=function(e,t){return"/snapshot.png?access-token="+e+"&screen-cid="+t+"&mode=thumbnail"},uo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var po=function(e){function t(n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n));r.resetExpandAll=function(){r.setState({collapseKeySet:new Set})},r.closeExpanedAll=function(){var e=(r.props.screenTreeData||{}).childListMap;if(e){var t=fo(e);r.setState({collapseKeySet:t})}},r.handleKeyDown=function(e){ho(e,r.resetExpandAll,r.closeExpanedAll)},r.screenTreeOperations={doShowComment:function(e){r.screenTreeOperations.doSelectScreen(e),r.props.dispatch({type:"entry:comment:set:active",payload:{isActive:!0}})},doSelectScreen:function(e){var t=r.props,n=t.currentScreenCid,a=t.dispatch;n!==e&&a({type:"entry:sync-runner:set-screen",payload:{cid:e}})},doToggleExpand:function(e){var t=r.state.collapseKeySet,n=new Set(t);t.has(e)?n.delete(e):n.add(e),r.setState({collapseKeySet:n})}};var a=n.screenTreeData,o=a.nodeMap,i=a.screenNameCidMap,c=n.screenSearch;return r.state={collapseKeySet:new Set,searchScreenKeyMap:ja(i,c,o)||[]},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillReceiveProps=function(e){var t=e.screenSearch,n=this.props,r=n.screenTreeData,a=r.nodeMap,o=r.screenNameCidMap;if(t!=n.screenSearch){var i=ja(o,t,a)||[];this.setState({searchScreenKeyMap:i})}},t.prototype.render=function(){var e=this.props,t=e.screenTreeData,n=e.screenCommentThreadCountMap,r=e.currentScreenCid,a=e.screenSearch,o=this.state,i=o.collapseKeySet,c=o.searchScreenKeyMap,s=a.length>0,l=mo(t,n,r,i,this.screenTreeOperations,c);return T.a.createElement("div",{className:"screenNodeContainer"},T.a.createElement(Da,{cid:t.rootCid,level:-1,treeProps:l,isSearch:s}),T.a.createElement(M.a,{onKeyDown:this.handleKeyDown}))},t}(x.PureComponent);po.propTypes={screenTreeData:j.a.object,screenCommentThreadCountMap:j.a.object,currentScreenCid:j.a.string,screenNameCidMap:j.a.object,screenSearch:j.a.string,noSearch:j.a.bool,dispatch:j.a.func};var fo=Object(q.h)(function(e){var t=Object.entries(e).map(function(e){var t=e[0],n=e[1];if(Array.isArray(n)&&n.length)return t});return new Set(t)}),ho=function(e,t,n){(e.ctrlKey||e.metaKey)&&(186==e.keyCode&&(t(),e.preventDefault()),222==e.keyCode&&(n(),e.preventDefault()))},mo=Object(q.h)(function(e,t,n,r,a,o){return uo({screenCommentThreadCountMap:t,currentScreenCid:n,collapseKeySet:r,searchScreenKeyMap:o},e,a)}),vo=Object(O.connect)(function(e){return{screenTreeData:yo(e.model.screens,e.model.current.projectCid),screenCommentThreadCountMap:go(e.model.commentThreads),currentScreenCid:e.model.current.screenCid,screenSearch:e.container.screens.screenSearch}})(po),go=Object(q.h)(function(e){return e.reduce(function(e,t){return e[t.screen_cid]=(e[t.screen_cid]||0)+1,e},{})}),yo=Object(q.h)(function(e,t){var n,r={},a={},o=((n={}).null=[],n);return e.forEach(function(e){if(e.project_cid===t){var n=e.cid,i=e.position,c=e.parent_cid||"null";r[n]={cid:n,parentCid:c,position:i,screen:e},a[n]=String(e.name).toLowerCase(),void 0===o[c]&&(o[c]=[]),o[c].push(n)}}),Object.values(o).forEach(function(e){return e.sort(function(e,t){return r[e].position-r[t].position})}),{rootCid:"null",nodeMap:r,childListMap:o,screenNameCidMap:a}}),bo=n("2s0x"),wo=n.n(bo),Co=function(e,t){return new Promise(function(n){e.src=t,e.onload=function(){return n(e)},e.onerror=n})},Eo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function So(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Oo,_o=(Oo=Promise.resolve("QUEUE_HEAD"),{pushTask:function(e){var t=Oo.then(e).catch(console.log);return Oo=t,t}}).pushTask,jo=function(e){function t(){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=Array(a),i=0;i<a;i++)o[i]=arguments[i];return n=r=So(this,e.call.apply(e,[this].concat(o))),r.getElementRef=function(e){return r.imageRef=e},So(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentDidMount=function(){var e,t=this;_o((e=regeneratorRuntime.mark(function e(){var n,r,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.props,r=n.src,a=n.adjustImage,e.next=3,Co(t.imageRef,r);case 3:o=e.sent,a&&o&&Object(q.c)({image:o,adjust:a});case 5:case"end":return e.stop()}},e,t)}),function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(a,o){try{var i=t[a](o),c=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(c).then(function(e){r("next",e)},function(e){r("throw",e)});e(c)}("next")})})).catch(function(e){return console.error(e)})},t.prototype.render=function(){var e=this.props,t=(e.src,e.adjustImage,function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["src","adjustImage"]));return T.a.createElement("img",Eo({alt:"",ref:this.getElementRef},t))},t}(x.PureComponent),xo=jo;jo.propTypes={src:j.a.string,adjustImage:j.a.number};function To(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(a,o){try{var i=t[a](o),c=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(c).then(function(e){r("next",e)},function(e){r("throw",e)});e(c)}("next")})}}function ko(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mo(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function No(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Ro=zt.a.bind(wo.a),Io=!1,Lo=function(e){function t(n){ko(this,t);var r=Mo(this,e.call(this,n));Po.call(r),Io=!1,r.state={download:!1,activeLayerId:null};var a=r.props,o=a.loading,i=a.dispatch;return o&&i({type:"reducer:slice:init"}),r}return No(t,e),t.prototype.componentWillUnmount=function(){var e=this.props,t=e.projectCid,n=e.dispatch;this.state.download&&(Io=!0,n({type:"reducer:preview-toolbar:update",payload:{loadSliceUrl:"/api/v2/projects/"+t+"/build/slices_zips.json"}}))},t.prototype.render=function(){var e=this,t=this.state,n=t.download,r=t.activeLayerId,a=this.props,o=a.slicesMap,i=a.loading,c=a.error,s=a.currentScreenCid,l=a.isLogin;return c||i?T.a.createElement(qo,null):0===o.length?T.a.createElement(Wo,null):T.a.createElement("div",{className:Ro("slice-container")},o.map(function(t){var n=t.name,a=t.id,o=t.screen_cid,i=t.image,c=t.image_set;return T.a.createElement(Ao,{key:a,src:i,name:n,currentScreenCid:s,id:a,imageSet:c,screenCid:o,requestLayer:e.requestLayer,activeLayer:e.handleActiveLayer,activeLayerId:r})}),T.a.createElement(Do,{onClick:this.downloadSlice,isLoading:n,isLogin:l}))},t}(x.PureComponent),Po=function(){var e=this;this.handleActiveLayer=function(t){e.setState({activeLayerId:t})},this.downloadSlice=To(regeneratorRuntime.mark(function t(){var n,r,a,o,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.props,r=n.projectCid,a=n.projectName,o=n.isLogin,!0!==e.state.download&&o){t.next=3;break}return t.abrupt("return");case 3:return e.startLoadSlice(),t.next=6,zo(r,a);case 6:i=t.sent,e.endLoadSlice(i);case 8:case"end":return t.stop()}},t,e)})),this.startLoadSlice=function(){e.startTime=Date.now(),e.setState({download:!0}),MB.event("点击下载全部切图","运行页")},this.endLoadSlice=function(t){t&&(MB.event("下载全部切图时长"+(Date.now()-e.startTime),"运行页"),e.setState({download:!1}))},this.requestLayer=function(t){var n=e.props.dispatch;n({type:"REQUEST_SELECT_LAYER",payload:{layerID:t}}),n({type:"reducer:preview-toolbar:update",payload:{isSelectLayer:!0}})}};Lo.propTypes={slicesMap:j.a.array.isRequired,loading:j.a.bool,error:j.a.bool,currentScreenCid:j.a.string,isLogin:j.a.bool,projectCid:j.a.string,projectName:j.a.string,dispatch:j.a.func};var Ao=function(e){function t(){ko(this,t);var n=Mo(this,e.call(this));return n.isIncurrentScreen=function(){return n.props.screenCid===n.props.currentScreenCid},n.handleClick=function(){var e=n.props,t=e.id,r=e.requestLayer;(0,e.activeLayer)(t),n.isIncurrentScreen()?r(t):console.warn("Not in current Screen")},n.handleOnload=function(){n.setState({imageLoad:!0})},n.handleError=function(){throw new Error("image load fail")},n.handleMouseEnter=function(){n.setState({loadSingleSlice:!0})},n.handleMouseLeave=function(){n.setState({loadSingleSlice:!1})},n.handleSingleDownload=function(e){e.persist(),e.stopPropagation(),n.delaySingleDownload()},n.state={imageLoad:!1,loadSingleSlice:!1},n.imageRef=function(e){return n.$image=e},n.delaySingleDownload=Sa()(function(){var e=n.props,t=e.imageSet,r=e.name;Object(q.f)({url:t,name:r,type:"zip"}),MB.event("在切图列表中下载单张切图","运行页")},500,{leading:!0}),n}return No(t,e),t.prototype.render=function(){var e=this.props,t=e.name,n=e.src,r=e.activeLayerId,a=e.id,o=this.state,i=o.imageLoad,c=o.loadSingleSlice,s=i?"opacity-1":"opacity-0",l={display:i?"block":"none"},u=Ro("slice-item",{active:r===a});return T.a.createElement(Ut.d,{type:"block",content:{click:this.isIncurrentScreen()?null:I18N.preview_panel.not_incurrent_screen}},T.a.createElement("div",{className:u,onClick:this.handleClick,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},T.a.createElement("div",{className:"slice-item-wrap",style:{background:"url(/images/preview/slice-bg.png) left top",backgroundSize:"cover"}},!i&&T.a.createElement("img",{src:"/images/preview/image-load-gif.gif",alt:"Loading..."}),T.a.createElement(xo,{style:l,src:n,alt:t,adjustImage:38,className:""+s,onLoad:this.handleOnload,onError:this.handleError})),T.a.createElement("div",{className:"slice-item-content"},T.a.createElement("span",{className:"slice-item-name textEllipsis"},t),c&&T.a.createElement(Dt.b,{name:"download",type:"dora",onClick:this.handleSingleDownload}))))},t}(x.PureComponent);Ao.propTypes={name:j.a.string,src:j.a.string.isRequired,id:j.a.number.isRequired,imageSet:j.a.string.isRequired,screenCid:j.a.string.isRequired,requestLayer:j.a.func.isRequired,activeLayer:j.a.func,activeLayerId:j.a.number,currentScreenCid:j.a.string.isRequired};var Do=function(e){var t=e.onClick,n=e.isLoading,r=e.isLogin?null:I18N.preview.guide_login;return T.a.createElement(Ut.d,{content:{click:r},type:"block",position:"top",arrowed:!1,className:Ro("download"),onClick:t},I18N.preview_panel.download,n?T.a.createElement(Fo,null):T.a.createElement(Dt.b,{type:"dora",name:"download",className:Ro("icon-download")}))};Do.propTypes={onClick:j.a.func,isLoading:j.a.bool,isLogin:j.a.bool};var Bo,Uo=function(){return T.a.createElement("div",{className:Ro("layer-load")},T.a.createElement("span",{className:Ro("spinner")}))},Fo=function(){return T.a.createElement("div",{className:Ro("download-slice-load")},T.a.createElement(Uo,null))},qo=function(){return T.a.createElement("div",{className:Ro("slice-load-wrap")},T.a.createElement(Uo,null))},Wo=function(){return T.a.createElement("div",{className:Ro("no-slice")},T.a.createElement("img",{src:"/images/preview/no-slice@2x.png"}),T.a.createElement("span",null,I18N.preview_panel.no_slice),T.a.createElement("span",null,I18N.preview_panel.slice_in_sketch),T.a.createElement("a",{href:"https://s3.cn-north-1.amazonaws.com.cn/modao/sketch/MockingBot.sketchplugin.zip"},T.a.createElement("img",{src:"/images/preview/ic_sketch@2x.png",alt:"sketch"}),I18N.preview_panel.download_sketch))},zo=(Bo=To(regeneratorRuntime.mark(function e(t,n){var r,a,o,c,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=!0,a=void 0,o=1;case 3:if(!r){e.next=23;break}if(!Io){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,i(t);case 8:if(c=e.sent,s=c.url,"ok"!==c.status){e.next=16;break}r=!1,a=s,e.next=18;break;case 16:return e.next=18,Object(q.o)(Math.min(2e3*o++,1e4));case 18:if(!(o>20)){e.next=21;break}return Object(q.e)(),e.abrupt("return",!1);case 21:e.next=3;break;case 23:return Object(q.f)({url:"/"+a,name:n,type:"zip"}),e.abrupt("return",!0);case 25:case"end":return e.stop()}},e,void 0)})),function(e,t){return Bo.apply(this,arguments)}),Ho=Object(O.connect)(function(e){var t=e.model,n=t.current,r=n.screenCid,a=n.projectCid,o=t.user,i=e.container.slices;return{slicesMap:i.slices,loading:i.loading,error:i.error,isLogin:!!o.id,projectCid:a,currentScreenCid:r}})(Lo),Vo=n("XQpQ"),Go=n("GEF2"),Ko=n.n(Go);var Xo=zt.a.bind(Ko.a),Yo=new Set(["demo","cS1AXKF5jtrJePbEKiYcdcHosQPdzrk","workout","sI3GY2tDz76RrZ4MGFiIcZTZpAHyluC","UMQzYmknxWeHNvvVyeyJDuSkgyvi6Xw","9Py1L5RdC8ZPRSmnWEt4uuUUSDUAxkM"]),Zo=function(e){function t(n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n));r.renderRightNav=function(e,t){var n=r.props.project,a=r.state.value;return 0==e?T.a.createElement("div",{className:Xo("search-container")},T.a.createElement("div",{className:"search-box"},T.a.createElement(Qo,{onChange:r.handleSearch,value:a}),T.a.createElement("div",{className:"screen-mode-tab"},T.a.createElement(Ut.d,{className:"view-mode-icon",content:{hover:I18N.preview.list_mode},duration:1e3,position:"bottom",tipClassName:"marign-top-20"},T.a.createElement(Dt.b,{type:"dora",name:"list",className:t?"fs-color-gray":"",onClick:r.handleClick})),T.a.createElement(Ut.d,{className:"view-mode-icon",content:{hover:I18N.preview.image_mode},duration:1e3,position:"bottom",tipClassName:"marign-top-20"},T.a.createElement(Dt.b,{type:"dora",name:"cover",className:t?"":"fs-color-gray",onClick:r.handleClick})))),t?T.a.createElement($a,null):T.a.createElement(vo,null)):T.a.createElement(Ho,{projectName:n.name})},r.handleClick=function(){var e=r.props.toolbarActiveItem;MB.event("在"+q.a[e]+",点击了"+(r.state.imageMode?"列表":"缩略图"),"运行页"),r.setState(function(e){return{imageMode:!e.imageMode}})},r.handleBackToOrigin=function(){r.props.dispatch({type:"preview:set:canvas:offset",payload:{offset:{x:0,y:0}}})},r.handleSearch=function(e){var t=e.target.value;r.debounceSearch(t.toLowerCase()),r.setState({value:t})},r.debounceSearch=Sa()(function(e){MB.event("使用了页面搜索","运行页"),r.props.dispatch({type:"reducer:preview-panel:search",payload:{screenSearch:e}})},300),r.handleTabChange=function(e){r.setState({activeIndex:e})},r.toggleMinimized=function(){var e=r.props.toolbarActiveItem;r.setState(function(e){return{isMinimized:!e.isMinimized}}),MB.event(q.a[e]+",点击了"+(r.state.isMinimized?"展开":"收起")+"列表","运行页")};var a=n.isDemo;return r.getContainerRef=function(e){return r.containerRef=e},r.getScrollRef=function(e){return r.scrollRef=e},r.scrollRef=null,r.state={isMinimized:!1,imageMode:a,value:"",activeIndex:0},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillReceiveProps=function(e){"inspect"!==e.toolbarActiveItem&&this.setState({activeIndex:0})},t.prototype.componentDidUpdate=function(e,t){t.isMinimized!==this.state.isMinimized&&function(e,t){if(e)return void(t.style.width=0);t.style.width=ti}(this.state.isMinimized,this.containerRef)},t.prototype.render=function(){var e=this.props,t=e.isDemo,n=e.screensCount,r=e.toolbarActiveItem,a=e.isLoggedIn,o=e.isDisplaced,i=this.state,c=i.isMinimized,s=i.imageMode,l=i.activeIndex,u=[{type:"dora",label:$o+" ("+n+")",icon:"file_text"},{type:"dora",label:ei,icon:"slice"}],p="inspect"==r&&!MB.isOffline(),d=p?u:u.slice(0,1),f=Xo("preview-panel",{minimized:c}),h=Xo("preview-panel-nav",{"single-nav":!p});return T.a.createElement("div",{className:Xo("preview-panel-wrapper"),ref:this.getContainerRef},T.a.createElement("div",{className:Xo("reset-btn",{"is-show":o}),onClick:this.handleBackToOrigin},I18N.click_to_origin),T.a.createElement("div",{className:f},T.a.createElement(Fr.b,{tabs:d,activeIndex:l,onChange:this.handleTabChange,className:h,hideBorder:!0}),T.a.createElement("div",{className:"preview-panel-nav-line",style:{opacity:p?0:1}}),this.renderRightNav(l,s),T.a.createElement("div",{className:Xo("panel-toggle-minimize",{minimized:c}),onClick:this.toggleMinimized},T.a.createElement(Dt.b,{type:"fa",name:"angle-right",className:"toggle-icon"}))),T.a.createElement(Vo.b,{isLoggedIn:a,isDemo:t}))},t}(x.PureComponent);Zo.propTypes={project:j.a.object.isRequired,screensCount:j.a.number.isRequired,toolbarActiveItem:j.a.string.isRequired,isLoggedIn:j.a.bool,isDisplaced:j.a.bool,isDemo:j.a.bool,dispatch:j.a.func};var Qo=function(e){var t=e.onChange,n=e.value;return T.a.createElement("div",{className:Ko.a.search},T.a.createElement(Dt.b,{type:"dora",name:"scale"}),T.a.createElement("input",{type:"text",placeholder:I18N.preview.search,onChange:t,value:n}))};Qo.propTypes={onChange:j.a.func,value:j.a.string};var Jo=window.I18N.preview,$o=Jo.pages,ei=Jo.images,ti="240px";var ni=Object(q.h)(function(e,t){return e.find(function(e){return e.cid===t})}),ri=Object(O.connect)(function(e){var t=e.model,n=t.user,r=t.current.projectCid,a=t.projects,o=t.screens,i=e.container,c=i.common.offset,s=i.previewSetting.toolbarActiveItem,l=!!n.id,u=Boolean(c.x||c.y),p=ni(a,r),d=Yo.has(p.access_token);return{isLoggedIn:l,isDisplaced:u,screensCount:o.reduce(function(e,t){return t.project_cid===r?e+1:e},0),project:p,isDemo:d,toolbarActiveItem:s}})(Zo),ai=n("XrEr"),oi=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return e=e.toString(),"pt"!==n?e.replace(t,n):r?Object(ai.d)(e):e.replace(t,"")},ii={px:{x:"left",y:"top",width:"width",height:"height",lineHeight:"line-height",opacity:"opacity",border:"border",borderRadius:"border-radius",borderColor:"border-color",borderWidth:"border-width",backgroundColor:"background-color",color:"color",fontSize:"font-size",fontFamily:"font-family",fontStyle:"font-style",textAlign:"text-align",shadows:"box-shadow",innerShadows:"inner-shadow"},dp:{x:"left",y:"top",width:"layout_width",height:"layout_height",border:"border",opacity:"opacity",color:"textColor",fontSize:"textSize",fontFamily:"font-family",fontStyle:"font-style",textAlign:"gravity",backgroundColor:"background",borderRadius:"radius",borderColor:"border-color",lineHeight:"line-height",borderWidth:"border-width",shadows:"box-shadow",innerShadows:"inner-shadow"},pt:{x:"x",y:"y",width:"width",height:"height",opacity:"opacity",border:"border",backgroundColor:"backgroundColor",color:"text-color",textAlign:"alignment",fontSize:"fontSize",fontFamily:"fontFamily",fontStyle:"font-style",borderRadius:"cornerRadius",borderColor:"borderColor",borderWidth:"border-width",lineHeight:"lineSpacing"}},ci=n("RUem"),si=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},li=function(e){var t=e.layer,n=e.unit,r=e.ratio,a=e.showGlobal,o=e.userPickColor,i=void 0===o?[]:o,c=e.globalColor,s=void 0===c?[]:c,l=e.globalText,u=void 0===l?[]:l,p=e.documentColor,d=void 0===p?[]:p,f=e.screenColor,h=void 0===f?[]:f,m=e.language,v=e.colorUnit,g=e.dispatch,y=t.src_left,b=t.src_top,w=t.src_width,C=t.src_height,E=t.bd_radius,S=t.line_height,O=t.bg_colors,_=void 0===O?[]:O,j=t.borders,x=void 0===j?[]:j,k=t.i,M=t.name,N=t.padding,R=void 0===N?0:N,I=t.hiddSpacing,L=void 0!==I&&I,P=t.text_styles,A=void 0===P?[]:P,D=t.alignment,B=t.vertical_alignment,U=t.image,F=t.text,q=t.letter_spacing,W=t.image_set_zip,z=t.shadows,H=void 0===z?[]:z,V=t.inner_shadows,G=void 0===V?[]:V,K=t.rotation,X=t.textShadows,Y=void 0===X?[]:X,Z=t.image_set,Q=void 0===Z?[]:Z,J=x.length>0,$=_.length>0,ee=!!U,te=A.length>0&&F&&Object(we.e)(F).length,ne=H.length>0||Y.length>0,re=G.length>0,ae=W,oe={left:y,top:b,width:w,height:C,borderRadius:E,opacity:t.o,rotation:K,ratio:r,unit:n},ie=Object(we.b)(oe),ce=ie.adapterTop,se=ie.adapterLeft,le=ie.adapterWidth,ue=ie.adapterHeight,pe=ie.radius,de=ie.opacity,fe=ie.rotate,he={lineHeight:S,letterSpacing:q,fontStyle:k,unit:n,ratio:r},me=Object(we.d)(he),ve=me.lineHeight,ge=me.letterSpacing,ye=me.fontStyle,be={textStyles:A,background:_,borders:x,shadows:H,innerShadows:G,colorUnit:v,ratio:r,unit:n},Ce=Object(we.c)(be),Ee=t.o&&100!=t.o?t.o/100:null,Se=function(e){var t,n,r,a,o,i,c,s,l,u,p,d,f,h,m,v,g=e.attr,y=e.language,b=e.unit,w=Object(we.f)(y),C=g.width,E=g.height,S=g.lineHeight,O=g.opacity,_=g.borderRadius,j=g.borderWidth,x=g.borderColor,T=g.backgroundColor,k=g.color,M=g.fontSize,N=g.fontFamily,R=g.fontStyle,I=g.boxShadow,L=g.textAlign,P=g.x,A=g.y,D=P&&((t={})[ii[w].x]=oi(P,b,w),t),B=A&&((n={})[ii[w].y]=oi(A,b,w),n),U=C&&((r={})[ii[w].width]=oi(C,b,w),r),F=E&&((a={})[ii[w].height]=oi(E,b,w),a),q=S&&((o={})[ii[w].lineHeight]=oi(S,b,w),o),W=O&&((i={})[ii[w].opacity]=oi(O,b,w),i),z=_&&((c={})[ii[w].borderRadius]=oi(_,b,w),c),H=T&&((s={})[ii[w].backgroundColor]=oi(T,b,w,!0),s),V=k&&((l={})[ii[w].color]=oi(k,b,w,!0),l),G=M&&((u={})[ii[w].fontSize]=oi(M,b,w),u),K=N&&((p={})[ii[w].fontFamily]=oi(N,b,w),p),X=R&&((d={})[ii[w].fontStyle]=oi(R,b,w),d),Y=I&&((f={})[ii[w].shadows]=I,f),Z=j&&((h={})[ii[w].borderWidth]=oi(j,b,w),h),Q=x&&((m={})[ii[w].borderColor]=oi(x,b,w,!0),m),J=L&&((v={})[ii[w].textAlign]=L,v);return Object.assign({},D,B,U,F,q,W,z,Z,Q,H,V,G,X,J,Y,K)}({attr:si({x:se,y:ce,width:le,height:ue,lineHeight:ve,textAlign:D,opacity:Ee,borderRadius:pe},Ce),language:m,unit:n}),Oe=ee?"ImageView":te?"TextView":"View";return a?T.a.createElement(ci.h,{adapterWidth:le,adapterHeight:ue,documentColor:d,globalText:u,globalColor:s,screenColor:h,userPickColor:i,colorUnit:v,dispatch:g}):T.a.createElement("div",null,T.a.createElement(ci.j,{value:M}),T.a.createElement(ci.b,{adapterTop:ce,adapterLeft:se,adapterWidth:le,adapterHeight:ue,rotate:fe,radius:pe,opacity:de,unit:n,colorUnit:v}),te&&T.a.createElement(ci.m,{textStyles:A,alignment:D,vertical_alignment:B,lineHeight:ve,letterSpacing:ge,ratio:r,unit:n,o:t.o,padding:R,fontStyle:ye,colorUnit:v,hiddSpacing:L,text:Object(we.e)(F)}),$&&T.a.createElement(ci.g,{backgroundColorSort:_,colorUnit:v}),J&&T.a.createElement(ci.c,{borderSort:x,ratio:r,unit:n,colorUnit:v}),ne&&T.a.createElement(ci.l,{shadows:H,textShadows:Y,colorUnit:v,unit:n,ratio:r}),re&&T.a.createElement(ci.l,{shadows:G,colorUnit:v,unit:n,ratio:r,isInnerShaow:!0}),ae&&T.a.createElement(ci.i,{imageSetZip:W,name:t.name,imageSet:Q}),T.a.createElement(ci.d,{code:Se,whichAndView:Oe,language:m,text:Object(we.e)(F)||""}))};li.propTypes={userPickColor:j.a.array,screenColor:j.a.array,documentColor:j.a.array,globalText:j.a.array,globalColor:j.a.array,colorUnit:j.a.string,layer:j.a.object,getLayerRef:j.a.func,showGlobal:j.a.bool,unit:j.a.string,ratio:j.a.number,language:j.a.string,dispatch:j.a.func};var ui=li,pi=n("sxGJ"),di=n.n(pi),fi=n("xn7q"),hi=n.n(fi),mi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var vi=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return n.getScrollLayerRef=function(e){return n.layerRef=e},n.state={error:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentDidMount=function(){this.clipBoard=new di.a('[data-type="copy"]')},t.prototype.componentWillUnmount=function(){$(this.layerRef).perfectScrollbar("destroy"),this.clipBoard.destroy()},t.prototype.componentWillReceiveProps=function(e){e.screenCid!=this.props.screenCid&&this.props.dispatch({type:"reducer:preview-toolbar:update",payload:{isSelectLayer:!1}})},t.prototype.componentDidUpdate=function(e){e.layer!=this.props.layer&&$(this.layerRef).perfectScrollbar({suppressScrollX:!0}),e.layer&&this.props.layer&&e.layer.id!=this.props.layer.id&&this.layerRef&&(this.layerRef.scrollTop=0)},t.prototype.componentDidCatch=function(e){this.setState({error:!0}),console.error(e)},t.prototype.render=function(){var e=this.props,n=e.isSelectLayer,r=e.layer,a=this.state.error;return T.a.createElement("div",{className:hi.a.previewPanelLayer},r?T.a.createElement("div",{className:hi.a.layerInfo,ref:this.getScrollLayerRef},a?T.a.createElement(t.Error,null):T.a.createElement(ui,mi({},this.props,{showGlobal:!n}))):T.a.createElement(ci.k,null))},t}(x.PureComponent);vi.Error=function(){return T.a.createElement("div",null,"Sorry!Error happend, Please refresh it")},vi.propTypes={colorUnit:j.a.string.isRequired,isSelectLayer:j.a.bool.isRequired,unit:j.a.string.isRequired,ratio:j.a.number.isRequired,layer:j.a.object,screenCid:j.a.string,dispatch:j.a.func.isRequired};var gi=Object(O.connect)(function(e){var t=e.container,n=t.layers,r=n.activeLayerID,a=n.visibilityScreenID,o=n.resourceByScreen,i=t.previewSetting,c=e.model,s=c.current,l=s.screenCid,u=s.projectCid,p=c.projects,d=i.isSelectLayer,f=bi(p,u).device,h=wi(d,o,a,r),m=yi(o,a,f);return mi({},i,{layer:h},m,{screenCid:l})})(vi),yi=Object(q.h)(function(e,t,n){var r=[],a=[],o=[],i=[],c=e[t];if(c){var s=c.layers,l=Object(we.g)(s);r=l.screenColor,i=l.globalText,a=c.documentColor,o=c.globalColor}return{screenColor:r,documentColor:a,globalColor:o,globalText:i}}),bi=Object(q.h)(function(e,t){return e.find(function(e){return e.cid===t})}),wi=Object(q.h)(function(e,t,n,r){var a=t[n];if(!a||a.layers&&0==a.layers.length)return null;var o=a.layers;return e?F()(o,function(e){return e.id===r}):mi({},o[0])}),Ci=n("XpKX"),Ei=n.n(Ci);var Si=zt.a.bind(Ei.a),Oi=window,_i=Oi.MB,ji=Oi.I18N,xi=new Set(["ai@mockingbot.com","ethantw@me.com"]),Ti=function(e){function t(n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n));return r.handleClick=function(){Ii(),r.setState({showLoadtip:!1})},Ni(n),n.dispatch({type:"entry:unread-comment:init"}),r.state={showLoadtip:!0},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillUnmount=function(){this.props.dispatch({type:"entry:preview:clear"})},t.prototype.componentWillUpdate=function(e){this.props.project!==e.project&&Ni(e)},t.prototype.render=function(){var e=this.props,t=e.isLite,n=e.project,r=n.owner_email,a=n.master,o=e.previewSetting,i=e.isProjectFromOtherFreeUser,c=this.state.showLoadtip;if(t)return T.a.createElement(zn,null);var s=o.toolbarActiveItem,l=s==$e.b,u=s==$e.a,p=!window.isElectron&&!_i.isOffline()&&l&&c&&Ri(),d=!a&&"preview"===s&&(xi.has(r)||i);return T.a.createElement("div",{className:Si({"is-offline-mode":_i.isOffline()})},T.a.createElement(Ca,null),l&&T.a.createElement(Ur,null),T.a.createElement("div",{className:Si("adjust-container","preview-content-container")},u&&T.a.createElement(On,null),l&&T.a.createElement(gi,null),T.a.createElement(dr,null),T.a.createElement(ri,null)),d&&T.a.createElement("a",{className:"powered-by",href:"/",target:"_blank"},T.a.createElement("img",{className:"zh",src:"/images/preview/watermark_zh.svg",alt:ji.preview.powered_by_modao}),T.a.createElement("img",{className:"en",src:"/images/preview/watermark_en.svg",alt:ji.preview.powered_by_modao})),T.a.createElement(Mi,{isActive:p,onClick:this.handleClick}))},t}(x.Component);Ti.propTypes={isLite:j.a.bool,project:j.a.object,isSelectLayer:j.a.bool,previewSetting:j.a.object,layer:j.a.object,isProjectFromOtherFreeUser:j.a.bool,userId:j.a.number,dispatch:j.a.func};var ki=Ti,Mi=function(e){var t=e.isActive,n=e.onClick;return t?T.a.createElement("div",{className:"download-client-tip"},T.a.createElement(Dt.b,{type:"fa",name:"info-circle",className:"download-client-tip-icon"}),T.a.createElement("span",{className:"download-text"},T.a.createElement("a",{href:"/downloads",rel:"noopener noreferrer",target:"_blank"},ji.preview.client_load_a)," ",ji.preview.client_load_tip),T.a.createElement(Dt.b,{type:"dora",name:"times_fc",className:"download-client-close-icon",onClick:n})):null};Mi.propTypes={isActive:j.a.bool.isRequired,onClick:j.a.func.isRequired};var Ni=function(e){var t,n,r,a=e.project,o=e.isProjectFromOtherFreeUser;return t={allowComment:a.limitation.commentable,denyMessage:_i.renewMsg("cant_comment",{role:o?a.team_cid?"team":"project":"user"})},n=t.allowComment,r=t.denyMessage,Object.assign(lt,{allowComment:n,denyMessage:r})},Ri=function(){return!_i.localStorageDelegate.getItem("close_client_load_tip")},Ii=function(){return _i.localStorageDelegate.setItem("close_client_load_tip","true")},Li=Object(q.h)(function(e,t){return e.find(function(e){return e.cid===t})}),Pi=Object(q.h)(function(e,t){return t!==e.owner_id&&e.expired}),Ai=Object(O.connect)(function(e){var t=e.model,n=t.current,r=t.projects,a=e.container.previewSetting,o=a.toolbarActiveItem,i=a.isSelectLayer,c=Li(r,n.projectCid),s=MB.isMobile()||MB.isEmbedded();return{isLayerActive:o===$e.b,isCommentActive:o===$e.a,previewSetting:a,isProjectFromOtherFreeUser:Pi(c,n.userId),isLite:s,isSelectLayer:i,project:c}})(ki);n.d(t,"c",function(){return Di}),n.d(t,"a",function(){return Ai}),n.d(t,"b",function(){return Pn});var Di={layerSaga:ze,sliceSaga:p,artboardsSaga:w}},qOCw:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"e",function(){return u}),n.d(t,"b",function(){return p}),n.d(t,"d",function(){return f}),n.d(t,"g",function(){return h}),n.d(t,"c",function(){return v}),n.d(t,"f",function(){return b});var r=n("wig9"),a=n.n(r),o=n("7tbW"),i=n.n(o),c=n("XrEr"),s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Number(parseFloat((1/t*e).toFixed(2)))+n},l=/<[^>]+>/gi,u=function(e){return!!e&&e.replace(l,"")},p=function(e){var t=e.width,n=e.height,r=e.left,a=e.top,o=e.opacity,i=e.borderRadius,c=e.rotation,l=e.ratio,u=e.unit,p=s(r,l,u),f=s(a,l,u),h=s(t,l,u),m=s(n,l,u),v=d(i)?null:s(i,l,u),g=d(c)?null:c+"°";return{adapterLeft:p,adapterTop:f,adapterWidth:h,adapterHeight:m,radius:v,opacity:d(o)?null:o+"%",rotate:g}},d=function(e){return null===e||isNaN(e)||0===e},f=function(e){var t=e.lineHeight,n=e.letterSpacing,r=e.fontStyle,a=e.unit,o=e.ratio;return{lineHeight:t=d(t)?null:s(t,o,a),letterSpacing:n=d(n)?null:s(n,o,a),fontStyle:r=void 0!==r?r?"normal":"italic":r}},h=function(e){var t=[],n=[];return e.forEach(function(e){var r=e.bg_colors,a=void 0===r?[]:r,o=e.borders,i=void 0===o?[]:o,s=e.text_styles,l=void 0===s?[]:s,u=l.length>0?l[0]:{},p=u.color,d=u.font_face,f=[];a.length&&(f=a.map(function(e){var t=e.value,n=e.type,r=void 0===n?"color":n,a=e.gradient,o=Object(c.c)(t);return"color"===r?o:y(a)})),f=m(f);var h=[];i.length&&(h=i.map(function(e){var t=e.color;return Object(c.c)(t)})),h=m(h);var v=p&&Object(c.b)(Object(c.e)(p),"rgba");!t.includes(v)&&t.push(v),!n.includes(d)&&n.push(d),t=!(t=!t.includes(f)&&[].concat(t,f)).includes(h)&&[].concat(t,h)}),{screenColor:i()(a()(t)).slice(0,14)||[],globalText:a()(n)}},m=function(e){var t;return(t=[]).concat.apply(t,e)},v=function(e){var t=e.textStyles,n=e.borders,r=e.background,a=e.shadows,o=e.innerShadows,i=(e.colorUnit,e.unit),l=e.ratio,u=void 0,p=void 0,d=void 0,f=void 0,h=void 0,m=void 0,v=void 0,y=void 0;if(t.length){var b=t[0],w=b.color,C=b.font_size,E=b.font_face;u=w&&Object(c.c)(w),p=s(C,l,i),d=E}if(n.length){var S=n[0],O=S.position,_=void 0===O?"inside":O,j=S.color,x=S.thickness;f=s(x,l,i),m=_,j&&(h=Object(c.c)(j))}return r.length&&(v=Object(c.c)(r[0].value)),a.length&&(y=g(a,i,l)),o.length&&(y=y+", "+g(o,i,l,!0)),{fontFamily:d,fontSize:p,color:u,borderWidth:f,borderColor:h,borderPosition:m,backgroundColor:v,boxShadow:y}},g=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e.length;return e.reduce(function(e,o,i){var l=o.color,u=o.offset_x,p=void 0===u?0:u,d=o.offset_y,f=void 0===d?0:d,h=o.blur_radius,m=void 0===h?0:h,v=o.spread,g=void 0===v?0:v,y=s(p,n,t),b=s(f,n,t),w=s(m,n,t);g=s(g,n,t),l=Object(c.c)(l);var C=i<a-1?", ":"",E=r?"inset ":"";return e.concat(""+E+y+" "+b+" "+w+" "+g+" "+l+C)},"")},y=function(e){return e&&e.color_stops?e.color_stops.map(function(e){var t=e.color;return Object(c.c)(t)}):c.a},b=function(e){switch(e){case"swift":return"pt";case"android":return"dp";default:return"px"}}},qZTm:function(e,t,n){var r=n("kekF")(Object.keys,Object);e.exports=r},quyA:function(e,t){var n=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return n.test(e)}},rEGp:function(e,t){e.exports=function(){return[]}},rXnp:function(e,t){},rbsZ:function(e,t,n){"use strict";n.d(t,"b",function(){return d}),n.d(t,"a",function(){return h}),n.d(t,"c",function(){return m});var r=n("q1tI"),a=n.n(r),o=n("17x9"),i=n.n(o),c=n("/Q2I"),s=n("0L8M"),l=(n("1mjR"),window),u=l.MB,p=l.I18N,d=function(){return location.assign("/pricing?next="+location.href)},f=function(e){var t=e.reason,n=e.data,r=e.shouldShowConfirm,o=e.onClose;return a.a.createElement(c.a,{isOpen:!0,className:"renew-modal",title:p.renew_prompt.title,onConfirm:r?d:null,confirmText:r?p.renew_now:null,onClose:o},a.a.createElement("p",null,h(t,n)))};f.propTypes={reason:i.a.string,data:i.a.object,shouldShowConfirm:i.a.bool,onClose:i.a.func};var h=function(e,t){var n=t.role,r=t.plan,a=t.storage,o=void 0===a?"":a,i=t.format,c=void 0===i?"":i,s=t.collaborators,l=void 0===s?"":s;return(p.renew_prompt[n+"_plan"]+p.renew_prompt[e]+p.renew_prompt[n+"_upgrade"]).replace("{plan}",p[r||u.currentProject.owner_plan]).replace("{storage}",o).replace("{format}",c).replace("{collaborators}",l)},m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};window.ga&&window.ga("ec:setAction","checkout",{step:1,option:e}),window.ga&&window.ga("send","event","goal","弹出了续费提示"),Object(s.a)(f,{reason:e,data:t,shouldShowConfirm:"user"===t.role})}},rtgd:function(e,t){e.exports={"preview-toolbar":"_3kKqNauE-PaVHPIZg_7k-D"}},rwIS:function(e,t){e.exports={"guide-button":"_31FtTxh_wpy1_6DRt1eNdq"}},sEfC:function(e,t,n){var r=n("GoyQ"),a=n("QIyF"),o=n("tLB3"),i="Expected a function",c=Math.max,s=Math.min;e.exports=function(e,t,n){var l,u,p,d,f,h,m=0,v=!1,g=!1,y=!0;if("function"!=typeof e)throw new TypeError(i);function b(t){var n=l,r=u;return l=u=void 0,m=t,d=e.apply(r,n)}function w(e){var n=e-h;return void 0===h||n>=t||n<0||g&&e-m>=p}function C(){var e=a();if(w(e))return E(e);f=setTimeout(C,function(e){var n=t-(e-h);return g?s(n,p-(e-m)):n}(e))}function E(e){return f=void 0,y&&l?b(e):(l=u=void 0,d)}function S(){var e=a(),n=w(e);if(l=arguments,u=this,h=e,n){if(void 0===f)return function(e){return m=e,f=setTimeout(C,t),v?b(e):d}(h);if(g)return f=setTimeout(C,t),b(h)}return void 0===f&&(f=setTimeout(C,t)),d}return t=o(t)||0,r(n)&&(v=!!n.leading,p=(g="maxWait"in n)?c(o(n.maxWait)||0,t):p,y="trailing"in n?!!n.trailing:y),S.cancel=function(){void 0!==f&&clearTimeout(f),m=0,l=h=u=f=void 0},S.flush=function(){return void 0===f?d:E(a())},S}},seXi:function(e,t,n){var r=n("qZTm"),a=1,o=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,i,c,s){var l=n&a,u=r(e),p=u.length;if(p!=r(t).length&&!l)return!1;for(var d=p;d--;){var f=u[d];if(!(l?f in t:o.call(t,f)))return!1}var h=s.get(e);if(h&&s.get(t))return h==t;var m=!0;s.set(e,t),s.set(t,e);for(var v=l;++d<p;){var g=e[f=u[d]],y=t[f];if(i)var b=l?i(y,g,f,t,e,s):i(g,y,f,e,t,s);if(!(void 0===b?g===y||c(g,y,n,i,s):b)){m=!1;break}v||(v="constructor"==f)}if(m&&!v){var w=e.constructor,C=t.constructor;w!=C&&"constructor"in e&&"constructor"in t&&!("function"==typeof w&&w instanceof w&&"function"==typeof C&&C instanceof C)&&(m=!1)}return s.delete(e),s.delete(t),m}},sgoq:function(e,t,n){var r=n("asDA"),a=n("TKrE"),o=n("6nK8"),i=RegExp("['’]","g");e.exports=function(e){return function(t){return r(o(a(t).replace(i,"")),e,"")}}},tLB3:function(e,t){e.exports=function(e){return e}},tpxX:function(e,t,n){var r=n("jl5L")("round");e.exports=r},tw9P:function(e,t,n){"use strict";n.d(t,"i",function(){return S}),n.d(t,"g",function(){return O}),n.d(t,"b",function(){return _}),n.d(t,"d",function(){return x}),n.d(t,"f",function(){return T}),n.d(t,"e",function(){return k}),n.d(t,"h",function(){return M}),n.d(t,"a",function(){return N}),n.d(t,"j",function(){return R}),n.d(t,"c",function(){return L});var r=n("Ev6p"),a=n("q09E"),o=Object(r.u)("IO"),i="TAKE",c="PUT",s="ALL",l="RACE",u="CALL",p="CPS",d="FORK",f="JOIN",h="CANCEL",m="SELECT",v="ACTION_CHANNEL",g="CANCELLED",y="FLUSH",b="GET_CONTEXT",w="SET_CONTEXT",C="\n(HINT: if you are getting this errors in tests, consider using createMockTask from redux-saga/utils)",E=function(e,t){var n;return(n={})[o]=!0,n[e]=t,n};function S(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*";if(arguments.length&&Object(r.g)(arguments[0],r.n.notUndef,"take(patternOrChannel): patternOrChannel is undefined"),r.n.pattern(e))return E(i,{pattern:e});if(r.n.channel(e))return E(i,{channel:e});throw new Error("take(patternOrChannel): argument "+String(e)+" is not valid channel or a valid pattern")}S.maybe=function(){var e=S.apply(void 0,arguments);return e[i].maybe=!0,e};S.maybe;function O(e,t){return arguments.length>1?(Object(r.g)(e,r.n.notUndef,"put(channel, action): argument channel is undefined"),Object(r.g)(e,r.n.channel,"put(channel, action): argument "+e+" is not a valid channel"),Object(r.g)(t,r.n.notUndef,"put(channel, action): argument action is undefined")):(Object(r.g)(e,r.n.notUndef,"put(action): argument action is undefined"),t=e,e=null),E(c,{channel:e,action:t})}function _(e){return E(s,e)}function j(e,t,n){Object(r.g)(t,r.n.notUndef,e+": argument fn is undefined");var a=null;if(r.n.array(t)){var o=t;a=o[0],t=o[1]}else if(t.fn){var i=t;a=i.context,t=i.fn}return a&&r.n.string(t)&&r.n.func(a[t])&&(t=a[t]),Object(r.g)(t,r.n.func,e+": argument "+t+" is not a function"),{context:a,fn:t,args:n}}function x(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return E(u,j("call",e,n))}function T(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return E(d,j("fork",e,n))}function k(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t.length>1)return _(t.map(function(e){return k(e)}));var a=t[0];return 1===t.length&&(Object(r.g)(a,r.n.notUndef,"cancel(task): argument task is undefined"),Object(r.g)(a,r.n.task,"cancel(task): argument "+a+" is not a valid Task object "+C)),E(h,a||r.d)}function M(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return 0===arguments.length?e=r.l:(Object(r.g)(e,r.n.notUndef,"select(selector,[...]): argument selector is undefined"),Object(r.g)(e,r.n.func,"select(selector,[...]): argument "+e+" is not a function")),E(m,{selector:e,args:n})}function N(e,t){return Object(r.g)(e,r.n.notUndef,"actionChannel(pattern,...): argument pattern is undefined"),arguments.length>1&&(Object(r.g)(t,r.n.notUndef,"actionChannel(pattern, buffer): argument buffer is undefined"),Object(r.g)(t,r.n.buffer,"actionChannel(pattern, buffer): argument "+t+" is not a valid buffer")),E(v,{pattern:e,buffer:t})}function R(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return T.apply(void 0,[a.a,e,t].concat(r))}O.resolve=function(){var e=O.apply(void 0,arguments);return e[c].resolve=!0,e},O.sync=Object(r.k)(O.resolve,Object(r.w)("put.sync","put.resolve"));var I=function(e){return function(t){return t&&t[o]&&t[e]}},L={take:I(i),put:I(c),all:I(s),race:I(l),call:I(u),cps:I(p),fork:I(d),join:I(f),cancel:I(h),select:I(m),actionChannel:I(v),cancelled:I(g),flush:I(y),getContext:I(b),setContext:I(w)}},u6S6:function(e,t,n){var r=n("6acW"),a=n("sgoq")(function(e,t,n){return t=t.toLowerCase(),e+(n?r(t):t)});e.exports=a},udQi:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"c",function(){return c}),n.d(t,"b",function(){return l});var r=[],a=0;function o(e){try{c(),e()}finally{s()}}function i(e){r.push(e),a||(c(),l())}function c(){a++}function s(){a--}function l(){s();for(var e=void 0;!a&&void 0!==(e=r.shift());)o(e)}},"ut/Y":function(e,t,n){var r=n("ZCpW"),a=n("GDhZ"),o=n("zZ0H"),i=n("Z0cm"),c=n("+c4W");e.exports=function(e){return"function"==typeof e?e:null==e?o:"object"==typeof e?i(e)?a(e[0],e[1]):r(e):c(e)}},v8PR:function(e,t){},vece:function(e,t,n){"use strict";n("edRh")},vpYg:function(e,t,n){"use strict";var r=["onAbort","onAnimationEnd","onAnimationIteration","onAnimationStart","onBlur","onCanPlay","onCanPlayThrough","onClick","onContextMenu","onCopy","onCut","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onFocus","onInput","onInvalid","onKeyDown","onKeyPress","onKeyUp","onLoad","onLoadedData","onLoadedMetadata","onLoadStart","onMouseDown","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onPaste","onPause","onPlay","onPlaying","onProgress","onRateChange","onReset","onScroll","onSeeked","onSeeking","onStalled","onSubmit","onSuspend","onTimeUpdate","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onTransitionEnd","onVolumeChange","onWaiting","onWheel"],a=["onAfterPrint","onBeforePrint","onBeforeUnload","onDeviceLight","onDeviceMotion","onDeviceOrientation","onDeviceProximity","onHashChange","onLanguageChange","onPopState","onRejectionHandled","onResize","onSelect","onStorage","onUnhandledRejection","onUnload","onUserProximity"],o=["onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp"];e.exports={allEvents:r.concat(a).concat(o),documentEvents:r.concat(o),windowEvents:a}},wCGR:function(e,t,n){"use strict";n.d(t,"a",function(){return g});var r=n("q1tI"),a=n.n(r),o=n("17x9"),i=n.n(o),c=n("Z0cm"),s=n.n(c),l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u={app:["项目","app"],team:["团队","team"],teamMember:["团队成员","team member"]},p={delete:["删除","delete"],leave:["退出","leave"],move:["移动","move"],duplicate:["复制","duplicate"]},d={actionConfirmation:[["您确定要","[VERB]","[NOUN]","[UGN]","吗？"],["Are you sure you want to ","[VERB]"," ","[NOUN]"," ","[UGN]"]],nounMap:u,verbMap:p},f=window.MBLocale,h=["zh-CN","en"].indexOf(f),m=function(e){return function(t,n){return function(e){return/^\[[A-Z_]+\]/.test(e)}(t)?(s=(c={pos:t,variableMap:e}).pos,l=c.variableMap,d=l.verb,f=l.noun,m=l.ugn,o="[VERB]"===s?p[d][h]:"[NOUN]"===s?u[f][h]:"[UGN]"===s?m:null,i=n,Object(r.isValidElement)(o)?a.a.cloneElement(o,{key:i}):o):t;var o,i,c,s,l,d,f,m}};function v(e){var t=e.name,n=e.variableMap,r=void 0===n?{}:n,a=d[t][h];return s()(a)?a.map(m(r)):a}function g(e){var t=e.variableMap,n=void 0===t?{}:t;return a.a.createElement(v,l({name:"actionConfirmation"},{variableMap:n}))}v.propTypes={name:i.a.string.isRequired,variableMap:i.a.object},g.propTypes={variableMap:i.a.object}},"wF/u":function(e,t,n){var r=n("e5cp"),a=n("ExA7");e.exports=function e(t,n,o,i,c){return t===n||(null==t||null==n||!a(t)&&!a(n)?t!=t&&n!=n:r(t,n,o,i,e,c))}},wfO3:function(e,t){},wig9:function(e,t){e.exports=function(e){for(var t=-1,n=null==e?0:e.length,r=0,a=[];++t<n;){var o=e[t];o&&(a[r++]=o)}return a}},wy8a:function(e,t,n){var r=n("KxBF");e.exports=function(e,t,n){var a=e.length;return n=void 0===n?a:n,!t&&n>=a?e:r(e,t,n)}},xn7q:function(e,t){e.exports={previewPanelLayer:"_1440VIJ3r2SoiW8WAZ21xI",layerInfo:"_1auiNpZenxIHtuOt85xZWs"}},yLV6:function(e,t,n){var r;!function(a,o,i,c){"use strict";var s,l=["","webkit","Moz","MS","ms","o"],u=o.createElement("div"),p="function",d=Math.round,f=Math.abs,h=Date.now;function m(e,t,n){return setTimeout(E(e,n),t)}function v(e,t,n){return!!Array.isArray(e)&&(g(e,n[t],n),!0)}function g(e,t,n){var r;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==c)for(r=0;r<e.length;)t.call(n,e[r],r,e),r++;else for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function y(e,t,n){var r="DEPRECATED METHOD: "+t+"\n"+n+" AT \n";return function(){var t=new Error("get-stack-trace"),n=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=a.console&&(a.console.warn||a.console.log);return o&&o.call(a.console,r,n),e.apply(this,arguments)}}s="function"!=typeof Object.assign?function(e){if(e===c||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==c&&null!==r)for(var a in r)r.hasOwnProperty(a)&&(t[a]=r[a])}return t}:Object.assign;var b=y(function(e,t,n){for(var r=Object.keys(t),a=0;a<r.length;)(!n||n&&e[r[a]]===c)&&(e[r[a]]=t[r[a]]),a++;return e},"extend","Use `assign`."),w=y(function(e,t){return b(e,t,!0)},"merge","Use `assign`.");function C(e,t,n){var r,a=t.prototype;(r=e.prototype=Object.create(a)).constructor=e,r._super=a,n&&s(r,n)}function E(e,t){return function(){return e.apply(t,arguments)}}function S(e,t){return typeof e==p?e.apply(t&&t[0]||c,t):e}function O(e,t){return e===c?t:e}function _(e,t,n){g(k(t),function(t){e.addEventListener(t,n,!1)})}function j(e,t,n){g(k(t),function(t){e.removeEventListener(t,n,!1)})}function x(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function T(e,t){return e.indexOf(t)>-1}function k(e){return e.trim().split(/\s+/g)}function M(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var r=0;r<e.length;){if(n&&e[r][n]==t||!n&&e[r]===t)return r;r++}return-1}function N(e){return Array.prototype.slice.call(e,0)}function R(e,t,n){for(var r=[],a=[],o=0;o<e.length;){var i=t?e[o][t]:e[o];M(a,i)<0&&r.push(e[o]),a[o]=i,o++}return n&&(r=t?r.sort(function(e,n){return e[t]>n[t]}):r.sort()),r}function I(e,t){for(var n,r,a=t[0].toUpperCase()+t.slice(1),o=0;o<l.length;){if((r=(n=l[o])?n+a:t)in e)return r;o++}return c}var L=1;function P(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||a}var A="ontouchstart"in a,D=I(a,"PointerEvent")!==c,B=A&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),U=25,F=1,q=2,W=4,z=8,H=1,V=2,G=4,K=8,X=16,Y=V|G,Z=K|X,Q=Y|Z,J=["x","y"],$=["clientX","clientY"];function ee(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){S(e.options.enable,[e])&&n.handler(t)},this.init()}function te(e,t,n){var r=n.pointers.length,a=n.changedPointers.length,o=t&F&&r-a==0,i=t&(W|z)&&r-a==0;n.isFirst=!!o,n.isFinal=!!i,o&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,r=t.pointers,a=r.length;n.firstInput||(n.firstInput=ne(t));a>1&&!n.firstMultiple?n.firstMultiple=ne(t):1===a&&(n.firstMultiple=!1);var o=n.firstInput,i=n.firstMultiple,s=i?i.center:o.center,l=t.center=re(r);t.timeStamp=h(),t.deltaTime=t.timeStamp-o.timeStamp,t.angle=ce(s,l),t.distance=ie(s,l),function(e,t){var n=t.center,r=e.offsetDelta||{},a=e.prevDelta||{},o=e.prevInput||{};t.eventType!==F&&o.eventType!==W||(a=e.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=e.offsetDelta={x:n.x,y:n.y});t.deltaX=a.x+(n.x-r.x),t.deltaY=a.y+(n.y-r.y)}(n,t),t.offsetDirection=oe(t.deltaX,t.deltaY);var u=ae(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=u.x,t.overallVelocityY=u.y,t.overallVelocity=f(u.x)>f(u.y)?u.x:u.y,t.scale=i?(p=i.pointers,d=r,ie(d[0],d[1],$)/ie(p[0],p[1],$)):1,t.rotation=i?function(e,t){return ce(t[1],t[0],$)+ce(e[1],e[0],$)}(i.pointers,r):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,r,a,o,i=e.lastInterval||t,s=t.timeStamp-i.timeStamp;if(t.eventType!=z&&(s>U||i.velocity===c)){var l=t.deltaX-i.deltaX,u=t.deltaY-i.deltaY,p=ae(s,l,u);r=p.x,a=p.y,n=f(p.x)>f(p.y)?p.x:p.y,o=oe(l,u),e.lastInterval=t}else n=i.velocity,r=i.velocityX,a=i.velocityY,o=i.direction;t.velocity=n,t.velocityX=r,t.velocityY=a,t.direction=o}(n,t);var p,d;var m=e.element;x(t.srcEvent.target,m)&&(m=t.srcEvent.target);t.target=m}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function ne(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:d(e.pointers[n].clientX),clientY:d(e.pointers[n].clientY)},n++;return{timeStamp:h(),pointers:t,center:re(t),deltaX:e.deltaX,deltaY:e.deltaY}}function re(e){var t=e.length;if(1===t)return{x:d(e[0].clientX),y:d(e[0].clientY)};for(var n=0,r=0,a=0;a<t;)n+=e[a].clientX,r+=e[a].clientY,a++;return{x:d(n/t),y:d(r/t)}}function ae(e,t,n){return{x:t/e||0,y:n/e||0}}function oe(e,t){return e===t?H:f(e)>=f(t)?e<0?V:G:t<0?K:X}function ie(e,t,n){n||(n=J);var r=t[n[0]]-e[n[0]],a=t[n[1]]-e[n[1]];return Math.sqrt(r*r+a*a)}function ce(e,t,n){n||(n=J);var r=t[n[0]]-e[n[0]],a=t[n[1]]-e[n[1]];return 180*Math.atan2(a,r)/Math.PI}ee.prototype={handler:function(){},init:function(){this.evEl&&_(this.element,this.evEl,this.domHandler),this.evTarget&&_(this.target,this.evTarget,this.domHandler),this.evWin&&_(P(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&j(this.element,this.evEl,this.domHandler),this.evTarget&&j(this.target,this.evTarget,this.domHandler),this.evWin&&j(P(this.element),this.evWin,this.domHandler)}};var se={mousedown:F,mousemove:q,mouseup:W},le="mousedown",ue="mousemove mouseup";function pe(){this.evEl=le,this.evWin=ue,this.pressed=!1,ee.apply(this,arguments)}C(pe,ee,{handler:function(e){var t=se[e.type];t&F&&0===e.button&&(this.pressed=!0),t&q&&1!==e.which&&(t=W),this.pressed&&(t&W&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}});var de={pointerdown:F,pointermove:q,pointerup:W,pointercancel:z,pointerout:z},fe={2:"touch",3:"pen",4:"mouse",5:"kinect"},he="pointerdown",me="pointermove pointerup pointercancel";function ve(){this.evEl=he,this.evWin=me,ee.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}a.MSPointerEvent&&!a.PointerEvent&&(he="MSPointerDown",me="MSPointerMove MSPointerUp MSPointerCancel"),C(ve,ee,{handler:function(e){var t=this.store,n=!1,r=e.type.toLowerCase().replace("ms",""),a=de[r],o=fe[e.pointerType]||e.pointerType,i="touch"==o,c=M(t,e.pointerId,"pointerId");a&F&&(0===e.button||i)?c<0&&(t.push(e),c=t.length-1):a&(W|z)&&(n=!0),c<0||(t[c]=e,this.callback(this.manager,a,{pointers:t,changedPointers:[e],pointerType:o,srcEvent:e}),n&&t.splice(c,1))}});var ge={touchstart:F,touchmove:q,touchend:W,touchcancel:z},ye="touchstart",be="touchstart touchmove touchend touchcancel";function we(){this.evTarget=ye,this.evWin=be,this.started=!1,ee.apply(this,arguments)}C(we,ee,{handler:function(e){var t=ge[e.type];if(t===F&&(this.started=!0),this.started){var n=function(e,t){var n=N(e.touches),r=N(e.changedTouches);t&(W|z)&&(n=R(n.concat(r),"identifier",!0));return[n,r]}.call(this,e,t);t&(W|z)&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:e})}}});var Ce={touchstart:F,touchmove:q,touchend:W,touchcancel:z},Ee="touchstart touchmove touchend touchcancel";function Se(){this.evTarget=Ee,this.targetIds={},ee.apply(this,arguments)}C(Se,ee,{handler:function(e){var t=Ce[e.type],n=function(e,t){var n=N(e.touches),r=this.targetIds;if(t&(F|q)&&1===n.length)return r[n[0].identifier]=!0,[n,n];var a,o,i=N(e.changedTouches),c=[],s=this.target;if(o=n.filter(function(e){return x(e.target,s)}),t===F)for(a=0;a<o.length;)r[o[a].identifier]=!0,a++;a=0;for(;a<i.length;)r[i[a].identifier]&&c.push(i[a]),t&(W|z)&&delete r[i[a].identifier],a++;if(!c.length)return;return[R(o.concat(c),"identifier",!0),c]}.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:e})}});var Oe=2500,_e=25;function je(){ee.apply(this,arguments);var e=E(this.handler,this);this.touch=new Se(this.manager,e),this.mouse=new pe(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function xe(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout(function(){var e=r.indexOf(n);e>-1&&r.splice(e,1)},Oe)}}C(je,ee,{handler:function(e,t,n){var r="touch"==n.pointerType,a="mouse"==n.pointerType;if(!(a&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)(function(e,t){e&F?(this.primaryTouch=t.changedPointers[0].identifier,xe.call(this,t)):e&(W|z)&&xe.call(this,t)}).call(this,t,n);else if(a&&function(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var a=this.lastTouches[r],o=Math.abs(t-a.x),i=Math.abs(n-a.y);if(o<=_e&&i<=_e)return!0}return!1}.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Te=I(u.style,"touchAction"),ke=Te!==c,Me="auto",Ne="manipulation",Re="none",Ie="pan-x",Le="pan-y",Pe=function(){if(!ke)return!1;var e={},t=a.CSS&&a.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(n){e[n]=!t||a.CSS.supports("touch-action",n)}),e}();function Ae(e,t){this.manager=e,this.set(t)}Ae.prototype={set:function(e){"compute"==e&&(e=this.compute()),ke&&this.manager.element.style&&Pe[e]&&(this.manager.element.style[Te]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return g(this.manager.recognizers,function(t){S(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function(e){if(T(e,Re))return Re;var t=T(e,Ie),n=T(e,Le);if(t&&n)return Re;if(t||n)return t?Ie:Le;if(T(e,Ne))return Ne;return Me}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var r=this.actions,a=T(r,Re)&&!Pe[Re],o=T(r,Le)&&!Pe[Le],i=T(r,Ie)&&!Pe[Ie];if(a){var c=1===e.pointers.length,s=e.distance<2,l=e.deltaTime<250;if(c&&s&&l)return}if(!i||!o)return a||o&&n&Y||i&&n&Z?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var De=1,Be=2,Ue=4,Fe=8,qe=Fe,We=16;function ze(e){this.options=s({},this.defaults,e||{}),this.id=L++,this.manager=null,this.options.enable=O(this.options.enable,!0),this.state=De,this.simultaneous={},this.requireFail=[]}function He(e){return e&We?"cancel":e&Fe?"end":e&Ue?"move":e&Be?"start":""}function Ve(e){return e==X?"down":e==K?"up":e==V?"left":e==G?"right":""}function Ge(e,t){var n=t.manager;return n?n.get(e):e}function Ke(){ze.apply(this,arguments)}function Xe(){Ke.apply(this,arguments),this.pX=null,this.pY=null}function Ye(){Ke.apply(this,arguments)}function Ze(){ze.apply(this,arguments),this._timer=null,this._input=null}function Qe(){Ke.apply(this,arguments)}function Je(){Ke.apply(this,arguments)}function $e(){ze.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function et(e,t){return(t=t||{}).recognizers=O(t.recognizers,et.defaults.preset),new tt(e,t)}ze.prototype={defaults:{},set:function(e){return s(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(v(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=Ge(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return v(e,"dropRecognizeWith",this)?this:(e=Ge(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(v(e,"requireFailure",this))return this;var t=this.requireFail;return-1===M(t,e=Ge(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(v(e,"dropRequireFailure",this))return this;e=Ge(e,this);var t=M(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function r(n){t.manager.emit(n,e)}n<Fe&&r(t.options.event+He(n)),r(t.options.event),e.additionalEvent&&r(e.additionalEvent),n>=Fe&&r(t.options.event+He(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(32|De)))return!1;e++}return!0},recognize:function(e){var t=s({},e);if(!S(this.options.enable,[this,t]))return this.reset(),void(this.state=32);this.state&(qe|We|32)&&(this.state=De),this.state=this.process(t),this.state&(Be|Ue|Fe|We)&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},C(Ke,ze,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,r=t&(Be|Ue),a=this.attrTest(e);return r&&(n&z||!a)?t|We:r||a?n&W?t|Fe:t&Be?t|Ue:Be:32}}),C(Xe,Ke,{defaults:{event:"pan",threshold:10,pointers:1,direction:Q},getTouchAction:function(){var e=this.options.direction,t=[];return e&Y&&t.push(Le),e&Z&&t.push(Ie),t},directionTest:function(e){var t=this.options,n=!0,r=e.distance,a=e.direction,o=e.deltaX,i=e.deltaY;return a&t.direction||(t.direction&Y?(a=0===o?H:o<0?V:G,n=o!=this.pX,r=Math.abs(e.deltaX)):(a=0===i?H:i<0?K:X,n=i!=this.pY,r=Math.abs(e.deltaY))),e.direction=a,n&&r>t.threshold&&a&t.direction},attrTest:function(e){return Ke.prototype.attrTest.call(this,e)&&(this.state&Be||!(this.state&Be)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=Ve(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),C(Ye,Ke,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Re]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&Be)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),C(Ze,ze,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Me]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,a=e.deltaTime>t.time;if(this._input=e,!r||!n||e.eventType&(W|z)&&!a)this.reset();else if(e.eventType&F)this.reset(),this._timer=m(function(){this.state=qe,this.tryEmit()},t.time,this);else if(e.eventType&W)return qe;return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===qe&&(e&&e.eventType&W?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=h(),this.manager.emit(this.options.event,this._input)))}}),C(Qe,Ke,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Re]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&Be)}}),C(Je,Ke,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Y|Z,pointers:1},getTouchAction:function(){return Xe.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return n&(Y|Z)?t=e.overallVelocity:n&Y?t=e.overallVelocityX:n&Z&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&f(t)>this.options.velocity&&e.eventType&W},emit:function(e){var t=Ve(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),C($e,ze,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ne]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,a=e.deltaTime<t.time;if(this.reset(),e.eventType&F&&0===this.count)return this.failTimeout();if(r&&a&&n){if(e.eventType!=W)return this.failTimeout();var o=!this.pTime||e.timeStamp-this.pTime<t.interval,i=!this.pCenter||ie(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,i&&o?this.count+=1:this.count=1,this._input=e,0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=m(function(){this.state=qe,this.tryEmit()},t.interval,this),Be):qe}return 32},failTimeout:function(){return this._timer=m(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==qe&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),et.VERSION="2.0.7",et.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[Qe,{enable:!1}],[Ye,{enable:!1},["rotate"]],[Je,{direction:Y}],[Xe,{direction:Y},["swipe"]],[$e],[$e,{event:"doubletap",taps:2},["tap"]],[Ze]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function tt(e,t){var n;this.options=s({},et.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((n=this).options.inputClass||(D?ve:B?Se:A?je:pe))(n,te),this.touchAction=new Ae(this,this.options.touchAction),nt(this,!0),g(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function nt(e,t){var n,r=e.element;r.style&&(g(e.options.cssProps,function(a,o){n=I(r.style,o),t?(e.oldCssProps[n]=r.style[n],r.style[n]=a):r.style[n]=e.oldCssProps[n]||""}),t||(e.oldCssProps={}))}tt.prototype={set:function(e){return s(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var r=this.recognizers,a=t.curRecognizer;(!a||a&&a.state&qe)&&(a=t.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===t.stopped||a&&n!=a&&!n.canRecognizeWith(a)?n.reset():n.recognize(e),!a&&n.state&(Be|Ue|Fe)&&(a=t.curRecognizer=n),o++}},get:function(e){if(e instanceof ze)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(v(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(v(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=M(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==c&&t!==c){var n=this.handlers;return g(k(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this}},off:function(e,t){if(e!==c){var n=this.handlers;return g(k(e),function(e){t?n[e]&&n[e].splice(M(n[e],t),1):delete n[e]}),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var n=o.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t,t.target.dispatchEvent(n)}(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](t),r++}},destroy:function(){this.element&&nt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},s(et,{INPUT_START:F,INPUT_MOVE:q,INPUT_END:W,INPUT_CANCEL:z,STATE_POSSIBLE:De,STATE_BEGAN:Be,STATE_CHANGED:Ue,STATE_ENDED:Fe,STATE_RECOGNIZED:qe,STATE_CANCELLED:We,STATE_FAILED:32,DIRECTION_NONE:H,DIRECTION_LEFT:V,DIRECTION_RIGHT:G,DIRECTION_UP:K,DIRECTION_DOWN:X,DIRECTION_HORIZONTAL:Y,DIRECTION_VERTICAL:Z,DIRECTION_ALL:Q,Manager:tt,Input:ee,TouchAction:Ae,TouchInput:Se,MouseInput:pe,PointerEventInput:ve,TouchMouseInput:je,SingleTouchInput:we,Recognizer:ze,AttrRecognizer:Ke,Tap:$e,Pan:Xe,Swipe:Je,Pinch:Ye,Rotate:Qe,Press:Ze,on:_,off:j,each:g,merge:w,extend:b,assign:s,inherit:C,bindFn:E,prefixed:I}),(void 0!==a?a:"undefined"!=typeof self?self:{}).Hammer=et,(r=function(){return et}.call(t,n,t,e))===c||(e.exports=r)}(window,document)},yTJ9:function(e,t){e.exports=function(e){return e instanceof Date?o(e):"string"==typeof e?o(a(e)):"number"==typeof e?o(new Date(e)):void 0};var n={allowFuture:!1,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",numbers:[],wordSeparator:" "}},r=n.strings;function a(e){if(e){var t=e.trim();return t=(t=(t=(t=t.replace(/\.\d\d\d+/,"")).replace(/-/,"/").replace(/-/,"/")).replace(/T/," ").replace(/Z/," UTC")).replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),new Date(t)}}function o(e){return r.inWords(function(e){return(new Date).getTime()-e.getTime()}(e))}e.exports.settings=n,r.inWords=function(e){var t=r.prefixAgo,a=r.suffixAgo;n.allowFuture&&e<0&&(t=r.prefixFromNow,a=r.suffixFromNow);var o=Math.abs(e)/1e3,i=o/60,c=i/60,s=c/24,l=s/365;function u(t,n){var a="function"==typeof t?t(n,e):t,o=r.numbers&&r.numbers[n]||n;return a.replace(/%d/i,o)}var p=o<45&&u(r.seconds,Math.round(o))||o<90&&u(r.minute,1)||i<45&&u(r.minutes,Math.round(i))||i<90&&u(r.hour,1)||c<24&&u(r.hours,Math.round(c))||c<48&&u(r.day,1)||s<30&&u(r.days,Math.floor(s))||s<60&&u(r.month,1)||s<365&&u(r.months,Math.floor(s/30))||l<2&&u(r.year,1)||u(r.years,Math.floor(l)),d=r.wordSeparator||"";return void 0===r.wordSeparator&&(d=" "),[t,p,a].join(d).toString().trim()},r.parse=a},zAG7:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z0-9-]{2,63}$/i},zkrS:function(e,t,n){"use strict";var r=n("yTJ9"),a=n.n(r),o=n("knB1"),i=n("QkVN"),c=n.n(i),s=window,l=s.confirm,u=s.alert,p=s.MB,d=s.MBLocale,f=s.I18N,h=s.Team,m=s.Project,v=s.Combo,g=s.Template,y=s.Screen,b=s.Screenstate,w=s.Widget,C=s.Widgetstate,E=s.Panel,S=s.Panelstate,O=s.Link,_=s.Collaborator,j=s.Comment,x=s.CommentThread,T=s.Asset,k=s.$;"zh-CN"===d&&c()(a.a.settings.strings,o.a);var M=window,N={MBLocale:d,parseTimeAgo:function(e){return a()(e)}},R={Team:h,Project:m,Combo:v,Template:g,Screen:y,Screenstate:b,Widget:w,Widgetstate:C,Panel:E,Panelstate:S,Link:O,Collaborator:_,Comment:j,CommentThread:x,Asset:T,requestCid:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")+Math.uuid(10,16)+Date.now()},queueSave:function(){return k("body").trigger("queue:save")}};t.a={Global:M,Storage:p.localStorageDelegate,confirm:function(){return l.apply(void 0,arguments)},alert:function(){return u.apply(void 0,arguments)},MB:p,I18N:f,L10N:N,SpineModel:R}}}]);
//# sourceMappingURL=lib-preview-eff2b5ec3b9d0d86f554.js.map